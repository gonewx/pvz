# 植物大战僵尸》PC版 **第一章 (前院白天)** 所有关卡的详细说明

## 第一章：前院白天 (Day)

### **关卡 1-1**
*   **场地布局**: 阳光明媚的前院，但草坪只有中间一行是激活的，其余四行是深色的，无法交互。左侧只有一台割草机。
*   **波数/旗帜**: **1 波** (无旗帜)。
*   **解锁植物**: **向日葵** - 游戏结束后获得。
*   **新增僵尸**: 5个 普通僵尸 (Zombie)。
*   **初始阳光**: 150
*   **核心教学/目的**: 游戏最基础的教学。引导玩家学习：1. 收集阳光；2. 选择植物卡片；3. 将植物种植在草坪上。
*   **关卡流程与细节**: 这是一个完全受控的教程。屏幕上会出现文字提示，强制玩家执行操作。整关只会缓慢地出现**2-3只**普通僵尸。击败最后一只后，关卡结束。
*   **教学文字**: 在画面下方，居中显示浅黄色文字，黑色描边，半透明黑色屏幕从左到右的背景条

- 背景图渲染（单阶段渲染）：采用双背景叠加技术实现铺草皮动画效果：
  - **初始状态**：底层背景显示无草皮背景（IMAGE_BACKGROUND1UNSODDED），不预渲染任何草皮
  - **动画播放**：第3行播放草皮卷动画，叠加层（包含第3行草皮 IMAGE_SOD1ROW）根据草皮卷位置渐进显示
  - **技术要点**：
    - 底层背景：IMAGE_BACKGROUND1UNSODDED（无预渲染草皮）
    - 叠加层：IMAGE_BACKGROUND1UNSODDED + 第3行草皮（IMAGE_SOD1ROW）
    - 草皮卷从网格起点向右滚动，草皮从草皮卷中心位置展开（类似卷纸展开）
    - 叠加层根据草皮卷中心位置渐进显示（从世界坐标0裁剪到草皮卷中心），实现"边铺边看到草皮显现"的效果
  - **配置文件**：
    - `preSoddedLanes: []` - 底层背景不预渲染草皮（开始时完全无草皮）
    - `enabledLanes: [3]` - 只启用第3行
    - `sodRowImage: "IMAGE_SOD1ROW"` - 叠加层使用单行草皮
    - `soddingAnimLanes: []` - 空表示使用所有启用行（第3行）播放动画

#### 教学 - 选择与种植植物

- 一个跳动的箭头从草坪指向豌豆射手卡片，卡片呈现闪烁状态，鼠标悬浮时显示植物名称，鼠标变手形
  > 教学文字显示 - ADVICE_CLICK_SEED_PACKET 对应文本

- 玩家**必须**点击豌豆射手卡片，点击后，草皮开始闪烁（只在启用的行上显示草皮颜色会由明变暗的闪烁效果）
  > 教学文字显示 - ADVICE_CLICK_ON_GRASS 对应文本

- 玩家在草坪任意一格点击左键,“噗”的一声，豌豆射手被种下，植物进入冷却状态，开始生产阳光
  > 教学文字显示 - ADVICE_PLANTED_PEASHOOTER 对应文本
  > 一颗**阳光 (Sun)** 从天空缓缓飘落
  > 教学文字显示 - ADVICE_CLICK_ON_SUN 对应文本

- 继续收集阳光
    > 又一颗阳光从天空飘落
    > 教学文字显示 - ADVICE_CLICKED_ON_SUN 对应文本

- 豌豆射手卡片解冻
    > 阳光不断的按一定的随机间隔生成
    > 采集后，如果阳光足够， 在确保上一次的文本显示足够的时长后，教学文字显 ADVICE_ENOUGH_SUN 对应文本
    > 阳光足够种植豌豆射手并且豌豆射手是可种植状态时， 教学文字显示 - ADVICE_CLICK_PEASHOOTER 对应文本
    > 如果豌豆射手是可种植状态，用户没有很快点击植物进行种植，再次出现一个跳动的箭头从草坪指向豌豆射手卡片，卡片呈现闪烁状态，鼠标悬浮时显示植物名称，鼠标变手形

- 玩家**必须**再次点击种植豌豆射手卡片，点击后，草皮开始闪烁
  > 种植后，教学文字显示 - ADVICE_ZOMBIE_ONSLAUGHT 对应文本， 僵尸开始进攻
  > **关卡流程与细节**: 屏幕右下角出现关卡进度条

- 在最后一波攻击前，显示动画效果的提示 '最后一波'
 > 僵尸被攻击时，要有闪烁效果
 > 被攻击后，根据生命值不同阶段，出现手臂掉落、头部掉落、死亡的动画

- 胜利后，当最后一只僵尸被消灭后
*   **动画 (结束)**:
    1.  一个植物卡片包**向日葵卡片 (Sunflower)**从屏幕右侧掉落到草坪中央。
    2.  玩家点击卡片包，展示奖励动画背景，卡片做为前景渐渐放大并移到上方中央
*   点击后，展示新植物的介绍面板
    > 标题：**你得到了一株新植物！**
    > 向日葵的图片
    > 下方是简介

- 奖励动画的动画流程:

  1. Phase 1: 出现 (Appear)
    - 卡片包从铺了草坪的右侧随机位置直接弹出
    - 大小 ：卡包的缩放大小是使用了和卡片选择时一样的配置
    - 起始位置: 在2-4行,偏右半部分的区域随机出现
    - 出现阶段不需要有缩放的效果.保持和植物选择是卡片一样的缩放值就行
    - 可选: 小幅度缩放动画 (0.8 → 1.0) 模拟"跳出"效果
    - 持续时间: 0.3秒
    - 微小的抛物线感觉，无弹跳，直接 落到草坪上
  2. Phase 2: 等待点击 (Waiting) 
    - 卡片包静止在草坪上
    - 卡片周围应该有个光晕效果的粒子效果（请在资源包在找到最合适的粒子效果，assets/effect/particles/SeedPacket.xml）
    - 显示橙色向下箭头指示器(闪烁动画， 类似于植物卡片包下方的)
    - 等待玩家点击
    - 参考截图： .meta/screenshot/level1/截图 2025-10-16 17-34-00.png
  3. Phase 3: 展开 (Expanding)
    - 玩家点击后触发粒子特效的奖励动画，集成 Award.xml 粒子特效（12个光芒发射器）
    - 卡片包边放大边移动到草坪上方中央的位置，然后等一小会儿,开始渐渐消失, 消失后, 清除奖励动画,然后显示介绍面板
    - 参考截图 ：.meta/screenshot/level1/截图 2025-10-16 17-34-07.png
  4. Phase 4: 显示奖励植物介绍面板 (Showing) 
    - 粒子特效奖励动画播放完成后，直接显示新植物介绍面板
  5. Phase 5: 点击`下一关`可进入下一关
    - 返回主菜单   
---

### **关卡 1-2**

**这一关的本质是“向日葵教学关”**。所有的节奏设计（极其缓慢的起步）都是为了强迫玩家理解“先种植物生产阳光，再种植物攻击”的逻辑。如果节奏太快，新手玩家会跳过向日葵直接种豌豆，导致教学失败。

#### **1. 关卡概况 (Level Overview)**
*   **关卡 ID**: `Level_1_2`
*   **地图场景**: 白天-前院 (Day - Front Yard)
*   **可用草坪**: **3 行** (中间 3 行有效，最上和最下两行不可用/无草皮)。
*   **核心目标**: 教学“向日葵 (Sunflower)”的使用与经济建设的重要性。
*   **通关奖励**: 樱桃炸弹 (Cherry Bomb)。

#### **2. 僵尸配置 (Enemy Configuration)**
本关**严禁**出现除普通僵尸以外的特殊僵尸。

*   **僵尸池 (Zombie Pool)**:
    *   `Zombie_Normal` (普通僵尸)
    *   `Zombie_Flag` (旗帜僵尸 - 仅在最后一波领队出现)
*   **总旗帜数 (Total Flags)**: **1** (意味着只有一次“一大波僵尸”进攻)。

#### **3. 关卡脚本详细设计 (Script Breakdown)**

本关采用**混合触发机制**：起步阶段用**长倒计时**给玩家反应时间，后续采用**固定间隔**刷新。

##### **阶段一：开局与经济建设 (Early Game - Economy)**
**设计意图**：给玩家足够的时间收集天上掉落的阳光，种下至少2株向日葵。

| 序号 | 事件/僵尸 | 触发条件/时机 | 所在行 (Lane) | 备注 (PM Note) |
| :--- | :--- | :--- | :--- | :--- |
| 0 | **关卡开始** | 玩家点击Start | N/A | 此时开始掉落自然阳光。 |
| 1 | **静默期** | 0s - **30s** (全局计时) | N/A | **极重要**：这30秒绝对不能出怪！玩家需要这段时间种下第一、二颗向日葵。 |
| 2 | **僵尸 #1** | 30s | 随机 (2/3/4行) | 第一只僵尸必须非常弱，且走得慢。 |
| 3 | **僵尸 #2** | 僵尸#1 出现后 **25s** | 随机 (避免与#1同行) | 间隔要长，让玩家有时间种豌豆射手。 |
| 4 | **僵尸 #3** | 僵尸#2 出现后 **25s** | 随机 | 保持低压节奏。 |

##### **阶段二：中期零星骚扰 (Mid Game - Trickle)**
**设计意图**：轻微增加压力，测试玩家是否在每行都布置了防御。

| 序号 | 事件/僵尸 | 触发条件/时机 | 所在行 (Lane) | 备注 (PM Note) |
| :--- | :--- | :--- | :--- | :--- |
| 5 | **僵尸 #4** | 僵尸#3 出现后 **20s** | 随机 | 间隔略微缩短。 |
| 6 | **僵尸 #5** | 僵尸#4 出现后 **15s** | 随机 | |
| 7 | **僵尸 #6** | 僵尸#5 出现后 **15s** | 随机 | 这是第一波进攻前的最后一只散兵。 |

##### **阶段三：旗帜波 (The Wave / Final Wave)**
**设计意图**：本关的高潮，也是结束。

| 序号 | 事件/僵尸 | 触发条件/时机 | 所在行 (Lane) | 备注 (PM Note) |
| :--- | :--- | :--- | :--- | :--- |
| 8 | **前摇检测** | 僵尸#6 **死亡** 后 | N/A | 触发“间歇期”计时器。 |
| 9 | **间歇期** | 计时 **15s** | N/A | 此时没有任何新怪，给玩家补防。 |
| 10 | **UI提示** | 间歇期结束 | N/A | 屏幕显示“一大波僵尸正在接近！”文字，播放号角音效。 |
| 11 | **最终波生成** | UI提示后 2s | **全覆盖** | **逻辑核心**：<br>1. 生成 `Zombie_Flag` x1 (随机行)<br>2. 生成 `Zombie_Normal` x3<br>**强制逻辑**：保证有效的3行（2/3/4行）**每一行至少有一只僵尸**。 |

---

#### **4. 关键逻辑规则 (Dev Implementation Rules)**

为了保证还原度，请开发人员务必实现以下逻辑：

1.  **行生成限制 (Row Constraint)**：
    *   代码必须写死：僵尸**只能**生成在 Index 1, 2, 3 (即视觉上的第2、3、4行)。
    *   绝对禁止在草地不可用的第1行和第5行生成僵尸。

2.  **动态难度调整 (Dynamic Spawning) - "补漏逻辑"**：
    *   在**阶段一**和**阶段二**（散兵阶段），生成僵尸时，程序应优先检测**“玩家在哪一行没有种植豌豆射手”**。
    *   *原版表现*：如果你在第2行种了豌豆，第3行没种，系统会有高概率把下一个僵尸刷在第3行，以此逼迫你补防。请加一个简单的权重判断来实现这一点。

#### 教学 - 选择与种植植物

- 和 level 1-1 在向日葵卡片显示相同的箭头加闪烁的效果，以及鼠标悬停的效果
  > 教学文字显示 （文本资源是预先加载好的，参考level 1-1 ）
  
  开始依次显示 ADVICE_PLANT_SUNFLOWER1(开始显示) ADVICE_PLANT_SUNFLOWER2 （种植一颗或到预定时长时显示） ADVICE_MORE_SUNFLOWERS （种植两颗或到预定时长时显示），  ADVICE_PLANT_SUNFLOWER3（如果过了比较久后，还不足三棵向日葵就再提示）

    [ADVICE_PLANT_SUNFLOWER1]
    向日葵是极其重要的植物！

    [ADVICE_PLANT_SUNFLOWER2]
    请至少种下三棵向日葵！

    [ADVICE_PLANT_SUNFLOWER3]
    至少种下三棵向日葵，来提高你在僵尸进攻下的生存率！

    [ADVICE_MORE_SUNFLOWERS]
    向日葵越多，你种植物的速度越快！


- 背景图渲染（两阶段渲染）：使用配置中的背景图，延续上一关场景。采用两阶段渲染技术实现平滑过渡：
  - **初始状态**：底层背景显示第3行草皮（IMAGE_SOD1ROW），延续1-1关卡的场景
  - **动画播放**：第2行和第4行同时播放草皮卷动画，叠加层渐进显示 IMAGE_SOD3ROW（3行整体草皮），逐步覆盖底层的单行草皮
  - **技术要点**：
    - 底层背景：IMAGE_BACKGROUND1UNSODDED + 第3行草皮（IMAGE_SOD1ROW）
    - 叠加层：IMAGE_BACKGROUND1UNSODDED + 第2,3,4行草皮（IMAGE_SOD3ROW）
    - 叠加层根据草皮卷位置渐进显示（从 256px 扩展到 995px），实现从单行草皮到3行整体草皮的无缝过渡
  - **配置文件**：
    - `preSoddedLanes: [3]` - 预渲染第3行到底层背景
    - `sodRowImage: "IMAGE_SOD1ROW"` - 底层使用单行草皮
    - `sodRowImageAnim: "IMAGE_SOD3ROW"` - 叠加层使用3行草皮
    - `soddingAnimLanes: [2, 4]` - 只在第2/4行播放草皮卷动画

### **关卡 1-3**
*   **场地布局**: 中间3行草地, 延续1-2时背景， 使用图片 IMAGE_BACKGROUND1UNSODDED 背景 和 图片 IMAGE_SOD3ROW （三行草坪）预先渲染草皮。没有铺草皮的动画。
*   **波数/旗帜**: **共1面旗帜**。
*   **解锁植物**: **坚果墙 (Wall-nut)** - 游戏结束后获得。
*   **新增僵尸**: **路障僵尸 (Conehead Zombie)**。
*   **核心教学/目的**: 引入“精英怪”和“范围爆发伤害”的概念。路障僵尸血量更高，需要更多火力，而樱桃炸弹则提供了一种快速解决威胁的手段。
*   **关卡流程与细节**: 玩家会发现普通豌豆射手需要打很久才能消灭路障僵尸。本关旨在让玩家体验到樱桃炸弹的强大威力。


- 樱桃炸弹开场即显示解冻效果
- 开场显示 `安放` `` 的三个动画效果

### **关卡 1-4**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **共1面旗帜**。
*   **解锁植物**: **铲子 (Shovel)** - 游戏结束后获得。
*   **新增僵尸**: 无。
*   **核心教学/目的**: 引入“防御型植物”的概念。坚果墙可以阻挡僵尸，为后排的攻击植物争取输出时间。本关结束后会**解锁铲子**。
*   **关卡流程与细节**: 战场首次扩展到完整的5行，让玩家感受到防守压力的增加。玩家需要学习构建“前排防御，后排输出”的基本阵型。

- 背景图渲染（两阶段渲染）：使用配置中的背景图，延续上一关场景。采用两阶段渲染技术实现平滑过渡：
  - **初始状态**：底层背景显示3行草皮（IMAGE_SOD3ROW），延续1-3关卡的场景
  - **动画播放**：第1行和第5行同时播放草皮卷动画，叠加层渐进显示 IMAGE_BACKGROUND1（5行整体草皮），逐步覆盖底层的3行草皮
  - **动画完成**：底层背景完全替换为 IMAGE_BACKGROUND1，停止叠加层渲染，显示完整5行草皮
  - **技术要点**：
    - 底层背景：IMAGE_BACKGROUND1UNSODDED + 3行草皮（IMAGE_SOD3ROW，图片中心对齐第3行中心）
    - 叠加层：IMAGE_BACKGROUND1（5行整体草皮，从世界坐标0开始）
    - 叠加层根据草皮卷中心位置渐进显示（从草皮起点扩展到草皮卷中心），实现从3行草皮到整体草皮的无缝过渡
    - 动画完成后清空 `soddedBackground` 和 `preSoddedImage`，避免继续叠加渲染
  - **配置文件**：
    - `preSoddedLanes: [2,3,4]` - 预渲染第2,3,4行到底层背景（使用 IMAGE_SOD3ROW 整体图片，中心对齐第3行）
    - `sodRowImage: "IMAGE_SOD3ROW"` - 底层使用3行草皮整体图片
    - `sodRowImageAnim: "IMAGE_BACKGROUND1"` - 叠加层使用完整背景图
    - `soddingAnimLanes: [1, 5]` - 只在第1/5行播放草皮卷动画

- 需要有和前面关卡类似的奖励动画， 只是植物卡包换成铲子图片， 卡包背景的粒子效果换成 assets/effect/particles/AwardPickupArrow.xml。奖励动画时图片为 Shovel_hi_res.png, 缩放改为和植物卡包一样的逻辑.

### **关卡 1-5**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **特殊关卡 (迷你游戏)**，没有旗帜。僵尸会持续不断地出现，直到进度条走完。
*   **解锁植物**: **土豆雷 (Potato Mine)** - 游戏结束后获得。
*   **新增僵尸**: 无。
*   **核心教学/目的**: 首次引入非标准玩法，让玩家放松一下。本质上是“坚果保龄球”迷你游戏。
*   **关卡流程与细节**: 本关没有阳光，也不能选择植物。植物由左侧的传送带自动送出（普通坚果和会爆炸的红色坚果），玩家需要用它们来“滚”死来袭的僵尸。

### **关卡 1-6**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **共2面旗帜**。这是首次出现超过1面旗帜的关卡。
*   **解锁植物**: **雪花豌豆 (Snow Pea)** (即寒冰射手)。
*   **新增僵尸**: **撑杆僵尸 (Pole Vaulting Zombie)**。
*   **核心教学/目的**: 引入“控制”类植物（减速）和应对“特殊能力”僵尸（跳跃）的策略。
*   **关卡流程与细节**: 撑杆僵尸会跳过他遇到的第一个植物。玩家需要学会用坚果墙挡在他面前让他提前跳跃，或者干脆不在最前一格放植物。雪花豌豆的减速效果能有效克制他。

### **关卡 1-7**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **共2面旗帜**。
*   **解锁植物**: **食人花 (Chomper)** (即大嘴花)。
*   **新增僵尸**: 无。
*   **核心教学/目的**: 引入“秒杀”类植物及其风险（咀嚼时无法攻击，非常脆弱）。
*   **关卡流程与细节**: 关卡中会出现路障僵尸等较肉的敌人，是食人花发挥作用的好时机，但也考验玩家对种植位置和时机的把握。

### **关-卡 1-8**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **共2面旗帜**。
*   **解锁植物**: **双重射手 (Repeater)** (即双发射手)。
*   **新增僵尸**: **铁桶僵尸 (Buckethead Zombie)**。
*   **核心教学/目的**: 引入“重甲单位”，进行火力检测。强制玩家升级自己的输出能力。
*   **关卡流程与细节**: 这是第一章的标志性难度关。铁桶僵尸的血量极高，单个豌豆射手几乎无法对他造成有效伤害，迫使玩家必须使用新解锁的双发射手或集中多株植物的火力。

### **关卡 1-9**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **共2面旗帜**。
*   **解锁植物**: 无（通关后获得一封来自僵尸的信，预告夜间关卡）。
*   **新增僵尸**: 无。
*   **核心教学/目的**: 综合测验。在进入第二章前，对第一章所有植物和僵尸进行一次总复习。
*   **关卡流程与细节**: 本关会出现之前所有类型的僵尸（普通、路障、铁桶、撑杆），考验玩家构建综合防线的能力。

### **关卡 1-10**
*   **场地布局**: 完整的5行草地。
*   **波数/旗帜**: **特殊关卡 (传送带)**，没有旗帜，只有一个很长的进度条代表最终波。
*   **解锁植物**: **小喷菇 (Puff-shroom)** - 游戏结束后获得。
*   **新增僵尸**: 无。
*   **核心教学/目的**: 引入“传送带”机制。在这种模式下，玩家无法控制经济和植物选择，纯粹考验临场应变和布局能力。
*   **关卡流程与细节**: 左侧传送带会随机送来本章节已解锁的各种植物。玩家需要快速将它们放置在合适的位置，以应对持续不断的僵尸进攻。这是对第一章的终极考验。