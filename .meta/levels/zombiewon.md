# **功能需求文档：游戏结束（僵尸获胜）流程**

## **1. 概述**
**目标**：完美复刻原版《植物大战僵尸》中玩家失败时的经典“惨叫”与“脑子被吃”的过场效果。
**核心体验**：惊悚中带有黑色幽默，通过突然的音效和夸张的文字给玩家留下深刻印象。

---

## **2. 触发条件 (Trigger)**
*   **判定逻辑**：当任意一只僵尸的**判定框（Hitbox）**完全越过最左侧的“底线”（通常是房屋的门槛X轴坐标）。
*   **互斥性**：只要有一只僵尸触发此条件，游戏立即锁定，忽略后续其他僵尸的移动或植物的攻击判定（即：只触发一次，防止重复判定）。

---

## **3. 详细交互流程 (Flow & Interaction)**

整个过程分为三个阶段，总时长约为 4~5 秒，随后进入UI交互界面。

### **第一阶段：入侵与锁定 (The Breach)**
*   **时机**：触发判定后的 0.0秒 - 1.5秒（约）。
*   **画面表现**：
    1.  **镜头锁定**：如果当前地图可以卷动（如生存模式），镜头强制移动并锁定在僵尸入侵的那一行/区域。
    2.  **全场冻结（软停止）**：
        *   所有植物停止攻击动画（保持最后一帧）。
        *   所有子弹/投掷物悬停或消失。
        *   **例外**：触发失败的那只僵尸**继续播放行走动画**，直到完全走出屏幕左侧边缘（表现为走进房子里）。
    3.  **背景音乐**：瞬间停止（Fade out 时间极短，几乎是截断）。

### **第二阶段：惨叫与黑屏 (The Scream)**
*   **时机**：僵尸完全走出屏幕左侧边缘的瞬间。
*   **音频**：
    *   播放音效 `scream.wav`（那声经典的“NOOOO!”惨叫）。
    *   紧接着播放音效 `chomp.wav`（夸张的咀嚼声、碎裂声）。
*   **画面表现**：
    *   屏幕瞬间**全黑**（无渐变，直接Cut to Black）。

### **第三阶段：图文展示 (The Graphic)**
*   **时机**：黑屏后的 0.5秒 左右。
*   **视觉元素（居中显示）**：
    1.  **图片**：显示经典的“僵尸吃脑子”插图（绿色的脑子被三只手抓着，或者漫画风的僵尸围着脑子）。
    2.  **文字**：屏幕中央弹出巨大的文字：
        *   **内容**：**"THE ZOMBIES ATE YOUR BRAINS!"** (僵尸吃掉了你的脑子！)
        *   **字体**：原版特有的抖动字体（类似 House of Terror 或 Chiller 风格）。
        *   **颜色**：石灰绿（Lime Green）或 血红色，带有黑色描边。
        *   **动画**：文字不是静止的，需要有一个轻微的**缩放+抖动特效**（Scale Pulse），模拟惊悚感。

---

## **4. UI交互与后续 (UI Logic)**

*   **点击反馈**：
    *   在“图文展示”阶段，屏幕任意位置点击（Click Any Key），或者等待约 3-5 秒后。
*   **弹出菜单**：
    *   显示标准的“Game Over”对话框。
    *   **按钮选项**：
        1.  **Try Again (再试一次)**：重新加载当前关卡，重置所有数据。
        2.  **Main Menu (主菜单)**：返回选关界面。

---

## **5. 资源需求清单 (Assets)**

请开发确认是否已准备好以下资源：

1.  **音效**：
    *   `scream.ogg` (男声惨叫)
    *   `chomp_soft.ogg` (咀嚼声)
    *   `music_stop` (音乐停止的指令或短音效)
2.  **图片**：
    *   `ZombiesWon.png` (吃脑子的插画，需带透明通道或纯黑背景)
3.  **字体**：
    *   `PvZUIGameOver.ttf` (或原版使用的HouseOfTerror字体)

---

## **6. 开发注意事项 (Q&A)**

*   **Q: 如果有割草机（Lawn Mower）怎么办？**
    *   **A:** 割草机是最后一道防线。僵尸必须先触发割草机，割草机开走并消失后，僵尸再次走到该位置，才算触发上述的“游戏结束”流程。
*   **Q: 巨人僵尸扔出的小鬼（Imp）直接飞进最左侧怎么办？**
    *   **A:** 逻辑同上。只要小鬼落地的X坐标超过判定线，不需要播放“走进房子”的动画，直接进入**第二阶段（黑屏+惨叫）**。
*   **Q: 文本是否需要汉化？**
    *   **A:** 是的。中文版文案为：“**僵尸吃掉了你的脑子！**”，保持原版字体的抖动效果。

