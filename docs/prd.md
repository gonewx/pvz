# æ¤ç‰©å¤§æˆ˜åƒµå°¸ Go å¤åˆ»ç‰ˆ Product Requirements Document (PRD)

## **1. Goals and Background Context (ç›®æ ‡ä¸èƒŒæ™¯ä¸Šä¸‹æ–‡)**

### **Goals (ç›®æ ‡)**
*   **ä¸»è¦ç›®æ ‡ï¼š** æˆåŠŸæŒæ¡ä½¿ç”¨Goè¯­è¨€å’ŒEbitengineå¼•æ“è¿›è¡Œ2Dæ¸¸æˆå¼€å‘çš„æ ¸å¿ƒæµç¨‹å’Œå…³é”®æŠ€æœ¯ã€‚
*   **æ¬¡è¦ç›®æ ‡ï¼š** åˆ›å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€å¯ç‹¬ç«‹è¿è¡Œçš„æ¸¸æˆé¡¹ç›®ï¼Œä½œä¸ºä¸ªäººä½œå“é›†ä¸­çš„ä¸€ä¸ªé«˜è´¨é‡èŒƒä¾‹ã€‚
*   **æ‰©å±•ç›®æ ‡ï¼š** æ„å»ºä¸€ä¸ªæ¨¡å—åŒ–ã€å¯æ‰©å±•çš„ä»£ç åŸºç¡€ï¼Œä¸ºæœªæ¥æ·»åŠ æ›´å¤šå…³å¡å’Œæ¸¸æˆæ¨¡å¼æä¾›å¯èƒ½æ€§ã€‚

### **Background Context (èƒŒæ™¯ä¸Šä¸‹æ–‡)**
æœ¬é¡¹ç›®æ˜¯å¯¹ç»å…¸å¡”é˜²æ¸¸æˆã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹PCä¸­æ–‡å¹´åº¦ç‰ˆçš„ç²¾ç¡®å¤åˆ»ï¼Œä¸“æ³¨äºå­¦ä¹ å’Œå®è·µã€‚ä¸ä»é›¶å¼€å§‹çš„é¡¹ç›®ä¸åŒï¼Œæœ¬é¡¹ç›®çš„æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºæŠ€æœ¯å®ç°è€Œéåˆ›æ„è®¾è®¡ã€‚æ‰€æœ‰å¿…è¦çš„æ¸¸æˆç¾æœ¯å’ŒéŸ³é¢‘èµ„æºå‡å·²å¤‡å¥½ï¼Œä½¿å¼€å‘å›¢é˜Ÿèƒ½å°†å…¨éƒ¨ç²¾åŠ›é›†ä¸­åœ¨æ¸¸æˆé€»è¾‘ã€æ ¸å¿ƒæœºåˆ¶å’Œå¼•æ“æŠ€æœ¯çš„åº”ç”¨ä¸Šã€‚MVPï¼ˆæœ€å°å¯è¡Œäº§å“ï¼‰èŒƒå›´æ˜ç¡®ä¸ºå®ç°å®Œæ•´çš„å‰é™¢ç™½å¤©å…³å¡ï¼Œä¸ºåç»­å†…å®¹çš„æ·»åŠ æ‰“ä¸‹åšå®åŸºç¡€ã€‚

### **Change Log (å˜æ›´æ—¥å¿—)**
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-10-10 | 1.0 | Initial draft creation from Project Brief. | John (PM) |
| 2025-10-13 | 1.1 | Added Epic 6: Animation System Migration - Reanim. | Sarah (PO) |
| 2025-10-15 | 1.2 | Added Epic 7: Particle Effect System - Brownfield Enhancement. | Sarah (PO) |
| 2025-10-16 | 1.3 | Added Epic 8: Chapter 1 Level Implementation - Day Levels 1-1 to 1-10. | Sarah (PO) |
| 2025-10-16 | 1.4 | Added Epic 9: ECS Generics Refactor - Brownfield Enhancement. | Sarah (PO) |
| 2025-10-20 | 1.5 | Added Epic 10: Game Experience Polish - Brownfield Enhancement. | Sarah (PO) |
| 2025-10-26 | 1.6 | Added Epic 11: Level UI Enhancement (è¿›åº¦æ¡å®Œå–„ã€æœ€åä¸€æ³¢æç¤ºã€é“ºè‰çš®ç‰¹æ•ˆ). | Bob (Scrum Master) |
| 2025-11-01 | 1.7 | Added Epic 12: Main Menu System (ä¸»èœå•ç³»ç»Ÿå®Œæ•´å®ç°). | Sarah (PO) |
| 2025-11-27 | 1.8 | Added Epic 17: Zombie Generation Engine (åƒµå°¸ç”Ÿæˆå¼•æ“). | Sarah (PO) |
| 2025-11-29 | 1.9 | Added Epic 18: Battle Save System (æ¸¸æˆæˆ˜æ–—å­˜æ¡£ç³»ç»Ÿ). | John (PM) |
| 2025-12-01 | 2.0 | Added Epic 19: Level 1-5 Wall-nut Bowling (åšæœä¿é¾„çƒ). | Sarah (PO) |
| 2025-12-03 | 2.1 | Added Epic 20: Go Embed & Cross-Platform Storage (èµ„æºåµŒå…¥ä¸è·¨å¹³å°å­˜å‚¨). | Bob (SM) |
| 2025-12-04 | 2.2 | Added Epic 21: Cross-Platform Build & CI/CD (è·¨å¹³å°æ„å»ºä¸CI/CD). | Sarah (PO) |

## **2. Requirements (éœ€æ±‚)**

### **Functional (åŠŸèƒ½æ€§éœ€æ±‚)**
*   **FR1: ä¸»èœå•ç³»ç»Ÿ** - æ¸¸æˆå¿…é¡»æä¾›ä¸€ä¸ªä¸»èœå•ç•Œé¢ï¼ŒåŒ…å«å¯äº¤äº’çš„â€œå¼€å§‹å†’é™©â€å’Œâ€œé€€å‡ºæ¸¸æˆâ€æŒ‰é’®ã€‚
*   **FR2: æ¸¸æˆåœºæ™¯åŠ è½½** - ç©å®¶ç‚¹å‡»â€œå¼€å§‹å†’é™©â€åï¼Œç³»ç»Ÿå¿…é¡»èƒ½åŠ è½½å‰é™¢ç™½å¤©åœºæ™¯çš„è‰åªç½‘æ ¼ã€èƒŒæ™¯å’ŒUIå…ƒç´ ã€‚
*   **FR3: é˜³å…‰ç”Ÿæˆæœºåˆ¶** - ç³»ç»Ÿå¿…é¡»å®ç°ä¸¤ç§é˜³å…‰ç”Ÿæˆæ–¹å¼ï¼š
    *   FR3.1: å¤©ç©ºä¸­ä¼šå‘¨æœŸæ€§åœ°éšæœºæ‰è½é˜³å…‰ã€‚
    *   FR3.2: ç©å®¶ç§æ¤çš„å‘æ—¥è‘µä¼šå‘¨æœŸæ€§åœ°ç”Ÿäº§é˜³å…‰ã€‚
*   **FR4: é˜³å…‰æ”¶é›†ä¸è®¡æ•°** - ç©å®¶å¿…é¡»èƒ½é€šè¿‡ç‚¹å‡»é˜³å…‰æ¥æ”¶é›†å®ƒä»¬ï¼Œå¹¶åœ¨UIçš„é˜³å…‰è®¡æ•°å™¨ä¸Šå®æ—¶æ›´æ–°æ€»æ•°ã€‚
*   **FR5: æ¤ç‰©é€‰æ‹©ä¸å†·å´** - æ¸¸æˆç•Œé¢å¿…é¡»å±•ç¤ºä¸€ä¸ªæ¤ç‰©é€‰æ‹©æ ï¼ŒåŒ…å«MVPèŒƒå›´å†…çš„æ¤ç‰©å¡ç‰‡ï¼ˆå‘æ—¥è‘µã€è±Œè±†å°„æ‰‹ã€åšæœå¢™ã€æ¨±æ¡ƒç‚¸å¼¹ï¼‰ã€‚é€‰æ‹©ä¸€ä¸ªæ¤ç‰©åï¼Œè¯¥å¡ç‰‡è¿›å…¥å†·å´å€’è®¡æ—¶ï¼ŒæœŸé—´ä¸å¯ç”¨ã€‚
*   **FR6: æ¤ç‰©ç§æ¤** - ç©å®¶å¿…é¡»èƒ½åœ¨èŠ±è´¹è¶³å¤Ÿé˜³å…‰çš„å‰æä¸‹ï¼Œå°†é€‰æ‹©çš„æ¤ç‰©ç§æ¤åœ¨è‰åªçš„æœ‰æ•ˆæ ¼å­å†…ã€‚
*   **FR7: æ¤ç‰©è¡Œä¸º** - å·²ç§æ¤çš„æ¤ç‰©å¿…é¡»èƒ½æ‰§è¡Œå…¶æ ¸å¿ƒè¡Œä¸ºï¼š
    *   FR7.1: **å‘æ—¥è‘µ** - æŒ‰é¢„å®šå‘¨æœŸç”Ÿäº§é˜³å…‰ã€‚
    *   FR7.2: **è±Œè±†å°„æ‰‹** - å½“åŒä¸€è¡Œå‡ºç°åƒµå°¸æ—¶ï¼Œèƒ½è‡ªåŠ¨å‘å°„è±Œè±†å­å¼¹è¿›è¡Œæ”»å‡»ã€‚
    *   FR7.3: **åšæœå¢™** - èƒ½é˜»æŒ¡åƒµå°¸å‰è¿›ï¼Œå¹¶å…·æœ‰ç‹¬ç«‹çš„ç”Ÿå‘½å€¼ã€‚
    *   FR7.4: **æ¨±æ¡ƒç‚¸å¼¹** - ç§æ¤åçŸ­æš‚å»¶è¿Ÿå³çˆ†ç‚¸ï¼Œæ¶ˆç­å‘¨å›´æ ¼å­å†…çš„æ‰€æœ‰åƒµå°¸ã€‚
*   **FR8: åƒµå°¸ç”Ÿæˆ** - ç³»ç»Ÿå¿…é¡»èƒ½æ ¹æ®å…³å¡è®¾è®¡ï¼Œä»å±å¹•å³ä¾§ç”Ÿæˆä¸€æ³¢åˆä¸€æ³¢çš„åƒµå°¸ï¼ŒåŒ…æ‹¬æ™®é€šã€è·¯éšœå’Œé“æ¡¶åƒµå°¸ã€‚
*   **FR9: åƒµå°¸è¡Œä¸º** - åƒµå°¸å¿…é¡»èƒ½æ‰§è¡Œå…¶æ ¸å¿ƒè¡Œä¸ºï¼š
    *   FR9.1: æ²¿å›ºå®šè¡Œä»å³å‘å·¦ç§»åŠ¨ã€‚
    *   FR9.2: é‡åˆ°æ¤ç‰©æ—¶ï¼Œä¼šåœä¸‹æ¥è¿›è¡Œå•ƒé£Ÿã€‚
    *   FR9.3: å…·æœ‰ç‹¬ç«‹çš„ç”Ÿå‘½å€¼ï¼Œå½“ç”Ÿå‘½å€¼é™ä¸ºé›¶æ—¶ä¼šæ­»äº¡å¹¶æ¶ˆå¤±ã€‚
    *   FR9.4: è·¯éšœå’Œé“æ¡¶åƒµå°¸åœ¨é˜²æŠ¤ç‰©è¢«æ‘§æ¯å‰å…·æœ‰æ›´é«˜çš„é˜²å¾¡åŠ›ã€‚
*   **FR10: ä¼¤å®³ä¸ç¢°æ’** - å¿…é¡»å®ç°è±Œè±†å­å¼¹ä¸åƒµå°¸çš„ç¢°æ’æ£€æµ‹ï¼Œå¹¶æ ¹æ®æ”»å‡»åŠ›è®¡ç®—å¯¹åƒµå°¸é€ æˆçš„ä¼¤å®³ã€‚
*   **FR11: é“²å­åŠŸèƒ½** - ç©å®¶å¿…é¡»èƒ½ä½¿ç”¨é“²å­å·¥å…·ï¼Œç§»é™¤è‰åªä¸Šä»»æ„ä¸€ä¸ªå·²ç§æ¤çš„æ¤ç‰©ã€‚
*   **FR12: æ¸¸æˆè¿›ç¨‹** - æ¸¸æˆå¿…é¡»èƒ½æ˜¾ç¤ºå…³å¡è¿›åº¦æ¡ï¼Œå¹¶åœ¨æœ€åä¸€æ³¢åƒµå°¸æ¥ä¸´æ—¶ç»™äºˆæç¤ºã€‚
*   **FR13: èƒœåˆ©/å¤±è´¥æ¡ä»¶** - å¿…é¡»å®ç°æ˜ç¡®çš„æ¸¸æˆç»“æŸæ¡ä»¶ï¼š
    *   FR13.1: **èƒœåˆ©** - ç©å®¶æˆåŠŸæ¶ˆç­å½“å‰å…³å¡çš„æ‰€æœ‰åƒµå°¸ã€‚
    *   FR13.2: **å¤±è´¥** - ä»»æ„ä¸€ä¸ªåƒµå°¸åˆ°è¾¾å±å¹•æœ€å·¦ä¾§çš„æˆ¿å­ã€‚

### **Non-Functional (éåŠŸèƒ½æ€§éœ€æ±‚)**
*   **NFR1: æ€§èƒ½** - æ¸¸æˆåœ¨æ»¡è´Ÿè·åœºæ™¯ï¼ˆå¤§é‡æ¤ç‰©ã€åƒµå°¸å’Œå­å¼¹åŒå±ï¼‰ä¸‹ï¼Œå¿…é¡»ä¿æŒæµç•…è¿è¡Œï¼ˆç›®æ ‡60 FPSï¼‰ã€‚
*   **NFR2: å¿ å®åº¦** - æ‰€æœ‰çš„æ¸¸æˆæ•°å€¼ï¼ˆå¦‚æ¤ç‰©æ”»å‡»åŠ›ã€åƒµå°¸ç”Ÿå‘½å€¼ã€é˜³å…‰å€¼ã€å†·å´æ—¶é—´ï¼‰å’Œè¡Œä¸ºèŠ‚å¥éƒ½åº”ä¸åŸç‰ˆPCæ¸¸æˆä¿æŒé«˜åº¦ä¸€è‡´ã€‚
*   **NFR3: å¹³å°å…¼å®¹æ€§** - æ¸¸æˆå¿…é¡»èƒ½é€šè¿‡EbitengineæˆåŠŸæ‰“åŒ…ï¼Œå¹¶åœ¨Windowsã€macOSå’ŒLinuxå¹³å°ä¸Šç‹¬ç«‹è¿è¡Œã€‚
*   **NFR4: å¯æ‰©å±•æ€§** - ä»£ç æ¶æ„å¿…é¡»æ˜¯æ¨¡å—åŒ–çš„ï¼Œä»¥ä¾¿åœ¨MVPå®Œæˆåï¼Œèƒ½ä»¥æœ€å°çš„ä»£ä»·æ·»åŠ æ–°çš„æ¤ç‰©ã€åƒµå°¸æˆ–æ¸¸æˆåœºæ™¯ã€‚

## **3. User Interface Design Goals (ç”¨æˆ·ç•Œé¢è®¾è®¡ç›®æ ‡)**

### **Overall UX Vision (æ•´ä½“ç”¨æˆ·ä½“éªŒæ„¿æ™¯)**
æ•´ä½“ç”¨æˆ·ä½“éªŒæ—¨åœ¨ç²¾ç¡®å¤åˆ¶åŸç‰ˆPCæ¸¸æˆçš„æ ¸å¿ƒäº¤äº’é€»è¾‘å’Œè§†è§‰åé¦ˆã€‚ç©å®¶åº”è·å¾—ä¸2009å¹´åŸç‰ˆæ¸¸æˆå‡ ä¹å®Œå…¨ä¸€è‡´çš„ã€ç›´è§‚ä¸”ä»¤äººæ€€å¿µçš„å¡”é˜²æ¸¸æˆä½“éªŒã€‚æ‰€æœ‰çš„UIå…ƒç´ éƒ½åº”æœåŠ¡äºæ ¸å¿ƒç©æ³•ï¼Œä¿¡æ¯æ¸…æ™°æ˜“è¯»ï¼Œæ“ä½œæµç•…ç›´æ¥ã€‚

### **Key Interaction Paradigms (å…³é”®äº¤äº’æ¨¡å¼)**
*   **ç›´æ¥æ“æ§:** ç©å®¶é€šè¿‡é¼ æ ‡ç‚¹å‡»ä¸æ‰€æœ‰æ¸¸æˆå…ƒç´ è¿›è¡Œäº¤äº’ï¼ˆæ”¶é›†é˜³å…‰ã€é€‰æ‹©å¡ç‰‡ã€ç§æ¤æ¤ç‰©ã€ä½¿ç”¨é“²å­ï¼‰ã€‚
*   **å³æ—¶åé¦ˆ:** æ¯ä¸€æ¬¡æœ‰æ•ˆçš„ç©å®¶æ“ä½œéƒ½åº”æœ‰å³æ—¶çš„è§†è§‰å’Œå¬è§‰åé¦ˆï¼ˆå¦‚ç‚¹å‡»é˜³å…‰çš„â€œå™—â€å£°å’Œæ¶ˆå¤±åŠ¨ç”»ï¼Œé€‰æ‹©å¡ç‰‡æ—¶çš„éŸ³æ•ˆï¼‰ã€‚
*   **çŠ¶æ€å¯è§æ€§:** æ¸¸æˆçš„æ ¸å¿ƒçŠ¶æ€ï¼ˆé˜³å…‰æ•°é‡ã€æ¤ç‰©å¡ç‰‡å†·å´çŠ¶æ€ã€å…³å¡è¿›åº¦ï¼‰å¿…é¡»å§‹ç»ˆæ¸…æ™°å¯è§ã€‚

### **Core Screens and Views (æ ¸å¿ƒå±å¹•ä¸è§†å›¾)**
*   **ä¸»èœå• (Main Menu):** åŒ…å«å¢“ç¢‘èƒŒæ™¯ï¼Œæä¾›â€œå¼€å§‹å†’é™©â€å’Œâ€œé€€å‡ºæ¸¸æˆâ€çš„é€‰é¡¹ã€‚
*   **æ¸¸æˆä¸»ç•Œé¢ (In-Game UI):** è¿™æ˜¯æ ¸å¿ƒè§†å›¾ï¼ŒåŒ…å«ï¼š
    *   **æ¤ç‰©é€‰æ‹©æ :** ä½äºå±å¹•å·¦ä¸Šè§’ï¼Œæ¨ªå‘æ’åˆ—æ‰€æœ‰å¯ç”¨çš„æ¤ç‰©å¡ç‰‡ã€‚
    *   **é˜³å…‰è®¡æ•°å™¨:** ä½äºæ¤ç‰©é€‰æ‹©æ å·¦ä¾§ï¼Œå®æ—¶æ˜¾ç¤ºç©å®¶æ‹¥æœ‰çš„é˜³å…‰æ•°é‡ã€‚
    *   **æ¸¸æˆåŒºåŸŸ:** ä¸­å¤®çš„5x9è‰åªç½‘æ ¼ã€‚
    *   **é“²å­:** ä½äºæ¤ç‰©é€‰æ‹©æ ä¸‹æ–¹ï¼Œç”¨äºç§»é™¤æ¤ç‰©ã€‚
    *   **å…³å¡è¿›åº¦æ¡:** ä½äºå±å¹•å³ä¸‹è§’ï¼Œæ˜¾ç¤ºå½“å‰åƒµå°¸æ³¢æ¬¡å’Œæ——å¸œã€‚
*   **æ¸¸æˆèƒœåˆ©/å¤±è´¥ç•Œé¢ (Win/Loss Screen):** æ¸¸æˆç»“æŸåå¼¹å‡ºçš„ä¿¡æ¯ç•Œé¢ï¼Œå®£å‘Šæ¸¸æˆç»“æœã€‚

### **Accessibility (å¯è®¿é—®æ€§)**
*   **ç›®æ ‡:** æ— ç‰¹å®šå¢å¼ºè¦æ±‚ï¼Œä¸åŸç‰ˆä¿æŒä¸€è‡´ã€‚ä¸»è¦é€šè¿‡æ¸…æ™°çš„è§†è§‰è®¾è®¡å’Œç‹¬ç‰¹çš„éŸ³æ•ˆæ¥åŒºåˆ†ä¸åŒäº‹ä»¶ã€‚

### **Branding (å“ç‰Œ)**
*   **ç›®æ ‡:** 100%å¿ å®äºåŸç‰ˆã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹çš„å“ç‰Œé£æ ¼ï¼Œä½¿ç”¨å·²å¤‡å¥½çš„æ‰€æœ‰å®˜æ–¹UIç´ æã€å­—ä½“ï¼ˆæˆ–ç±»ä¼¼å­—ä½“ï¼‰å’ŒLogoã€‚

### **Target Device and Platforms (ç›®æ ‡è®¾å¤‡ä¸å¹³å°)**
*   **ç›®æ ‡:** Web Responsive (å“åº”å¼ç½‘é¡µ)ã€‚è™½ç„¶ä¼˜å…ˆæ”¯æŒPCï¼Œä½†é‡‡ç”¨å“åº”å¼è®¾è®¡å°†ä½¿æœªæ¥ç§»æ¤åˆ°ä¸åŒåˆ†è¾¨ç‡æˆ–å¹³å°çš„å¯èƒ½æ€§æ›´å¤§ï¼ŒåŒæ—¶ä¹Ÿèƒ½åœ¨ä¸åŒå¤§å°çš„PCçª—å£ä¸­æœ‰è‰¯å¥½è¡¨ç°ã€‚

## **4. Technical Assumptions (æŠ€æœ¯å‡è®¾)**

### **Repository Structure: Monorepo (å•ä½“ä»“åº“)**
*   æˆ‘ä»¬å°†é‡‡ç”¨å•ä½“ä»“åº“ï¼ˆMonorepoï¼‰çš„ç»“æ„ã€‚å°½ç®¡å½“å‰é¡¹ç›®åªæœ‰ä¸€ä¸ªæ ¸å¿ƒåº”ç”¨ï¼Œä½†è¿™ç§ç»“æ„ä¸ºæœªæ¥å¯èƒ½çš„æ‰©å±•ï¼ˆå¦‚ç‹¬ç«‹çš„å…³å¡ç¼–è¾‘å™¨ã€åç«¯æœåŠ¡ç­‰ï¼‰æä¾›äº†ä¾¿åˆ©ï¼Œå¹¶ä¸”ä¾¿äºç®¡ç†å…±äº«ä»£ç å’Œé…ç½®ã€‚

### **Service Architecture (æœåŠ¡æ¶æ„)**
*   **æ¶æ„:** Monolith (å•ä½“åº”ç”¨)ã€‚
*   **è¯´æ˜:** æ•´ä¸ªæ¸¸æˆå°†ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ã€å•ä¸€çš„ç¼–è¯‘åå¯æ‰§è¡Œæ–‡ä»¶ã€‚æ‰€æœ‰æ¸¸æˆé€»è¾‘ã€æ¸²æŸ“å’ŒçŠ¶æ€ç®¡ç†éƒ½åœ¨è¿™ä¸€ä¸ªè¿›ç¨‹ä¸­å®Œæˆã€‚è¿™å¯¹äºä¸€ä¸ªå®¢æˆ·ç«¯æ¸¸æˆæ¥è¯´æ˜¯æ ‡å‡†ä¸”æœ€é«˜æ•ˆçš„æ¶æ„ï¼Œå®Œå…¨ç¬¦åˆæˆ‘ä»¬çš„å­¦ä¹ ç›®æ ‡ã€‚

### **Testing Requirements (æµ‹è¯•è¦æ±‚)**
*   **è¦æ±‚:** Unit + Integration (å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•)ã€‚
*   **è¯´æ˜:** æˆ‘ä»¬å°†å¯¹æ ¸å¿ƒçš„ã€æ— å‰¯ä½œç”¨çš„æ¸¸æˆé€»è¾‘ï¼ˆä¾‹å¦‚ä¼¤å®³è®¡ç®—ã€é˜³å…‰ç”Ÿæˆç®—æ³•ï¼‰ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œä»¥ç¡®ä¿å…¶æ­£ç¡®æ€§ã€‚å¯¹äºæ¨¡å—é—´çš„äº¤äº’ï¼ˆä¾‹å¦‚æ¤ç‰©ä¸åƒµå°¸çš„äº’åŠ¨ï¼‰ï¼Œæˆ‘ä»¬å°†é€šè¿‡é›†æˆæµ‹è¯•æ¥éªŒè¯ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬å­¦ä¹ å¦‚ä½•åœ¨Goä¸­ç¼–å†™å¯æµ‹è¯•çš„æ¸¸æˆä»£ç ã€‚

### **Additional Technical Assumptions and Requests (å…¶ä»–æŠ€æœ¯å‡è®¾ä¸è¦æ±‚)**
*   **è¯­è¨€å’Œå¼•æ“:** ä¸¥æ ¼ä½¿ç”¨Goè¯­è¨€å’ŒEbitengineæ¸¸æˆå¼•æ“çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬ã€‚
*   **ä¾èµ–æœ€å°åŒ–:** ä¼˜å…ˆä½¿ç”¨Goæ ‡å‡†åº“å’ŒEbitengineå†…ç½®åŠŸèƒ½ï¼Œè°¨æ…å¼•å…¥ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œä»¥ä¿æŒé¡¹ç›®ç®€æ´å’Œèšç„¦ã€‚
*   **æ•°æ®é©±åŠ¨:** é¼“åŠ±é‡‡ç”¨æ•°æ®é©±åŠ¨çš„è®¾è®¡ã€‚æ¤ç‰©ã€åƒµå°¸å’Œå…³å¡çš„å±æ€§ï¼ˆå¦‚ç”Ÿå‘½å€¼ã€æ”»å‡»åŠ›ã€ç”Ÿæˆé¡ºåºï¼‰åº”ä»å¤–éƒ¨é…ç½®æ–‡ä»¶ï¼ˆå¦‚JSONæˆ–YAMLï¼‰åŠ è½½ï¼Œè€Œä¸æ˜¯ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ã€‚è¿™æå¤§åœ°ç®€åŒ–äº†æ•°å€¼è°ƒæ•´å’Œæœªæ¥å†…å®¹çš„æ‰©å±•ã€‚
*   **å¹³å°:** ä¼˜å…ˆä¸ºPCå¹³å°ï¼ˆWindows, macOS, Linuxï¼‰æ„å»ºï¼Œä½†ä»£ç å®ç°åº”è€ƒè™‘è·¨å¹³å°å…¼å®¹æ€§ï¼Œä¸ºæœªæ¥å¯èƒ½çš„Webï¼ˆWASMï¼‰æˆ–ç§»åŠ¨ç«¯ç§»æ¤åšå‡†å¤‡ã€‚

## **5. Epic List (å²è¯—åˆ—è¡¨)**

*   **Epic 1: æ¸¸æˆåŸºç¡€æ¡†æ¶ä¸ä¸»å¾ªç¯ (Game Foundation & Main Loop)**
    *   **ç›®æ ‡:** æ­å»ºæ•´ä¸ªGo+Ebitengineé¡¹ç›®çš„åŸºæœ¬ç»“æ„ï¼Œåˆ›å»ºä¸€ä¸ªå¯ä»¥è¿è¡Œçš„ç©ºçª—å£ï¼Œå¹¶å®ç°æ¸¸æˆçš„æ ¸å¿ƒçŠ¶æ€ç®¡ç†å’Œä¸»èœå•ã€‚è¿™æ˜¯æ‰€æœ‰åç»­åŠŸèƒ½çš„åŸºç¡€ã€‚
*   **Epic 2: æ ¸å¿ƒèµ„æºä¸ç©å®¶äº¤äº’ (Core Resources & Player Interaction)**
    *   **ç›®æ ‡:** å®ç°é˜³å…‰çš„ç”Ÿæˆã€æ”¶é›†å’Œè®¡æ•°ç³»ç»Ÿï¼Œå¹¶å»ºç«‹ç©å®¶ä¸æ¸¸æˆä¸–ç•Œçš„åŸºç¡€äº¤äº’ï¼Œå¦‚é€šè¿‡é¼ æ ‡ç‚¹å‡»è¿›è¡Œæ“ä½œã€‚
*   **Epic 3: æ¤ç‰©ç³»ç»Ÿä¸éƒ¨ç½² (Planting System & Deployment)**
    *   **ç›®æ ‡:** å®ç°å®Œæ•´çš„æ¤ç‰©ç§æ¤æµç¨‹ï¼ŒåŒ…æ‹¬ä»UIå¡ç‰‡æ é€‰æ‹©æ¤ç‰©ã€æ¶ˆè€—é˜³å…‰ã€æ”¾ç½®åœ¨è‰åªä¸Šï¼Œå¹¶å¤„ç†å†·å´é€»è¾‘ã€‚æˆ‘ä»¬å°†é¦–å…ˆå®ç°å‘æ—¥è‘µå’Œè±Œè±†å°„æ‰‹ã€‚
*   **Epic 4: åŸºç¡€åƒµå°¸ä¸æˆ˜æ–—é€»è¾‘ (Basic Zombies & Combat Logic)**
    *   **ç›®æ ‡:** åœ¨æ¸¸æˆä¸­å¼•å…¥åŸºç¡€çš„åƒµå°¸ï¼ˆæ™®é€šåƒµå°¸ï¼‰ï¼Œå®ç°åƒµå°¸çš„ç§»åŠ¨ã€æ¤ç‰©çš„è‡ªåŠ¨æ”»å‡»ï¼ˆè±Œè±†å°„æ‰‹ï¼‰ä»¥åŠå­å¼¹ä¸åƒµå°¸çš„ç¢°æ’å’Œä¼¤å®³è®¡ç®—ã€‚
*   **Epic 5: æ¸¸æˆæµç¨‹ä¸é«˜çº§å•ä½ (Game Flow & Advanced Units)**
    *   **ç›®æ ‡:** å®ç°å®Œæ•´çš„å…³å¡æµç¨‹æ§åˆ¶ï¼ˆåƒµå°¸æ³¢æ¬¡ã€è¿›åº¦æ¡ï¼‰ï¼Œå¹¶å¼•å…¥æ›´å¤æ‚çš„å•ä½ï¼ˆåšæœå¢™ã€æ¨±æ¡ƒç‚¸å¼¹ã€è·¯éšœ/é“æ¡¶åƒµå°¸ï¼‰æ¥å®ŒæˆMVPçš„å…¨éƒ¨æ ¸å¿ƒç©æ³•ã€‚
*   **Epic 6: åŠ¨ç”»ç³»ç»Ÿè¿ç§» - åŸç‰ˆ Reanim éª¨éª¼åŠ¨ç”»ç³»ç»Ÿ (Animation System Migration - Reanim)**
    *   **ç›®æ ‡:** å°†ç®€å•å¸§åŠ¨ç”»ç³»ç»Ÿç›´æ¥æ›¿æ¢ä¸ºåŸç‰ˆ PVZ çš„ Reanim éª¨éª¼åŠ¨ç”»ç³»ç»Ÿï¼Œå®ç° 100% è¿˜åŸåŸç‰ˆåŠ¨ç”»æ•ˆæœï¼Œæ”¯æŒéƒ¨ä»¶å˜æ¢å’Œå¤æ‚åŠ¨ç”»è¡¨ç°ã€‚
*   **Epic 7: ç²’å­ç‰¹æ•ˆç³»ç»Ÿ (Particle Effect System) - Brownfield Enhancement**
    *   **ç›®æ ‡:** å®ç°å®Œæ•´çš„ç²’å­ç‰¹æ•ˆç³»ç»Ÿï¼Œæ”¯æŒåŸç‰ˆPVZçš„æ‰€æœ‰è§†è§‰ç‰¹æ•ˆï¼ˆåƒµå°¸è‚¢ä½“æ‰è½ã€çˆ†ç‚¸ã€æº…å°„ç­‰ï¼‰ï¼Œé€šè¿‡è§£æXMLé…ç½®å’Œé«˜æ€§èƒ½æ‰¹é‡æ¸²æŸ“æŠ€æœ¯ï¼Œä¸ºæ¸¸æˆæä¾›ä¸°å¯Œçš„è§†è§‰åé¦ˆã€‚
*   **Epic 8: ç¬¬ä¸€ç« å…³å¡å®ç° - å‰é™¢ç™½å¤© (Chapter 1: Day Level Implementation)**
    *   **ç›®æ ‡:** å®ç°ã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹ç¬¬ä¸€ç« (å‰é™¢ç™½å¤©)çš„å…¨éƒ¨ 10 ä¸ªå…³å¡,åŒ…æ‹¬åŸç‰ˆå¿ å®çš„å…³å¡æœºåˆ¶ã€æ•™å­¦å¼•å¯¼ç³»ç»Ÿ(1-1å•è¡Œè‰åœ°å¼•å¯¼)ã€å¼€åœºåŠ¨ç”»ç³»ç»Ÿ(å¯é…ç½®è·³è¿‡)ã€é€‰å¡ç•Œé¢å’Œç‰¹æ®Šå…³å¡ç±»å‹(1-5åšæœä¿é¾„çƒã€1-10ä¼ é€å¸¦æ¨¡å¼),ä¸ºç©å®¶æä¾›å®Œæ•´çš„å†’é™©æ¨¡å¼ç¬¬ä¸€ç« ä½“éªŒã€‚è¯¦è§ [Epic 8 è¯¦ç»†æ–‡æ¡£](prd/epic-8-level-chapter1-implementation.md)ã€‚
*   **Epic 9: ECS æ¡†æ¶æ³›å‹åŒ–é‡æ„ (ECS Generics Refactor) - Brownfield Enhancement**
    *   **ç›®æ ‡:** å°†å½“å‰åŸºäºåå°„çš„ ECS æ¡†æ¶è¿ç§»åˆ° Go æ³›å‹å®ç°ï¼Œé€šè¿‡ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œæ¶ˆé™¤è¿è¡Œæ—¶åå°„å¼€é”€ï¼Œæå‡ä»£ç å¯è¯»æ€§å’Œç±»å‹å®‰å…¨æ€§ï¼Œä¸ºåç»­å¼€å‘æä¾›æ›´é«˜æ•ˆçš„å¼€å‘ä½“éªŒã€‚è¯¦è§ [Epic 9 è¯¦ç»†æ–‡æ¡£](prd/epic-9-ecs-generics-refactor.md)ã€‚
*   **Epic 10: æ¸¸æˆä½“éªŒå®Œå–„ (Game Experience Polish) - Brownfield Enhancement**
    *   **ç›®æ ‡:** å®Œå–„æ ¸å¿ƒæ¸¸æˆä½“éªŒï¼Œå®ç°æš‚åœèœå•ã€æ¤ç‰©æ”»å‡»åŠ¨ç”»ã€ç²’å­ç‰¹æ•ˆå’Œé™¤è‰è½¦é˜²çº¿ç³»ç»Ÿï¼Œæå‡æ¸¸æˆçš„å®Œæ•´æ€§å’Œå¯ç©æ€§ï¼Œç¡®ä¿æ‰€æœ‰æ ¸å¿ƒæœºåˆ¶ç¬¦åˆåŸç‰ˆæ¸¸æˆæ ‡å‡†ã€‚è¯¦è§ [Epic 10 è¯¦ç»†æ–‡æ¡£](prd/epic-10-game-experience-polish.md)ã€‚
*   **Epic 11: å…³å¡ UI å¢å¼º (Level UI Enhancement)**
    *   **ç›®æ ‡:** å®Œå–„ã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹å…³å¡ç•Œé¢çš„è§†è§‰ä½“éªŒå’Œä¿¡æ¯å±•ç¤ºï¼Œå®ç°é“ºè‰çš®åœŸç²’é£æº…ç‰¹æ•ˆã€æœ€åä¸€æ³¢åƒµå°¸æç¤ºåŠ¨ç”»å’Œå®Œæ•´çš„å…³å¡è¿›åº¦æ¡ç³»ç»Ÿï¼Œæå‡æ¸¸æˆçš„æ²‰æµ¸æ„Ÿå’Œä¿¡æ¯å¯è¯»æ€§ï¼Œç¡®ä¿å…³å¡ UI ç¬¦åˆåŸç‰ˆæ¸¸æˆæ ‡å‡†ã€‚è¯¦è§ [Epic 11 è¯¦ç»†æ–‡æ¡£](prd/epic-11-level-ui-enhancement.md)ã€‚
*   **Epic 17: åƒµå°¸ç”Ÿæˆå¼•æ“ (Zombie Generation Engine)**
    *   **ç›®æ ‡:** å®ç°ã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹å†’é™©æ¨¡å¼çš„ç²¾ç¡®åƒµå°¸ç”Ÿæˆç³»ç»Ÿï¼ŒåŒ…æ‹¬éš¾åº¦åŠ¨æ€è°ƒæ•´ã€è¡Œåˆ†é…å¹³æ»‘æƒé‡ç®—æ³•ã€æ³¢æ¬¡è®¡æ—¶æ§åˆ¶å’Œæ——å¸œæ³¢ç‰¹æ®Šæœºåˆ¶ï¼Œå®Œå…¨è¿˜åŸåŸç‰ˆæ¸¸æˆçš„å‡ºæ€ªé€»è¾‘å’Œæ¸¸æˆèŠ‚å¥ã€‚è¯¦è§ [Epic 17 è¯¦ç»†æ–‡æ¡£](prd/epic-17-zombie-generation-engine.md)ã€‚
*   **Epic 18: æ¸¸æˆæˆ˜æ–—å­˜æ¡£ç³»ç»Ÿ (Battle Save System) - Brownfield Enhancement**
    *   **ç›®æ ‡:** ä¸ºã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹å¤åˆ»ç‰ˆå®ç°æˆ˜æ–—ä¸­å­˜æ¡£/è¯»æ¡£åŠŸèƒ½ã€‚ç©å®¶ç‚¹å‡»æš‚åœèœå•çš„"ä¸»èœå•"æŒ‰é’®æ—¶è‡ªåŠ¨ä¿å­˜å½“å‰æˆ˜æ–—è¿›åº¦ï¼Œå†æ¬¡è¿›å…¥å†’é™©æ¨¡å¼æ—¶å¯é€‰æ‹©ç»§ç»­æ¸¸æˆæˆ–é‡ç©å…³å¡ï¼Œæä¾›ç®€æ´çš„ç”¨æˆ·äº¤äº’ä½“éªŒã€‚è¯¦è§ [Epic 18 è¯¦ç»†æ–‡æ¡£](prd/epic-18-battle-save-system.md)ã€‚
*   **Epic 19: å…³å¡ 1-5 åšæœä¿é¾„çƒ (Level 1-5: Wall-nut Bowling)**
    *   **ç›®æ ‡:** å®ç°ç¬¬ä¸€ç« ç¬¬äº”å…³"åšæœä¿é¾„çƒ"ï¼ŒåŒ…å«é“²å­æ•™å­¦é˜¶æ®µï¼ˆç–¯ç‹‚æˆ´å¤«å¯¹è¯ã€å¼ºå¼•å¯¼æœºåˆ¶ã€é¢„è®¾æ¤ç‰©ï¼‰å’Œä¿é¾„çƒç©æ³•é˜¶æ®µï¼ˆä¼ é€å¸¦ç³»ç»Ÿã€ä¿é¾„çƒç‰©ç†ã€çˆ†ç‚¸åšæœï¼‰ï¼Œä¸ºç©å®¶æä¾›ç‹¬ç‰¹çš„è¿·ä½ æ¸¸æˆä½“éªŒã€‚è¯¦è§ [Epic 19 è¯¦ç»†æ–‡æ¡£](prd/epic-19-level-1-5-bowling.md)ã€‚
*   **Epic 20: Go Embed èµ„æºåµŒå…¥ä¸è·¨å¹³å°å­˜å‚¨ (Go Embed & Cross-Platform Storage)**
    *   **ç›®æ ‡:** ä½¿ç”¨ Go çš„ `embed` åŠŸèƒ½å°†æ¸¸æˆèµ„æºï¼ˆassets/ å’Œ data/ï¼‰æ‰“åŒ…è¿›å¯æ‰§è¡Œç¨‹åºï¼Œå®ç°å•ä¸€å¯æ‰§è¡Œæ–‡ä»¶åˆ†å‘ï¼›ä½¿ç”¨ gdata åº“å®ç°è·¨å¹³å°ç”¨æˆ·æ•°æ®å­˜å‚¨ï¼ˆå­˜æ¡£ã€è®¾ç½®ï¼‰ï¼Œæ”¯æŒæ¡Œé¢ç«¯ã€ç§»åŠ¨ç«¯å’Œ WASM å¹³å°ã€‚è¯¦è§ [Epic 20 è¯¦ç»†æ–‡æ¡£](prd/epic-20-embed-cross-platform-storage.md)ã€‚
*   **Epic 21: è·¨å¹³å°æ„å»ºä¸ CI/CD (Cross-Platform Build & CI/CD)** â­**NEW**
    *   **ç›®æ ‡:** ä¸ºæ¸¸æˆåˆ›å»ºå®Œæ•´çš„è·¨å¹³å°æ„å»ºç³»ç»Ÿå’Œ CI/CD æµæ°´çº¿ï¼Œæ”¯æŒ Linuxã€Windowsã€macOSã€Androidã€iOS å’Œ Web (WASM) å…­å¤§å¹³å°çš„è‡ªåŠ¨åŒ–æ„å»ºä¸å‘å¸ƒï¼Œé€šè¿‡ Makefile å’Œ GitHub Actions å®ç°æ ‡å‡†åŒ–çš„æ„å»ºæµç¨‹ã€‚è¯¦è§ [Epic 21 è¯¦ç»†æ–‡æ¡£](prd/epic-21-cross-platform-build-cicd.md)ã€‚

## **Epic 1: æ¸¸æˆåŸºç¡€æ¡†æ¶ä¸ä¸»å¾ªç¯ (Game Foundation & Main Loop)**
**å²è¯—ç›®æ ‡:** æ­å»ºæ•´ä¸ªGo+Ebitengineé¡¹ç›®çš„åŸºæœ¬ç»“æ„ï¼Œåˆ›å»ºä¸€ä¸ªå¯ä»¥è¿è¡Œçš„ç©ºçª—å£ï¼Œå¹¶å®ç°æ¸¸æˆçš„æ ¸å¿ƒçŠ¶æ€ç®¡ç†å’Œä¸»èœå•ã€‚è¿™æ˜¯æ‰€æœ‰åç»­åŠŸèƒ½çš„åŸºç¡€ã€‚

---
**Story 1.1: é¡¹ç›®åˆå§‹åŒ–ä¸çª—å£åˆ›å»º**
> **As a** å¼€å‘è€…,
> **I want** to set up the Go project structure and initialize an Ebitengine application,
> **so that** I have a running window which will serve as the canvas for the game.

**Acceptance Criteria:**
1.  é¡¹ç›®éµå¾ªGo Modulesçš„æ ‡å‡†ç»“æ„ã€‚
2.  Ebitengineè¢«æˆåŠŸæ·»åŠ ä¸ºé¡¹ç›®ä¾èµ–ã€‚
3.  è¿è¡Œ `go run .` æŒ‡ä»¤åï¼Œå±å¹•ä¸Šä¼šæ˜¾ç¤ºä¸€ä¸ªå›ºå®šå¤§å°ï¼ˆä¾‹å¦‚800x600åƒç´ ï¼‰çš„ç©ºç™½çª—å£ã€‚
4.  çª—å£æ ‡é¢˜åº”è®¾ç½®ä¸º"æ¤ç‰©å¤§æˆ˜åƒµå°¸ - Goå¤åˆ»ç‰ˆ"ã€‚
5.  å¯ä»¥é€šè¿‡ç‚¹å‡»çª—å£çš„å…³é—­æŒ‰é’®æ­£å¸¸é€€å‡ºåº”ç”¨ç¨‹åºã€‚

---
**Story 1.2: æ¸¸æˆçŠ¶æ€æœºä¸åœºæ™¯ç®¡ç†**
> **As a** å¼€å‘è€…,
> **I want** to implement a basic game state machine,
> **so that** the game can switch between different scenes like 'Main Menu' and 'In-Game'.

**Acceptance Criteria:**
1.  å­˜åœ¨ä¸€ä¸ªæ¸¸æˆçŠ¶æ€ç®¡ç†å™¨ï¼ˆä¾‹å¦‚ `SceneManager`ï¼‰ã€‚
2.  å®šä¹‰äº†è‡³å°‘ä¸¤ç§åœºæ™¯çŠ¶æ€ï¼š`MainMenuScene` å’Œ `GameScene`ã€‚
3.  æ¸¸æˆå¯åŠ¨æ—¶ï¼Œé»˜è®¤è¿›å…¥å¹¶æ˜¾ç¤º `MainMenuScene`ã€‚
4.  `SceneManager` æä¾›äº†åˆ‡æ¢åœºæ™¯çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ `SwitchToScene(...)`ï¼‰ã€‚
5.  æ¯ä¸ªåœºæ™¯éƒ½æœ‰è‡ªå·±çš„ `Update` å’Œ `Draw` é€»è¾‘ã€‚

---
**Story 1.3: èµ„æºç®¡ç†å™¨æ¡†æ¶**
> **As a** å¼€å‘è€…,
> **I want** to create a resource manager that can load image and audio files,
> **so that** game assets can be centrally managed and accessed by any part of the game.

**Acceptance Criteria:**
1.  å­˜åœ¨ä¸€ä¸ªèµ„æºç®¡ç†å™¨ï¼ˆä¾‹å¦‚ `ResourceManager`ï¼‰ï¼Œåœ¨æ¸¸æˆå¯åŠ¨æ—¶åˆå§‹åŒ–ã€‚
2.  å¯ä»¥æˆåŠŸåŠ è½½ä¸€ä¸ªPNGæ ¼å¼çš„å›¾ç‰‡æ–‡ä»¶ï¼ˆä¾‹å¦‚ä¸»èœå•èƒŒæ™¯ï¼‰å¹¶åœ¨åœºæ™¯ä¸­ä½¿ç”¨ã€‚
3.  å¯ä»¥æˆåŠŸåŠ è½½ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼ˆä¾‹å¦‚ä¸»èœå•èƒŒæ™¯éŸ³ä¹ï¼‰å¹¶å¾ªç¯æ’­æ”¾ã€‚
4.  å¦‚æœèµ„æºåŠ è½½å¤±è´¥ï¼Œæ¸¸æˆåº”èƒ½æ‰“å°é”™è¯¯æ—¥å¿—è€Œä¸æ˜¯ç›´æ¥å´©æºƒã€‚
5.  èµ„æºåº”åªè¢«åŠ è½½ä¸€æ¬¡ï¼Œå¹¶åœ¨å†…å­˜ä¸­é‡å¤ä½¿ç”¨ã€‚

---
**Story 1.4: ä¸»èœå•UIä¸äº¤äº’**
> **As a** ç©å®¶,
> **I want** to see and interact with the main menu,
> **so that** I can start the game or exit.

**Acceptance Criteria:**
1.  ä¸»èœå•åœºæ™¯ (`MainMenuScene`) å¿…é¡»æ˜¾ç¤ºæ­£ç¡®çš„èƒŒæ™¯å›¾ç‰‡ã€‚
2.  ä¸»èœå•å¿…é¡»æ˜¾ç¤º"å¼€å§‹å†’é™©"å’Œ"é€€å‡ºæ¸¸æˆ"ä¸¤ä¸ªæŒ‰é’®ï¼ˆæš‚æ—¶å¯ä»¥æ˜¯æ–‡å­—æˆ–ç®€å•å›¾å½¢ï¼‰ã€‚
3.  é¼ æ ‡æ‚¬åœåœ¨æŒ‰é’®ä¸Šæ—¶ï¼ŒæŒ‰é’®æœ‰è§†è§‰å˜åŒ–ï¼ˆä¾‹å¦‚å˜è‰²æˆ–æ”¾å¤§ï¼‰ã€‚
4.  ç‚¹å‡»"å¼€å§‹å†’é™©"æŒ‰é’®åï¼Œæ¸¸æˆçŠ¶æ€ä¼šé€šè¿‡ `SceneManager` åˆ‡æ¢åˆ° `GameScene`ã€‚
5.  ç‚¹å‡»"é€€å‡ºæ¸¸æˆ"æŒ‰é’®åï¼Œåº”ç”¨ç¨‹åºä¼šæ­£å¸¸å…³é—­ã€‚

## **Epic 2: æ ¸å¿ƒèµ„æºä¸ç©å®¶äº¤äº’ (Core Resources & Player Interaction)**
**å²è¯—ç›®æ ‡:** å®ç°é˜³å…‰çš„ç”Ÿæˆã€æ”¶é›†å’Œè®¡æ•°ç³»ç»Ÿï¼Œå¹¶å»ºç«‹ç©å®¶ä¸æ¸¸æˆä¸–ç•Œçš„åŸºç¡€äº¤äº’ï¼Œå¦‚é€šè¿‡é¼ æ ‡ç‚¹å‡»è¿›è¡Œæ“ä½œã€‚

---
**Story 2.1: æ¸¸æˆåœºæ™¯UIæ¡†æ¶**
> **As a** å¼€å‘è€…,
> **I want** to load and display the basic in-game UI elements for the daytime lawn scene,
> **so that** I have the foundational layout for placing game state information.

**Acceptance Criteria:**
1.  `GameScene` å¯åŠ¨æ—¶ï¼Œä¼šç»˜åˆ¶æ­£ç¡®çš„è‰åªèƒŒæ™¯ã€‚
2.  å±å¹•å·¦ä¸Šè§’ä¼šç»˜åˆ¶æ¤ç‰©é€‰æ‹©æ çš„èƒŒæ™¯æ¡†ã€‚
3.  æ¤ç‰©é€‰æ‹©æ å·¦ä¾§ä¼šç»˜åˆ¶é˜³å…‰è®¡æ•°å™¨çš„èƒŒæ™¯æ¡†ã€‚
4.  é“²å­çš„å›¾æ ‡å’ŒèƒŒæ™¯ä¼šç»˜åˆ¶åœ¨æ¤ç‰©é€‰æ‹©æ ä¸‹æ–¹ã€‚
5.  æ‰€æœ‰UIå…ƒç´ çš„ä½ç½®å’Œå¤§å°åº”ä¸åŸç‰ˆæ¸¸æˆå¸ƒå±€ä¸€è‡´ã€‚

---
**Story 2.2: æ¸¸æˆå…¨å±€çŠ¶æ€ç®¡ç†**
> **As a** å¼€å‘è€…,
> **I want** to create a central game state manager,
> **so that** I can track and modify global variables like the player's current sun count.

**Acceptance Criteria:**
1.  å­˜åœ¨ä¸€ä¸ªå…¨å±€å¯è®¿é—®çš„æ¸¸æˆçŠ¶æ€å®ä¾‹ï¼ˆä¾‹å¦‚ `GameState`ï¼‰ã€‚
2.  `GameState` åŒ…å«ä¸€ä¸ª `Sun` å­—æ®µï¼Œç”¨äºå­˜å‚¨å½“å‰é˜³å…‰æ•°é‡ï¼Œåˆå§‹å€¼ä¸º50ã€‚
3.  UIä¸Šçš„é˜³å…‰è®¡æ•°å™¨èƒ½è¯»å–å¹¶æ­£ç¡®æ˜¾ç¤º `GameState.Sun` çš„å€¼ã€‚
4.  æä¾›å¢åŠ å’Œå‡å°‘é˜³å…‰çš„æ–¹æ³•ï¼ˆä¾‹å¦‚ `AddSun(amount)` å’Œ `SpendSun(amount)`ï¼‰ã€‚
5.  å½“è°ƒç”¨ `AddSun` æˆ– `SpendSun` åï¼ŒUIä¸Šçš„é˜³å…‰è®¡æ•°å™¨ä¼šå®æ—¶æ›´æ–°ã€‚

---
**Story 2.3: è‡ªç„¶é˜³å…‰æ‰è½**
> **As a** ç©å®¶,
> **I want** to see suns periodically fall from the sky,
> **so that** I can collect them as a primary resource.

**Acceptance Criteria:**
1.  æ¸¸æˆå¼€å§‹åï¼Œä¼šæŒ‰ç…§ä¸€å®šçš„æ—¶é—´é—´éš”ï¼ˆä¾‹å¦‚5-10ç§’ï¼‰ä»å±å¹•é¡¶éƒ¨çš„éšæœºä½ç½®ç”Ÿæˆä¸€ä¸ªé˜³å…‰å•ä½ã€‚
2.  é˜³å…‰å•ä½ä¼šä»¥å¹³æ»‘çš„åŠ¨ç”»å‚ç›´ä¸‹è½ï¼Œå¹¶åœç•™åœ¨è‰åªåŒºåŸŸå†…çš„ä¸€ä¸ªéšæœºä½ç½®ã€‚
3.  é˜³å…‰å•ä½åœ¨åœ°é¢ä¸Šåœç•™ä¸€æ®µæ—¶é—´åï¼ˆä¾‹å¦‚8ç§’ï¼‰ï¼Œå¦‚æœæ²¡æœ‰è¢«æ”¶é›†ï¼Œä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚
4.  åŒä¸€æ—¶é—´å±å¹•ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªæ‰è½çš„é˜³å…‰ã€‚

---
**Story 2.4: é˜³å…‰æ”¶é›†**
> **As a** ç©å®¶,
> **I want** to be able to click on suns to collect them,
> **so that** I can increase my sun resource count.

**Acceptance Criteria:**
1.  å½“é¼ æ ‡ç‚¹å‡»ä¸€ä¸ªé˜³å…‰å•ä½æ—¶ï¼Œè¯¥é˜³å…‰å•ä½ä¼šæ’­æ”¾ä¸€ä¸ªé£å‘å·¦ä¸Šè§’é˜³å…‰è®¡æ•°å™¨çš„åŠ¨ç”»ã€‚
2.  å½“åŠ¨ç”»ç»“æŸæ—¶ï¼Œé˜³å…‰å•ä½ä»å±å¹•ä¸Šæ¶ˆå¤±ã€‚
3.  åŒæ—¶ï¼Œå…¨å±€çš„é˜³å…‰æ•°é‡ä¼šå¢åŠ 25ï¼ˆ`GameState.AddSun(25)`ï¼‰ã€‚
4.  é˜³å…‰å•ä½åœ¨è¢«ç‚¹å‡»åï¼Œå°±ä¸èƒ½å†æ¬¡è¢«ç‚¹å‡»ã€‚
5.  æ”¶é›†é˜³å…‰æ—¶ä¼šæ’­æ”¾æ­£ç¡®çš„éŸ³æ•ˆã€‚

## **Epic 3: æ¤ç‰©ç³»ç»Ÿä¸éƒ¨ç½² (Planting System & Deployment)**
**å²è¯—ç›®æ ‡:** å®ç°å®Œæ•´çš„æ¤ç‰©ç§æ¤æµç¨‹ï¼ŒåŒ…æ‹¬ä»UIå¡ç‰‡æ é€‰æ‹©æ¤ç‰©ã€æ¶ˆè€—é˜³å…‰ã€æ”¾ç½®åœ¨è‰åªä¸Šï¼Œå¹¶å¤„ç†å†·å´é€»è¾‘ã€‚æˆ‘ä»¬å°†é¦–å…ˆå®ç°å‘æ—¥è‘µå’Œè±Œè±†å°„æ‰‹ã€‚

---
**Story 3.1: æ¤ç‰©å¡ç‰‡UIä¸çŠ¶æ€**
> **As a** ç©å®¶,
> **I want** to see the plant cards in the selection bar,
> **so that** I know which plants are available for planting.

**Acceptance Criteria:**
1.  æ¤ç‰©é€‰æ‹©æ ä¸­ä¼šæ­£ç¡®æ˜¾ç¤ºå‘æ—¥è‘µå’Œè±Œè±†å°„æ‰‹çš„å¡ç‰‡å›¾åƒã€‚
2.  æ¯ä¸ªå¡ç‰‡ä¸‹æ–¹ä¼šæ˜¾ç¤ºç§æ¤æ‰€éœ€çš„é˜³å…‰æ•°é‡ï¼ˆå‘æ—¥è‘µ:50, è±Œè±†å°„æ‰‹:100ï¼‰ã€‚
3.  å½“ç©å®¶é˜³å…‰æ•°é‡ä¸è¶³æ—¶æˆ–å¤„äºå†·å´çŠ¶æ€æ—¶ï¼Œå¯¹åº”çš„æ¤ç‰©å¡ç‰‡ä¼šå˜æš—æˆ–æ˜¾ç¤ºä¸ºä¸å¯ç”¨çŠ¶æ€ã€‚
4.  å½“ä¸€ä¸ªæ¤ç‰©å¡ç‰‡å¤„äºå†·å´çŠ¶æ€æ—¶ï¼Œ å¡ç‰‡ä¼šè¢«æ¯”é˜³å…‰ä¸è¶³æ—¶çš„æ›´æ·±çš„åŠé€æ˜é»‘è‰²è¦†ç›–ï¼Œå¹¶ä»ä¸‹åˆ°ä¸Šæ¸æ¸æ¢å¤ï¼Œæ¨¡æ‹Ÿå†·å´è®¡æ—¶å™¨ã€‚
5.  å½“å†·å´ç»“æŸåï¼Œåˆ¤æ–­é˜³å…‰æ•°é‡å¦‚æœè¶³å¤Ÿï¼Œå¡ç‰‡æ¢å¤æ­£å¸¸å¯ç”¨çŠ¶æ€ï¼Œå¦‚æœé˜³å…‰ä¸å¤Ÿï¼Œä¿æŒå˜æš—çŠ¶æ€ã€‚

---
**Story 3.2: æ¤ç‰©é€‰æ‹©ä¸è·Ÿéš**
> **As a** ç©å®¶,
> **I want** to be able to click on an available plant card,
> **so that** I can prepare to plant it on the lawn.

**Acceptance Criteria:**
1.  å½“ç©å®¶ç‚¹å‡»ä¸€ä¸ªå¯ç”¨ï¼ˆé˜³å…‰å……è¶³ä¸”éå†·å´ï¼‰çš„æ¤ç‰©å¡ç‰‡æ—¶ï¼Œé¼ æ ‡æŒ‡é’ˆä¼šå˜æˆè¯¥æ¤ç‰©çš„åŠé€æ˜å›¾åƒã€‚
2.  åŒæ—¶ï¼Œæ¸¸æˆè¿›å…¥â€œç§æ¤æ¨¡å¼â€ï¼Œå…¨å±€æ¸¸æˆçŠ¶æ€ä¼šè®°å½•å½“å‰è¢«é€‰æ‹©çš„æ¤ç‰©ç±»å‹ã€‚
3.  å½“é¼ æ ‡åœ¨è‰åªç½‘æ ¼ä¸Šç§»åŠ¨æ—¶ï¼ŒåŠé€æ˜çš„æ¤ç‰©å›¾åƒä¼šè·Ÿéšé¼ æ ‡ï¼Œå¹¶è‡ªåŠ¨å¯¹é½åˆ°é¼ æ ‡æ‰€åœ¨çš„æ ¼å­ä¸­å¿ƒã€‚
4.  æ­¤æ—¶ï¼Œå†æ¬¡ç‚¹å‡»æ¤ç‰©å¡ç‰‡æ æˆ–ç‚¹å‡»é¼ æ ‡å³é”®ï¼Œå¯ä»¥å–æ¶ˆâ€œç§æ¤æ¨¡å¼â€ï¼Œé¼ æ ‡æ¢å¤æ­£å¸¸æŒ‡é’ˆã€‚

---
**Story 3.3: æ¤ç‰©ç§æ¤åˆ°è‰åª**
> **As a** ç©å®¶,
> **I want** to be able to place the selected plant onto a valid grid cell,
> **so that** it appears on the lawn and starts performing its function.

**Acceptance Criteria:**
1.  åœ¨â€œç§æ¤æ¨¡å¼â€ä¸‹ï¼Œå½“ç©å®¶åœ¨è‰åªçš„ä¸€ä¸ªç©ºæ ¼å­ä¸Šç‚¹å‡»é¼ æ ‡å·¦é”®æ—¶ï¼Œä¼šåœ¨è¯¥æ ¼å­ç§ä¸‹ä¸€ä¸ªæ–°çš„æ¤ç‰©å®ä¾‹ã€‚
2.  ç§æ¤æˆåŠŸåï¼Œç©å®¶çš„é˜³å…‰æ€»æ•°ä¼šæ‰£é™¤è¯¥æ¤ç‰©å¯¹åº”çš„æ¶ˆè€—å€¼ã€‚
3.  åŒæ—¶ï¼Œè¯¥æ¤ç‰©çš„å¡ç‰‡ä¼šç«‹å³è¿›å…¥å†·å´çŠ¶æ€ã€‚
4.  æ¸¸æˆé€€å‡ºâ€œç§æ¤æ¨¡å¼â€ï¼Œé¼ æ ‡æ¢å¤æ­£å¸¸ã€‚
5.  ç§æ¤æ—¶ä¼šæ’­æ”¾æ­£ç¡®çš„éŸ³æ•ˆã€‚
6.  ä¸èƒ½åœ¨å·²ç»æœ‰æ¤ç‰©çš„æ ¼å­ä¸Šç§æ¤æ–°çš„æ¤ç‰©ã€‚

---
**Story 3.4: å‘æ—¥è‘µè¡Œä¸ºå®ç°**
> **As a** å¼€å‘è€…,
> **I want** to implement the behavior for the Sunflower,
> **so that** it can produce suns for the player.

**Acceptance Criteria:**
1.  å‘æ—¥è‘µè¢«ç§æ¤åï¼Œä¼šå¼€å§‹ä¸€ä¸ªå†…éƒ¨è®¡æ—¶å™¨ã€‚
2.  å½“è®¡æ—¶å™¨åˆ°è¾¾é¢„å®šå‘¨æœŸåï¼Œå‘æ—¥è‘µä¼šåœ¨è‡ªèº«é™„è¿‘ç”Ÿæˆä¸€ä¸ªé˜³å…‰å•ä½ã€‚
3.  è¯¥é˜³å…‰å•ä½çš„è¡Œä¸ºä¸å¤©ç”Ÿæ‰è½çš„é˜³å…‰å®Œå…¨ä¸€è‡´ï¼ˆå¯ä»¥è¢«ç‚¹å‡»æ”¶é›†ï¼‰ã€‚
4.  ç”Ÿäº§é˜³å…‰åï¼Œå‘æ—¥è‘µçš„å†…éƒ¨è®¡æ—¶å™¨ä¼šé‡ç½®ã€‚
5.  å‘æ—¥è‘µä¼šæ’­æ”¾å…¶â€œç”Ÿäº§é˜³å…‰â€çš„åŠ¨ç”»ã€‚

## **Epic 4: åŸºç¡€åƒµå°¸ä¸æˆ˜æ–—é€»è¾‘ (Basic Zombies & Combat Logic)**
**å²è¯—ç›®æ ‡:** åœ¨æ¸¸æˆä¸­å¼•å…¥åŸºç¡€çš„åƒµå°¸ï¼ˆæ™®é€šåƒµå°¸ï¼‰ï¼Œå®ç°åƒµå°¸çš„ç§»åŠ¨ã€æ¤ç‰©çš„è‡ªåŠ¨æ”»å‡»ï¼ˆè±Œè±†å°„æ‰‹ï¼‰ä»¥åŠå­å¼¹ä¸åƒµå°¸çš„ç¢°æ’å’Œä¼¤å®³è®¡ç®—ã€‚

---
**Story 4.1: åŸºç¡€åƒµå°¸ç”Ÿæˆä¸ç§»åŠ¨**
> **As a** å¼€å‘è€…,
> **I want** to spawn a basic zombie that moves from right to left,
> **so that** the player has an antagonist to defend against.

**Acceptance Criteria:**
1.  æ¸¸æˆå¯ä»¥ä»å±å¹•å³ä¾§è¾¹ç¼˜ä¹‹å¤–çš„ç‰¹å®šè¡Œç”Ÿæˆä¸€ä¸ªæ™®é€šåƒµå°¸ã€‚
2.  åƒµå°¸ç”Ÿæˆåï¼Œä¼šä»¥æ’å®šçš„é€Ÿåº¦æ²¿å…¶æ‰€åœ¨çš„è¡Œä»å³å‘å·¦ç§»åŠ¨ã€‚
3.  åƒµå°¸ä¼šæ’­æ”¾å…¶èµ°è·¯çš„åŠ¨ç”»ã€‚
4.  åƒµå°¸ç§»åŠ¨æ—¶ï¼Œå…¶è§†è§‰å±‚æ¬¡åº”æ­£ç¡®å¤„ç†ï¼ˆä¾‹å¦‚ï¼Œä¸ä¼šè¦†ç›–åœ¨ä¸Šæ–¹çš„UIå…ƒç´ ä¸Šï¼‰ã€‚

---
**Story 4.2: è±Œè±†å°„æ‰‹è¡Œä¸ºå®ç°**
> **As a** å¼€å‘è€…,
> **I want** to implement the behavior for the Peashooter,
> **so that** it can attack zombies in its lane.

**Acceptance Criteria:**
1.  è±Œè±†å°„æ‰‹è¢«ç§æ¤åï¼Œä¼šå‘¨æœŸæ€§åœ°æ‰«æå…¶æ‰€åœ¨çš„è¡Œã€‚
2.  å½“å…¶æ­£å‰æ–¹ï¼ˆå³ä¾§ï¼‰çš„åŒä¸€è¡Œå‡ºç°äº†åƒµå°¸æ—¶ï¼Œè±Œè±†å°„æ‰‹ä¼šè¿›å…¥æ”»å‡»çŠ¶æ€ã€‚
3.  åœ¨æ”»å‡»çŠ¶æ€ä¸‹ï¼Œè±Œè±†å°„æ‰‹ä¼šæŒ‰ç…§å›ºå®šçš„æ—¶é—´é—´éš”ï¼Œä»å…¶å£éƒ¨å‘å°„è±Œè±†å­å¼¹ã€‚
4.  å‘å°„å­å¼¹æ—¶ï¼Œè±Œè±†å°„æ‰‹ä¼šæ’­æ”¾å…¶æ”»å‡»åŠ¨ç”»ã€‚
5.  å¦‚æœæ²¡æœ‰åƒµå°¸åœ¨å…¶è¡Œä¸Šï¼Œè±Œè±†å°„æ‰‹ä¼šä¿æŒé™æ­¢ï¼ˆidleï¼‰çŠ¶æ€ã€‚

---
**Story 4.3: å­å¼¹ç§»åŠ¨ä¸ç¢°æ’**
> **As a** å¼€å‘è€…,
> **I want** to make the pea projectile move and detect collisions with zombies,
> **so that** damage can be dealt.

**Acceptance Criteria:**
1.  è±Œè±†å­å¼¹ä»è±Œè±†å°„æ‰‹å¤„è¢«å‘å°„åï¼Œä¼šä»¥æ’å®šçš„é€Ÿåº¦æ²¿ç›´çº¿å‘å³ç§»åŠ¨ã€‚
2.  å­å¼¹éœ€è¦æœ‰ä¸€ä¸ªç¢°æ’ä½“ï¼ˆä¾‹å¦‚çŸ©å½¢ï¼‰ã€‚
3.  å½“å­å¼¹çš„ç¢°æ’ä½“ä¸ä¸€ä¸ªåƒµå°¸çš„ç¢°æ’ä½“å‘ç”Ÿé‡å æ—¶ï¼Œåˆ¤å®šä¸ºå‘½ä¸­ã€‚
4.  å‘½ä¸­åï¼Œå­å¼¹ä¼šæ¶ˆå¤±ï¼Œå¹¶æ’­æ”¾ä¸€ä¸ªâ€œå‡»ä¸­â€çš„è§†è§‰æ•ˆæœï¼ˆä¾‹å¦‚ä¸€ä¸ªæ°´èŠ±ï¼‰ã€‚
5.  å­å¼¹é£å‡ºå±å¹•èŒƒå›´åä¼šè‡ªåŠ¨é”€æ¯ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚

---
**Story 4.4: åƒµå°¸ç”Ÿå‘½å€¼ä¸æ­»äº¡**
> **As a** å¼€å‘è€…,
> **I want** zombies to have health and be defeated,
> **so that** the player's defense is meaningful.

**Acceptance Criteria:**
1.  æ¯ä¸ªåƒµå°¸å®ä¾‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç”Ÿå‘½å€¼ï¼ˆHealth Pointsï¼‰ã€‚
2.  å½“ä¸€ä¸ªåƒµå°¸è¢«è±Œè±†å­å¼¹å‘½ä¸­æ—¶ï¼Œå…¶ç”Ÿå‘½å€¼ä¼šå‡å°‘ä¸€ä¸ªå›ºå®šçš„æ•°å€¼ã€‚
3.  å½“åƒµå°¸ç”Ÿå‘½å€¼é™åˆ°0æˆ–ä»¥ä¸‹æ—¶ï¼Œåƒµå°¸ä¼šæ­»äº¡ã€‚
4.  åƒµå°¸æ­»äº¡æ—¶ï¼Œä¼šå…ˆæ’­æ”¾å…¶æ­»äº¡åŠ¨ç”»ï¼ˆä¾‹å¦‚å¤´æ‰ä¸‹æ¥ï¼‰ï¼ŒåŠ¨ç”»æ’­æ”¾å®Œæ¯•åï¼Œåƒµå°¸å¯¹è±¡ä¼šä»æ¸¸æˆä¸­ç§»é™¤ã€‚
5.  å‡»ä¸­åƒµå°¸æ—¶ä¼šæ’­æ”¾æ­£ç¡®çš„éŸ³æ•ˆã€‚

## **Epic 5: æ¸¸æˆæµç¨‹ä¸é«˜çº§å•ä½ (Game Flow & Advanced Units)**
**å²è¯—ç›®æ ‡:** å®ç°å®Œæ•´çš„å…³å¡æµç¨‹æ§åˆ¶ï¼ˆåƒµå°¸æ³¢æ¬¡ã€è¿›åº¦æ¡ï¼‰ï¼Œå¹¶å¼•å…¥æ›´å¤æ‚çš„å•ä½ï¼ˆåšæœå¢™ã€æ¨±æ¡ƒç‚¸å¼¹ã€è·¯éšœ/é“æ¡¶åƒµå°¸ï¼‰æ¥å®ŒæˆMVPçš„å…¨éƒ¨æ ¸å¿ƒç©æ³•ã€‚

---
**Story 5.1: åƒµå°¸å•ƒé£Ÿä¸æ¤ç‰©ç”Ÿå‘½å€¼**
> **As a** åƒµå°¸,
> **I want** to stop and eat plants I encounter,
> **so that** I can clear a path to the player's house.

**Acceptance Criteria:**
1.  æ‰€æœ‰æ¤ç‰©ï¼ˆå‘æ—¥è‘µã€è±Œè±†å°„æ‰‹ç­‰ï¼‰ç°åœ¨éƒ½æ‹¥æœ‰ç‹¬ç«‹çš„ç”Ÿå‘½å€¼ã€‚
2.  å½“åƒµå°¸ç§»åŠ¨åˆ°ä¸æ¤ç‰©åŒä¸€ä¸ªæ ¼å­æ—¶ï¼Œå®ƒä¼šåœæ­¢ç§»åŠ¨å¹¶å¼€å§‹æ’­æ”¾å•ƒé£ŸåŠ¨ç”»ã€‚
3.  åœ¨å•ƒé£ŸçŠ¶æ€ä¸‹ï¼Œåƒµå°¸ä¼šå‘¨æœŸæ€§åœ°å¯¹æ¤ç‰©é€ æˆä¼¤å®³ï¼Œå‡å°‘æ¤ç‰©çš„ç”Ÿå‘½å€¼ã€‚
4.  å½“æ¤ç‰©ç”Ÿå‘½å€¼é™åˆ°0æˆ–ä»¥ä¸‹æ—¶ï¼Œæ¤ç‰©ä¼šä»è‰åªä¸Šæ¶ˆå¤±ã€‚
5.  æ¤ç‰©è¢«æ¶ˆç­åï¼Œåƒµå°¸ä¼šç»§ç»­å‘å·¦ç§»åŠ¨ã€‚
6.  å•ƒé£Ÿæ¤ç‰©æ—¶ä¼šæ’­æ”¾æ­£ç¡®çš„éŸ³æ•ˆã€‚

---
**Story 5.2: åšæœå¢™è¡Œä¸ºå®ç°**
> **As a** ç©å®¶,
> **I want** to plant a Wall-nut with high health,
> **so that** I can effectively block zombies.

**Acceptance Criteria:**
1.  ç©å®¶å¯ä»¥åœ¨æ¤ç‰©é€‰æ‹©æ ä¸­é€‰æ‹©å¹¶ç§æ¤åšæœå¢™ã€‚
2.  åšæœå¢™è¢«ç§æ¤åï¼Œä¼šä¿æŒåœ¨åŸåœ°ï¼Œæ²¡æœ‰æ”»å‡»è¡Œä¸ºã€‚
3.  åšæœå¢™æ‹¥æœ‰æ¯”å…¶ä»–æ¤ç‰©é«˜å¾—å¤šçš„ç”Ÿå‘½å€¼ã€‚
4.  åšæœå¢™ä¼šæ ¹æ®å…¶å‰©ä½™ç”Ÿå‘½å€¼ç™¾åˆ†æ¯”ï¼Œæ˜¾ç¤ºä¸åŒçš„å—æŸå¤–è§‚ï¼ˆä¾‹å¦‚å‡ºç°è£‚ç—•ï¼‰ã€‚
5.  å½“ç”Ÿå‘½å€¼è¢«è€—å°½æ—¶ï¼Œåšæœå¢™ä¼šæ¶ˆå¤±ã€‚

---
**Story 5.3: é«˜çº§åƒµå°¸è¡Œä¸ºå®ç°**
> **As a** ç©å®¶,
> **I want** to face tougher zombies like Conehead and Buckethead,
> **so that** the game provides a greater challenge.

**Acceptance Criteria:**
1.  æ¸¸æˆä¸­å¯ä»¥ç”Ÿæˆè·¯éšœåƒµå°¸å’Œé“æ¡¶åƒµå°¸ã€‚
2.  è·¯éšœåƒµå°¸å’Œé“æ¡¶åƒµå°¸æ‹¥æœ‰ä¸€ä¸ªé¢å¤–çš„â€œå¤´éƒ¨é˜²å…·â€ç”Ÿå‘½å€¼å±‚ã€‚
3.  å½“åƒµå°¸å—åˆ°ä¼¤å®³æ—¶ï¼Œä¼˜å…ˆæ‰£é™¤å…¶â€œå¤´éƒ¨é˜²å…·â€çš„ç”Ÿå‘½å€¼ã€‚
4.  å½“â€œå¤´éƒ¨é˜²å…·â€ç”Ÿå‘½å€¼è€—å°½æ—¶ï¼Œå…¶å¤–è§‚ä¼šæ”¹å˜ï¼ˆè·¯éšœ/é“æ¡¶æ‰è½ï¼‰ï¼Œå¹¶ä¸”åƒµå°¸çš„è¡Œä¸ºå’Œç”Ÿå‘½å€¼ä¼šå˜ä¸ºä¸€ä¸ªæ™®é€šåƒµå°¸ã€‚
5.  è¿™ä¸¤ç§åƒµå°¸çš„æ€»æœ‰æ•ˆç”Ÿå‘½å€¼è¿œé«˜äºæ™®é€šåƒµå°¸ã€‚

---
**Story 5.4: æ¨±æ¡ƒç‚¸å¼¹è¡Œä¸ºå®ç°**
> **As a** ç©å®¶,
> **I want** to use a Cherry Bomb to clear a group of zombies,
> **so that** I can handle emergency situations.

**Acceptance Criteria:**
1.  ç©å®¶å¯ä»¥åœ¨æ¤ç‰©é€‰æ‹©æ ä¸­é€‰æ‹©å¹¶ç§æ¤æ¨±æ¡ƒç‚¸å¼¹ã€‚
2.  ç§æ¤åï¼Œæ¨±æ¡ƒç‚¸å¼¹ä¼šæœ‰ä¸€ä¸ªçŸ­æš‚çš„â€œå¼•ä¿¡â€åŠ¨ç”»ã€‚
3.  åŠ¨ç”»ç»“æŸåï¼Œæ¨±æ¡ƒç‚¸å¼¹ä¼šå‘ç”Ÿçˆ†ç‚¸ï¼Œå¹¶ç«‹å³ä»æ¸¸æˆä¸­æ¶ˆå¤±ã€‚
4.  çˆ†ç‚¸ä¼šå¯¹ä»¥è‡ªèº«ä¸ºä¸­å¿ƒçš„3x3èŒƒå›´å†…çš„æ‰€æœ‰åƒµå°¸é€ æˆå·¨é‡ä¼¤å®³ï¼Œè¶³ä»¥æ¶ˆç­MVPèŒƒå›´å†…çš„ä»»ä½•åƒµå°¸ã€‚
5.  çˆ†ç‚¸æ—¶ä¼šæ’­æ”¾æ­£ç¡®çš„è§†è§‰å’Œå£°éŸ³æ•ˆæœã€‚

---
**Story 5.5: å…³å¡æµç¨‹ç®¡ç†**
> **As a** ç©å®¶,
> **I want** to experience a structured level with waves of zombies and a clear goal,
> **so that** the game feels like a complete experience.

**Acceptance Criteria:**
1.  æ¸¸æˆä¼šä»ä¸€ä¸ªå¤–éƒ¨é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ `level-1-1.json`ï¼‰åŠ è½½å…³å¡æ•°æ®ã€‚
2.  å…³å¡æ•°æ®å®šä¹‰äº†åƒµå°¸å‡ºç°çš„æ³¢æ¬¡ã€æ¯ä¸€æ³¢çš„åƒµå°¸ç±»å‹å’Œæ•°é‡ã€‚
3.  æ¸¸æˆç•Œé¢å³ä¸‹è§’ä¼šæœ‰ä¸€ä¸ªå…³å¡è¿›åº¦æ¡ï¼Œæ˜¾ç¤ºå½“å‰æ³¢æ¬¡å’Œæ€»æ³¢æ¬¡ã€‚
4.  åœ¨æœ€åä¸€æ³¢åƒµå°¸åˆ°æ¥ä¹‹å‰ï¼Œå±å¹•ä¸Šä¼šå‡ºç°"A huge wave of zombies is approaching"çš„æç¤ºã€‚
5.  å½“ç©å®¶æ¶ˆç­æ‰€æœ‰æ³¢æ¬¡çš„åƒµå°¸åï¼Œæ¸¸æˆä¼šæš‚åœï¼Œå¹¶æ˜¾ç¤ºèƒœåˆ©ç•Œé¢ã€‚
6.  å¦‚æœä»»ä½•ä¸€ä¸ªåƒµå°¸èµ°åˆ°äº†å±å¹•æœ€å·¦ç«¯ï¼Œæ¸¸æˆä¼šç«‹å³æš‚åœï¼Œå¹¶æ˜¾ç¤ºå¤±è´¥ç•Œé¢ã€‚

## **Epic 6: åŠ¨ç”»ç³»ç»Ÿè¿ç§» - åŸç‰ˆ Reanim éª¨éª¼åŠ¨ç”»ç³»ç»Ÿ (Animation System Migration - Reanim)**
**å²è¯—ç›®æ ‡:** å°†å½“å‰åŸºäºç®€å•å¸§æ•°ç»„çš„åŠ¨ç”»ç³»ç»Ÿç›´æ¥æ›¿æ¢ä¸ºåŸç‰ˆ PVZ çš„ Reanim éª¨éª¼åŠ¨ç”»ç³»ç»Ÿï¼Œå®ç° 100% è¿˜åŸåŸç‰ˆåŠ¨ç”»æ•ˆæœï¼Œæ”¯æŒéƒ¨ä»¶å˜æ¢å’Œå¤æ‚åŠ¨ç”»è¡¨ç°ã€‚

**èƒŒæ™¯:** ç°æœ‰çš„ç®€å•å¸§æ•°ç»„åŠ¨ç”»ç³»ç»Ÿæ— æ³•å®ç°åŸç‰ˆ PVZ çš„ç²¾ç»†åŠ¨ç”»æ•ˆæœã€‚é¡¹ç›®å·²å‡†å¤‡å¥½åŸç‰ˆ Reanim èµ„æºï¼ˆ`assets/effect/reanim/*.reanim` å’Œéƒ¨ä»¶å›¾ç‰‡ï¼‰ï¼Œå¹¶æœ‰å‚è€ƒå®ç°å¯ä¾›å€Ÿé‰´ã€‚æœ¬ Epic é‡‡ç”¨ç›´æ¥æ›¿æ¢ç­–ç•¥ï¼Œä¸è€ƒè™‘å‘åå…¼å®¹æ€§ï¼Œä»¥ç®€åŒ–å®ç°ã€‚

---
**Story 6.1: Reanim åŸºç¡€è®¾æ–½ï¼ˆè§£æå™¨å’Œèµ„æºåŠ è½½ï¼‰**
> **As a** å¼€å‘è€…,
> **I want** to parse Reanim XML files and load sprite parts,
> **so that** I can use original PVZ animation data.

**Acceptance Criteria:**
1.  å®ç° `ReanimXML`, `Track`, `Frame` æ•°æ®ç»“æ„ï¼ˆå¯¹åº”åŸç‰ˆæ ¼å¼ï¼‰ã€‚
2.  å®ç° XML è§£æå™¨ `internal/reanim/parser.go`ã€‚
3.  è§£æå™¨èƒ½æˆåŠŸè§£æè‡³å°‘ 3 ä¸ª Reanim æ–‡ä»¶ï¼ˆPeaShooter, Sunflower, Wallnutï¼‰ã€‚
4.  å®ç°èµ„æºåŠ è½½å™¨æ‰©å±•ï¼Œæ”¯æŒæŒ‰ Reanim å®šä¹‰åŠ è½½éƒ¨ä»¶å›¾ç‰‡ã€‚
5.  å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%ã€‚
6.  ä¸å‚è€ƒå®ç° `test_animation_viewer.go` çš„æ•°æ®ç»“æ„å¯¹æ¯”éªŒè¯ã€‚

---
**Story 6.2: ReanimComponent å’Œ ReanimSystemï¼ˆæ ¸å¿ƒåŠ¨ç”»é€»è¾‘ï¼‰**
> **As a** å¼€å‘è€…,
> **I want** to replace the old animation system with Reanim system,
> **so that** entities can use complex skeletal animations.

**Acceptance Criteria:**
1.  **åˆ é™¤** `pkg/components/animation.go` å’Œ `pkg/systems/animation_system.go`ï¼ˆæ—§åŠ¨ç”»ç³»ç»Ÿï¼‰ã€‚
2.  **åˆ›å»º** `pkg/components/reanim_component.go`ï¼ˆæ–°ç»„ä»¶ï¼ŒåŒ…å«éƒ¨ä»¶å›¾ç‰‡æ˜ å°„å’ŒåŠ¨ç”»çŠ¶æ€ï¼‰ã€‚
3.  **åˆ›å»º** `pkg/systems/reanim_system.go`ï¼ˆæ–°ç³»ç»Ÿï¼Œå®ç°åŠ¨ç”»æ’­æ”¾é€»è¾‘ï¼‰ã€‚
4.  å®ç°å¸§æ¨è¿›ã€å¾ªç¯ã€FPS æ§åˆ¶é€»è¾‘ã€‚
5.  å®ç°å¸§ç¼“å­˜æœºåˆ¶ï¼ˆå¤„ç†ç©ºå¸§ç»§æ‰¿ï¼ŒåŸç‰ˆç‰¹æ€§ï¼‰ã€‚
6.  å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%ã€‚

---
**Story 6.3: æ¸²æŸ“ç³»ç»Ÿæ”¹é€ å’Œå®ä½“è¿ç§»**
> **As a** å¼€å‘è€…,
> **I want** to update the render system and all entities to use Reanim,
> **so that** the game displays animations with original PVZ quality.

**Acceptance Criteria:**
1.  **ä¿®æ”¹** `pkg/systems/render_system.go`ï¼Œåˆ é™¤æ—§æ¸²æŸ“é€»è¾‘ï¼Œå®ç° Reanim éƒ¨ä»¶æ¸²æŸ“ã€‚
2.  æ”¯æŒéƒ¨ä»¶å˜æ¢ï¼šä½ç½®ï¼ˆX, Yï¼‰ã€ç¼©æ”¾ï¼ˆScaleX, ScaleYï¼‰ã€å€¾æ–œï¼ˆSkewX, SkewYï¼‰ã€‚
3.  **æ›´æ–°** æ‰€æœ‰å®ä½“å·¥å‚å‡½æ•°ï¼ˆè±Œè±†å°„æ‰‹ã€å‘æ—¥è‘µã€åšæœå¢™ã€åƒµå°¸ç­‰ï¼‰ä½¿ç”¨ `ReanimComponent`ã€‚
4.  æ¸¸æˆå¯æ­£å¸¸å¯åŠ¨ï¼Œæ˜¾ç¤ºä¸»èœå•å’Œæ¸¸æˆåœºæ™¯ã€‚
5.  å…³å¡ 1-1 å¯æ­£å¸¸è¿è¡Œï¼Œæ‰€æœ‰åŠ¨ç”»æµç•…æ’­æ”¾ï¼ˆ60 FPSï¼‰ã€‚
6.  åŠ¨ç”»æ•ˆæœä¸å‚è€ƒå®ç° `test_animation_viewer` ä¸€è‡´ã€‚

## **6. Checklist Results Report (æ¸…å•æ£€æŸ¥ç»“æœæŠ¥å‘Š)**

*   **å®¡æŸ¥å¼€å§‹...**
*   **å¯¹ç…§æ¸…å•:** `.bmad-core/checklists/pm-checklist.md`
*   **1. é—®é¢˜å®šä¹‰ä¸ä¸Šä¸‹æ–‡:** âœ… (æ¸…æ™°ï¼Œç»§æ‰¿è‡ªé¡¹ç›®ç®€æŠ¥)
*   **2. MVPèŒƒå›´å®šä¹‰:** âœ… (æ ¸å¿ƒåŠŸèƒ½å’ŒèŒƒå›´å¤–å†…å®¹éƒ½éå¸¸æ˜ç¡®)
*   **3. ç”¨æˆ·ä½“éªŒéœ€æ±‚:** âœ… (æ˜ç¡®å®šä¹‰ä¸ºâ€œä¸€æ¯”ä¸€å¤åˆ»â€)
*   **4. åŠŸèƒ½æ€§éœ€æ±‚:** âœ… (FR/NFRåˆ—è¡¨å®Œæ•´ä¸”å…·ä½“)
*   **5. å²è¯—ä¸æ•…äº‹ç»“æ„:** âœ… (å²è¯—é€»è¾‘é€’è¿›ï¼Œæ•…äº‹åˆ†è§£åˆç†)
*   **6. æŠ€æœ¯æŒ‡å¯¼:** âœ… (æŠ€æœ¯å‡è®¾æ¸…æ™°ï¼Œä¸ºæ¶æ„å¸ˆæä¾›äº†æ˜ç¡®æ–¹å‘)
*   **å®¡æŸ¥ç»“è®º:** **READY FOR ARCHITECT**. PRDå†…å®¹å…¨é¢ï¼Œç»“æ„åˆç†ï¼Œå·²è¾¾åˆ°å¯ä»¥äº¤ä»˜ç»™æ¶æ„å¸ˆè¿›è¡ŒæŠ€æœ¯è®¾è®¡çš„æ ‡å‡†ã€‚

## **Epic 7: ç²’å­ç‰¹æ•ˆç³»ç»Ÿ (Particle Effect System) - Brownfield Enhancement**

**å²è¯—ç›®æ ‡:** å®ç°å®Œæ•´çš„ç²’å­ç‰¹æ•ˆç³»ç»Ÿï¼Œæ”¯æŒåŸç‰ˆPVZçš„æ‰€æœ‰è§†è§‰ç‰¹æ•ˆï¼ˆåƒµå°¸è‚¢ä½“æ‰è½ã€çˆ†ç‚¸ã€æº…å°„ç­‰ï¼‰ï¼Œé€šè¿‡è§£æXMLé…ç½®å’Œé«˜æ€§èƒ½æ‰¹é‡æ¸²æŸ“æŠ€æœ¯ï¼Œä¸ºæ¸¸æˆæä¾›ä¸°å¯Œçš„è§†è§‰åé¦ˆã€‚

### **Story 7.1: ç²’å­é…ç½®è§£æç³»ç»Ÿ**
> **As a** å¼€å‘è€…,
> **I want** to parse particle XML configuration files and load particle textures,
> **so that** I can use original PVZ particle effect data.

**Acceptance Criteria:**
1. å®ç°ç²’å­é…ç½®æ•°æ®ç»“æ„ï¼š`ParticleConfig`, `EmitterConfig`, `Field`ç­‰
2. å®ç°XMLè§£æå™¨ `internal/particle/parser.go`
3. è§£æå™¨èƒ½æˆåŠŸè§£æè‡³å°‘5ä¸ªä»£è¡¨æ€§ç²’å­é…ç½®ï¼ˆAward.xml, BossExplosion.xml, CabbageSplat.xmlç­‰ï¼‰
4. æ”¯æŒ40+ç§ç²’å­å±æ€§çš„è§£æï¼ˆSpawn*, Particle*, Launch*, Fieldç­‰ï¼‰
5. æ‰©å±•`ResourceManager`ï¼Œæ·»åŠ `LoadParticleConfig(name string)`æ–¹æ³•
6. ç²’å­è´´å›¾åŠ è½½é›†æˆåˆ°`ResourceManager`
7. å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
8. è§£æç»“æœä¸XMLé…ç½®ä¸€è‡´æ€§éªŒè¯

---

### **Story 7.2: ç²’å­å‘å°„å™¨æ ¸å¿ƒå¼•æ“**
> **As a** å¼€å‘è€…,
> **I want** to implement particle emitter logic and lifecycle management,
> **so that** particles can be spawned, updated, and destroyed correctly.

**Acceptance Criteria:**
1. **åˆ›å»º**: `pkg/components/particle_component.go`ï¼ˆç²’å­ç»„ä»¶ï¼‰
   - å­˜å‚¨å•ä¸ªç²’å­çš„çŠ¶æ€ï¼ˆä½ç½®ã€é€Ÿåº¦ã€æ—‹è½¬ã€ç¼©æ”¾ã€é€æ˜åº¦ã€é¢œè‰²ã€ç”Ÿå‘½å‘¨æœŸç­‰ï¼‰
   - çº¯æ•°æ®ç»„ä»¶ï¼Œæ— æ–¹æ³•
2. **åˆ›å»º**: `pkg/components/emitter_component.go`ï¼ˆå‘å°„å™¨ç»„ä»¶ï¼‰
   - å­˜å‚¨å‘å°„å™¨é…ç½®å¼•ç”¨å’ŒçŠ¶æ€
   - ç®¡ç†å‘å°„æ—¶æœºã€æ´»è·ƒç²’å­æ•°ç­‰
3. **åˆ›å»º**: `pkg/systems/particle_system.go`ï¼ˆç²’å­ç³»ç»Ÿï¼‰
   - å®ç°`Update(dt float64)`æ–¹æ³•ï¼šæ›´æ–°æ‰€æœ‰ç²’å­å’Œå‘å°„å™¨
   - ç²’å­ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šç”Ÿæˆã€æ›´æ–°ã€é”€æ¯
   - åŠ¨ç”»æ’å€¼ç³»ç»Ÿï¼šæ”¯æŒçº¿æ€§æ’å€¼å’Œå…³é”®å¸§åŠ¨ç”»ï¼ˆAlpha, Scale, Spinç­‰ï¼‰
   - åŠ›åœºç³»ç»Ÿï¼šæ”¯æŒé‡åŠ›ã€æ‘©æ“¦ã€åŠ é€Ÿåº¦ç­‰
4. å®ç°å‘å°„å™¨é€»è¾‘ï¼š
   - æŒ‰é…ç½®ç”Ÿæˆç²’å­ï¼ˆSpawnMinActive, SpawnRateç­‰ï¼‰
   - å‘å°„é€Ÿåº¦å’Œè§’åº¦ï¼ˆLaunchSpeed, LaunchAngleï¼‰
   - å‘å°„åŒºåŸŸï¼ˆEmitterBox, EmitterRadius, EmitterTypeï¼‰
5. å•å…ƒæµ‹è¯•ï¼šéªŒè¯ç²’å­ç”Ÿå‘½å‘¨æœŸã€åŠ¨ç”»æ’å€¼ã€åŠ›åœºè®¡ç®—æ­£ç¡®æ€§
6. å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%

---

### **Story 7.3: ç²’å­æ¸²æŸ“ç³»ç»Ÿä¸ECSé›†æˆ**
> **As a** å¼€å‘è€…,
> **I want** to render particles efficiently using Ebitengine DrawTriangles,
> **so that** the game can display thousands of particles at 60 FPS.

**Acceptance Criteria:**
1. **ä¿®æ”¹**: `pkg/systems/render_system.go`
   - æ·»åŠ `DrawParticles(screen *ebiten.Image, cameraX float64)`æ–¹æ³•
   - ä½¿ç”¨`ebiten.DrawTriangles`æ‰¹é‡æ¸²æŸ“ç²’å­ï¼ˆæ¯ä¸ªç²’å­2ä¸ªä¸‰è§’å½¢ï¼‰
   - æ”¯æŒåŠ æ³•æ··åˆæ¨¡å¼ï¼ˆAdditive Blendingï¼‰ï¼š
     ```go
     op.Blend = ebiten.Blend{
         BlendFactorSourceRGB:      ebiten.BlendFactorOne,
         BlendFactorDestinationRGB: ebiten.BlendFactorOne,
         BlendOperationRGB:         ebiten.BlendOperationAdd,
         // ...
     }
     ```
   - æ”¯æŒç²’å­å±æ€§ï¼šä½ç½®ã€æ—‹è½¬ã€ç¼©æ”¾ã€é€æ˜åº¦ã€é¢œè‰²ã€äº®åº¦
   - æŒ‰ç²’å­é…ç½®çš„æ··åˆæ¨¡å¼æ¸²æŸ“ï¼ˆAdditive vs Normalï¼‰
2. **ä¼˜åŒ–**: å¤ç”¨é¡¶ç‚¹æ•°ç»„ï¼Œé¿å…æ¯å¸§é‡æ–°åˆ†é…å†…å­˜
3. **ä¼˜åŒ–**: å…³é—­ç²’å­è´´å›¾çš„mipmapsï¼ˆå¦‚æœéœ€è¦ï¼‰
4. **é›†æˆ**: ç²’å­æ¸²æŸ“æ’å…¥åˆ°æ­£ç¡®çš„æ¸²æŸ“å±‚çº§ï¼ˆåœ¨æ¸¸æˆä¸–ç•Œå’ŒUIä¹‹é—´ï¼‰
5. **åˆ›å»º**: ç²’å­å®ä½“å·¥å‚å‡½æ•° `pkg/entities/particle_factory.go`
   - `CreateParticleEffect(name string, x, y float64)`
6. æ€§èƒ½æµ‹è¯•ï¼š1000ä¸ªç²’å­åŒå±æ¸²æŸ“ï¼Œä¿æŒ60 FPS
7. è§†è§‰éªŒè¯ï¼šç²’å­æ¸²æŸ“æ•ˆæœä¸åŸç‰ˆPVZä¸€è‡´ï¼ˆåŠ æ³•æ··åˆã€é¢œè‰²æ··åˆç­‰ï¼‰

---

### **Story 7.4: æ¸¸æˆæ•ˆæœé›†æˆä¸äº‹ä»¶è§¦å‘**
> **As a** ç©å®¶,
> **I want** to see particle effects when zombies die, explosions occur, and projectiles hit,
> **so that** I get rich visual feedback during gameplay.

**Acceptance Criteria:**
1. **ä¿®æ”¹**: `pkg/systems/behavior_system.go`
   - åƒµå°¸æ­»äº¡æ—¶è§¦å‘ç²’å­æ•ˆæœï¼ˆæ‰‹è‡‚æ‰è½ã€å¤´æ‰è½ç­‰ï¼‰
   - æ¨±æ¡ƒç‚¸å¼¹çˆ†ç‚¸æ—¶è§¦å‘çˆ†ç‚¸ç²’å­æ•ˆæœ
2. **ä¿®æ”¹**: `pkg/systems/collision_system.go`ï¼ˆå¦‚å­˜åœ¨ï¼‰æˆ–ç›¸å…³ç³»ç»Ÿ
   - è±Œè±†å‡»ä¸­åƒµå°¸æ—¶è§¦å‘æº…å°„ç²’å­æ•ˆæœ
   - å·å¿ƒèœå‡»ä¸­æ—¶è§¦å‘å·å¿ƒèœæº…å°„æ•ˆæœ
3. **å®ç°**: è‡³å°‘5ç§æ¸¸æˆç²’å­æ•ˆæœï¼š
   - åƒµå°¸æ­»äº¡æ•ˆæœï¼ˆZombieDeath.xmlæˆ–ç±»ä¼¼ï¼‰
   - çˆ†ç‚¸æ•ˆæœï¼ˆBossExplosion.xmlæˆ–ç±»ä¼¼ï¼‰
   - è±Œè±†æº…å°„ï¼ˆPeaSplat.xmlæˆ–ç±»ä¼¼ï¼‰
   - å·å¿ƒèœæº…å°„ï¼ˆCabbageSplat.xmlï¼‰
   - å¥–åŠ±å…‰æ•ˆï¼ˆAward.xmlæˆ–ç±»ä¼¼ï¼‰
4. **åˆ›å»º**: ç²’å­æ•ˆæœè§¦å‘è¾…åŠ©å‡½æ•°ï¼š
   - `SpawnParticleEffect(effectName string, worldX, worldY float64)`
5. é›†æˆæµ‹è¯•ï¼šæ¸¸æˆè¿è¡Œæ—¶ï¼Œä¸Šè¿°åœºæ™¯èƒ½æ­£ç¡®è§¦å‘ç²’å­æ•ˆæœ
6. é›†æˆæµ‹è¯•ï¼šç²’å­æ•ˆæœæ’­æ”¾å®Œæˆåè‡ªåŠ¨æ¸…ç†ï¼Œæ— å†…å­˜æ³„æ¼
7. æ€§èƒ½æµ‹è¯•ï¼šæˆ˜æ–—åœºæ™¯ï¼ˆå¤šåƒµå°¸æ­»äº¡ã€å¤šçˆ†ç‚¸ï¼‰ä¿æŒ60 FPS
8. è§†è§‰éªŒè¯ï¼šæ•ˆæœä¸åŸç‰ˆPVZä¸€è‡´

---

## **Epic 8: ç¬¬ä¸€ç« å…³å¡å®ç° - å‰é™¢ç™½å¤© (Chapter 1: Day Level Implementation)**

**å²è¯—ç›®æ ‡:** å®ç°ã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹ç¬¬ä¸€ç« (å‰é™¢ç™½å¤©)çš„å…¨éƒ¨ 10 ä¸ªå…³å¡,åŒ…æ‹¬åŸç‰ˆå¿ å®çš„å…³å¡æœºåˆ¶ã€æ•™å­¦å¼•å¯¼ç³»ç»Ÿã€å¼€åœºåŠ¨ç”»ç³»ç»Ÿã€é€‰å¡ç•Œé¢å’Œç‰¹æ®Šå…³å¡ç±»å‹,ä¸ºç©å®¶æä¾›å®Œæ•´çš„å†’é™©æ¨¡å¼ç¬¬ä¸€ç« ä½“éªŒã€‚

### Epic Overview (å²è¯—æ¦‚è§ˆ)

Epic 8 å°†å®ç°ç¬¬ä¸€ç« çš„å®Œæ•´å…³å¡ä½“éªŒ,ä»æ•™å­¦å…³å¡ 1-1 åˆ°ç»ˆææŒ‘æˆ˜å…³å¡ 1-10,åŒ…æ‹¬ä¸¤ç§ç‰¹æ®Šå…³å¡ç±»å‹(åšæœä¿é¾„çƒå’Œä¼ é€å¸¦æ¨¡å¼)ã€‚

**å…³å¡æ¸…å•:**

| å…³å¡ | åœºåœ° | æ——å¸œ | æ–°æ¤ç‰© | æ–°åƒµå°¸ | ç‰¹æ®Šæœºåˆ¶ |
|------|------|------|--------|--------|----------|
| **1-1** | 1è¡Œ(ç¬¬3è¡Œ) | æ—  | è±Œè±†å°„æ‰‹ | æ™®é€šåƒµå°¸ | æ•™å­¦å¼•å¯¼ â­ |
| **1-2** | 3è¡Œ(ä¸­é—´) | 1é¢ | å‘æ—¥è‘µ | - | æ ‡å‡†å¼€åœº |
| **1-3** | 3è¡Œ(ä¸­é—´) | 1é¢ | æ¨±æ¡ƒç‚¸å¼¹ | è·¯éšœåƒµå°¸ | æ ‡å‡†å¼€åœº |
| **1-4** | 5è¡Œ(å®Œæ•´) | 1é¢ | åšæœå¢™ | - | è§£é”é“²å­ |
| **1-5** | 5è¡Œ(å®Œæ•´) | æ—  | åœŸè±†é›· | - | **åšæœä¿é¾„çƒ** â­ |
| **1-6** | 5è¡Œ(å®Œæ•´) | 2é¢ | å¯’å†°å°„æ‰‹ | æ’‘æ†åƒµå°¸ | æ ‡å‡†å¼€åœº |
| **1-7** | 5è¡Œ(å®Œæ•´) | 2é¢ | å¤§å˜´èŠ± | - | æ ‡å‡†å¼€åœº |
| **1-8** | 5è¡Œ(å®Œæ•´) | 2é¢ | åŒå‘å°„æ‰‹ | é“æ¡¶åƒµå°¸ | éš¾åº¦æ‹ç‚¹ |
| **1-9** | 5è¡Œ(å®Œæ•´) | 2é¢ | - | - | ç»¼åˆæŒ‘æˆ˜ + åƒµå°¸æ¥ä¿¡ |
| **1-10** | 5è¡Œ(å®Œæ•´) | æ—  | å°å–·è‡ | - | **ä¼ é€å¸¦æ¨¡å¼** â­ |

**å…³é”®ç³»ç»Ÿ:**
1. **æ•™å­¦å¼•å¯¼ç³»ç»Ÿ** - 1-1 å…³å¡çš„å¼ºåˆ¶å¼•å¯¼æœºåˆ¶
2. **å…³å¡å¥–åŠ±åŠ¨ç”»ç³»ç»Ÿ** - å¡ç‰‡åŒ…æ‰è½åŠ¨ç”»ã€æ–°æ¤ç‰©ä»‹ç»é¢æ¿ï¼ˆStory 8.3 Phase 1ï¼‰
3. **å¼€åœºåŠ¨ç”»ç³»ç»Ÿ** - é•œå¤´å¹³ç§»ã€åƒµå°¸é¢„å‘Š(å¯é…ç½®è·³è¿‡)ï¼ˆStory 8.3 Phase 2ï¼‰
4. **é€‰å¡ç•Œé¢** - æ¤ç‰©é€‰æ‹©ã€è§£é”ç³»ç»Ÿ
5. **ç‰¹æ®Šå…³å¡ç³»ç»Ÿ** - åšæœä¿é¾„çƒã€ä¼ é€å¸¦æ¨¡å¼
6. **å…³å¡è¿›åº¦ç³»ç»Ÿ** - è§£é”ç®¡ç†ã€è¿›åº¦ä¿å­˜

### Stories (æ•…äº‹åˆ—è¡¨)

Epic 8 åŒ…å« 10 ä¸ª Storyï¼ˆå« 2 ä¸ªæŠ€æœ¯å€ºåŠ¡ Storyï¼‰:

1. **Story 8.1**: å…³å¡é…ç½®ç³»ç»Ÿå¢å¼ºä¸é€‰å¡ç•Œé¢ âœ…
2. **Story 8.2**: å…³å¡ 1-1 æ•™å­¦å¼•å¯¼ç³»ç»Ÿ âœ…
   - **Story 8.2.1**: æ•™å­¦å…³å¡è§†è§‰æç¤ºå¢å¼ºï¼ˆHotfix - è¡¥å…… 8.2 ç¼ºå¤±çš„è§†è§‰åé¦ˆï¼‰ğŸ“
3. **Story 8.3**: å…³å¡å®Œæˆæµç¨‹ä¸å¼€åœºåŠ¨ç”»ç³»ç»Ÿ âœ…
   - Phase 1: å…³å¡å¥–åŠ±åŠ¨ç”»ç³»ç»Ÿï¼ˆå¡ç‰‡åŒ…æ‰è½ã€æ–°æ¤ç‰©ä»‹ç»é¢æ¿ï¼‰
   - Phase 2: å¼€åœºåŠ¨ç”»ç³»ç»Ÿä¸é•œå¤´æ§åˆ¶ï¼ˆé•œå¤´å¹³ç§»ã€åƒµå°¸é¢„å‘Šï¼‰
4. **Story 8.4**: æ¤ç‰©å¡ç‰‡æ¸²æŸ“æ¨¡å—åŒ–é‡æ„ï¼ˆTechnical Debtï¼‰âœ…
5. **Story 8.5**: ç²’å­ç³»ç»Ÿæ¸²æŸ“å±‚çº§åˆ†ç¦»ä¸ECSæ¶æ„ä¼˜åŒ–ï¼ˆTechnical Debtï¼‰âœ…
6. **Story 8.6**: å…³å¡ 1-2 è‡³ 1-4 å®ç°(æ ‡å‡†æ•™å­¦å…³å¡) ğŸ“
7. **Story 8.7**: ç‰¹æ®Šå…³å¡ç±»å‹ç³»ç»Ÿ - åšæœä¿é¾„çƒ(1-5) ğŸ“
8. **Story 8.8**: åƒµå°¸è·èƒœæµç¨‹ä¸æ¸¸æˆç»“æŸå¯¹è¯æ¡† âœ… (éœ€ä»£ç ä¿®å¤ Phase 2 - æ”¹ä¸ºåŒæ—¶æ‰§è¡Œ)
9. **Story 8.9**: ç‰¹æ®Šå…³å¡ç±»å‹ç³»ç»Ÿ - ä¼ é€å¸¦æ¨¡å¼(1-10) ğŸ“
10. **Story 8.10**: ç¬¬ä¸€ç« é›†æˆæµ‹è¯•ä¸è°ƒä¼˜ ğŸ“

**è¯¦ç»†è®¾è®¡æ–‡æ¡£**: å®Œæ•´çš„ Epic 8 è§„èŒƒè¯·å‚è§ [Epic 8 è¯¦ç»†æ–‡æ¡£](prd/epic-8-level-chapter1-implementation.md)ã€‚

### Success Criteria (æˆåŠŸæ ‡å‡†)

1. âœ… æ‰€æœ‰ 10 ä¸ªå…³å¡å¯ç©å¹¶ç¬¦åˆåŸç‰ˆä½“éªŒ(å‚è€ƒ `.meta/levels/chapter1.md`)
2. âœ… æ•™å­¦ç³»ç»Ÿåœ¨ 1-1 æ­£å¸¸å·¥ä½œ(1è¡Œè‰åœ°ã€å¼ºåˆ¶å¼•å¯¼ã€2-3åªåƒµå°¸)
3. âœ… å¼€åœºåŠ¨ç”»ç³»ç»Ÿå¯å·¥ä½œä¸”å¯è·³è¿‡(skipOpening é…ç½®)
4. âœ… é€‰å¡ç•Œé¢åŠŸèƒ½å®Œæ•´
5. âœ… ç‰¹æ®Šå…³å¡æ­£ç¡®å®ç°(1-5 åšæœä¿é¾„çƒã€1-10 ä¼ é€å¸¦æ¨¡å¼)
6. âœ… æ——å¸œç³»ç»Ÿæ­£ç¡®å·¥ä½œ(1-2~1-4: 1é¢, 1-6~1-9: 2é¢)
7. âœ… å…³å¡è¿›åº¦ç³»ç»Ÿèƒ½ä¿å­˜å’ŒåŠ è½½
8. âœ… æ–°åƒµå°¸æœºåˆ¶æ­£ç¡®(æ’‘æ†åƒµå°¸è·³è·ƒã€é“æ¡¶åƒµå°¸é«˜è¡€é‡)
9. âœ… ä»£ç é€šè¿‡æµ‹è¯•(å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•, è¦†ç›–ç‡ 80%+)
10. âœ… æ€§èƒ½ç¬¦åˆè¦æ±‚(60 FPS)

### Technical Implementation (æŠ€æœ¯å®ç°)

**æ–°å¢ç³»ç»Ÿ:**
- `TutorialSystem` - æ•™å­¦æµç¨‹ç®¡ç†
- `PlantSelectionSystem` - é€‰å¡ç•Œé¢ç®¡ç†
- `CameraSystem` - é•œå¤´æ§åˆ¶
- `OpeningAnimationSystem` - å¼€åœºç¼–æ’
- `SpecialLevelRuleSystem` - ç‰¹æ®Šå…³å¡è§„åˆ™
- `ConveyorSystem` - ä¼ é€å¸¦æœºåˆ¶

**æ–°å¢ç»„ä»¶:**
- `TutorialComponent` - æ•™å­¦çŠ¶æ€
- `PlantSelectionComponent` - é€‰å¡çŠ¶æ€
- `CameraComponent` - é•œå¤´åŠ¨ç”»
- `ConveyorComponent` - ä¼ é€å¸¦çŠ¶æ€

**é…ç½®æ‰©å±•ç¤ºä¾‹:**
```yaml
# data/levels/level-1-1.yaml
id: "1-1"
openingType: "tutorial"           # å¼€åœºç±»å‹
enabledLanes: [3]                 # å¯ç”¨çš„è¡Œ
availablePlants: []               # å¯ç”¨æ¤ç‰©
skipOpening: false                # è·³è¿‡å¼€åœº(è°ƒè¯•)

tutorialSteps:
  - trigger: "gameStart"
    text: "å¤©ç©ºä¸­ä¼šæ‰è½é˜³å…‰ï¼Œç‚¹å‡»æ”¶é›†å®ƒä»¬ï¼"
    action: "waitForSunCollect"
```

**å‚è€ƒæ–‡æ¡£:**
- å…³å¡è¯¦ç»†è¯´æ˜: `.meta/levels/chapter1.md`
- Epic 8 å®Œæ•´è§„èŒƒ: `docs/prd/epic-8-level-chapter1-implementation.md`

---

## **Epic 9: ECS æ¡†æ¶æ³›å‹åŒ–é‡æ„ (ECS Generics Refactor) - Brownfield Enhancement**

**å²è¯—ç›®æ ‡:** å°†å½“å‰åŸºäºåå°„çš„ ECS æ¡†æ¶è¿ç§»åˆ° Go æ³›å‹å®ç°ï¼Œé€šè¿‡ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œæ¶ˆé™¤è¿è¡Œæ—¶åå°„å¼€é”€ï¼Œæå‡ä»£ç å¯è¯»æ€§å’Œç±»å‹å®‰å…¨æ€§ï¼Œä¸ºåç»­å¼€å‘æä¾›æ›´é«˜æ•ˆçš„å¼€å‘ä½“éªŒã€‚

### Epic Overview (å²è¯—æ¦‚è§ˆ)

Epic 9 æ˜¯ä¸€æ¬¡æŠ€æœ¯å€ºé‡æ„ï¼Œæ—¨åœ¨å°†é¡¹ç›®çš„æ ¸å¿ƒ ECSï¼ˆEntity-Component-Systemï¼‰æ¶æ„ä»åå°„å®ç°å‡çº§ä¸º Go æ³›å‹å®ç°ã€‚å½“å‰ç³»ç»Ÿä½¿ç”¨ `reflect.TypeOf()` è¿›è¡Œç»„ä»¶æŸ¥è¯¢ï¼Œå­˜åœ¨æ€§èƒ½å¼€é”€ã€ç±»å‹å®‰å…¨é—®é¢˜å’Œä»£ç å†—é•¿é—®é¢˜ã€‚

**å½“å‰é—®é¢˜:**
- **æ€§èƒ½å¼€é”€**: æ¯æ¬¡ç»„ä»¶æŸ¥è¯¢éƒ½éœ€è¦è¿è¡Œæ—¶åå°„ï¼ˆé¢„è®¡ 30-50% æ€§èƒ½æŸå¤±ï¼‰
- **ç±»å‹å®‰å…¨**: è¿è¡Œæ—¶ç±»å‹æ–­è¨€ï¼Œç¼–è¯‘æ—¶æ— æ³•æ£€æµ‹é”™è¯¯
- **ä»£ç å¯è¯»æ€§**: å¤§é‡ `reflect.TypeOf()` è°ƒç”¨ï¼Œä»£ç å†—é•¿

**ç›®æ ‡æ”¹è¿›:**
```go
// âŒ å½“å‰åå°„å®ç°
entities := em.GetEntitiesWith(
    reflect.TypeOf(&components.PlantComponent{}),
    reflect.TypeOf(&components.PositionComponent{}),
)
comp, ok := em.GetComponent(entity, reflect.TypeOf(&components.PlantComponent{}))
plantComp := comp.(*components.PlantComponent) // è¿è¡Œæ—¶ç±»å‹æ–­è¨€

// âœ… ç›®æ ‡æ³›å‹å®ç°
entities := ecs.GetEntitiesWith[
    *components.PlantComponent,
    *components.PositionComponent,
](em)
plantComp, ok := ecs.GetComponent[*components.PlantComponent](em, entity)
// ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨ï¼Œæ— éœ€ç±»å‹æ–­è¨€
```

### Stories (æ•…äº‹åˆ—è¡¨)

Epic 9 åŒ…å« 3 ä¸ª Story:

#### **Story 9.1: æ³›å‹ API è®¾è®¡ã€åŸå‹éªŒè¯ä¸ EntityManager æ ¸å¿ƒé‡æ„**
> **As a** å¼€å‘è€…,
> **I want** to design and implement generic ECS APIs for EntityManager,
> **so that** I can replace reflection-based component queries with compile-time type-safe generics.

**Acceptance Criteria:**
1. è®¾è®¡æ³›å‹ API æ¥å£è§„èŒƒï¼ˆ`GetEntitiesWith[T1, T2, ...]`, `GetComponent[T]`, `AddComponent[T]`ï¼‰
2. åˆ›å»ºåŸå‹å¹¶è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆå¯¹æ¯”åå°„ vs æ³›å‹ï¼‰
3. ç¡®è®¤æ€§èƒ½æå‡è¾¾åˆ°é¢„æœŸï¼ˆç›®æ ‡ 30%+ æå‡ï¼‰
4. ç¼–å†™è¿ç§»æŒ‡å—æ–‡æ¡£
5. å®ç°æ³›å‹ç‰ˆæœ¬çš„æ ¸å¿ƒ EntityManager æ–¹æ³•
6. æ›´æ–° `pkg/ecs/entity_manager_test.go`ï¼Œæ·»åŠ æ³›å‹ API æµ‹è¯•
7. å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%

**é¢„ä¼°å·¥ä½œé‡**: 6-9 å°æ—¶

---

#### **Story 9.2: ç³»ç»Ÿæ‰¹é‡è¿ç§»ï¼ˆ17+ ç³»ç»Ÿæ–‡ä»¶ï¼‰**
> **As a** å¼€å‘è€…,
> **I want** to migrate all game systems from reflection-based ECS to generic ECS,
> **so that** the entire codebase benefits from type safety and performance improvements.

**Acceptance Criteria:**
1. **ç¬¬ä¸€é˜¶æ®µ**: è¿ç§»æœ€å¤æ‚ç³»ç»Ÿï¼ˆ`BehaviorSystem`, `InputSystem`ï¼‰éªŒè¯å¯è¡Œæ€§
2. **ç¬¬äºŒé˜¶æ®µ**: æ‰¹é‡è¿ç§»ä¸­ç­‰å¤æ‚åº¦ç³»ç»Ÿï¼ˆ8ä¸ªç³»ç»Ÿæ–‡ä»¶ï¼‰
   - `render_system.go`, `physics_system.go`, `reanim_system.go`, `particle_system.go`
   - `plant_selection_system.go` â­ï¼ˆè§£é™¤ Story 8.1 é˜»å¡ï¼‰
   - `plant_card_system.go`, `plant_preview_system.go`
3. **ç¬¬ä¸‰é˜¶æ®µ**: è¿ç§»å‰©ä½™ç³»ç»Ÿï¼ˆ9ä¸ªæ–‡ä»¶ï¼‰+ æ‰€æœ‰æµ‹è¯•æ–‡ä»¶
4. æ‰€æœ‰ç³»ç»Ÿç¼–è¯‘é€šè¿‡ï¼Œæ¶ˆé™¤ `reflect.TypeOf` è°ƒç”¨
5. æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
6. è¿ç§»æ—¥å¿—è®°å½•å®Œæ•´

**é¢„ä¼°å·¥ä½œé‡**: 8-12 å°æ—¶

---

#### **Story 9.3: å…¨é¢æµ‹è¯•ã€æ€§èƒ½åŸºå‡†ä¸æ–‡æ¡£æ›´æ–°**
> **As a** å¼€å‘è€…å’Œé¡¹ç›®ç»´æŠ¤è€…,
> **I want** to verify the refactor through comprehensive testing and update documentation,
> **so that** the project is stable, performant, and maintainable.

**Acceptance Criteria:**
1. **å•å…ƒæµ‹è¯•éªŒè¯**: è¿è¡Œ `go test ./...`ï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œè¦†ç›–ç‡ â‰¥ 80%
2. **é›†æˆæµ‹è¯•éªŒè¯**: æ¸¸æˆæ ¸å¿ƒåŠŸèƒ½ï¼ˆæ¤ç‰©ç§æ¤ã€åƒµå°¸æˆ˜æ–—ã€ç²’å­æ•ˆæœã€å…³å¡åŠ è½½ï¼‰æ­£å¸¸
3. **æ€§èƒ½åŸºå‡†æµ‹è¯•**:
   - åˆ›å»º `pkg/ecs/entity_manager_benchmark_test.go`
   - æµ‹è¯•åœºæ™¯ï¼šæŸ¥è¯¢ 1000 å®ä½“ã€æ·»åŠ /åˆ é™¤ç»„ä»¶ã€å¤§è§„æ¨¡å®ä½“åˆ›å»º
   - å¯¹æ¯”åå°„ç‰ˆæœ¬ vs æ³›å‹ç‰ˆæœ¬ï¼Œè®°å½•æ€§èƒ½æå‡ï¼ˆé¢„æœŸ 30-50%ï¼‰
4. **æ–‡æ¡£æ›´æ–°**:
   - æ›´æ–° `CLAUDE.md`ï¼Œæ·»åŠ "æ³›å‹ ECS ä½¿ç”¨æŒ‡å—"ç« èŠ‚
   - æ›´æ–°ä»£ç æ³¨é‡Šï¼Œç¬¦åˆ GoDoc è§„èŒƒ
   - ï¼ˆå¯é€‰ï¼‰åˆ›å»ºè¿ç§»æŒ‡å— `docs/architecture/ecs-generics-migration-guide.md`

**é¢„ä¼°å·¥ä½œé‡**: 2-4 å°æ—¶

---

### Success Criteria (æˆåŠŸæ ‡å‡†)

1. âœ… æ‰€æœ‰ 17+ ç³»ç»Ÿæ–‡ä»¶æˆåŠŸè¿ç§»åˆ°æ³›å‹ API
2. âœ… `reflect.TypeOf` è°ƒç”¨åœ¨ç³»ç»Ÿå±‚é¢æ¶ˆé™¤ï¼ˆEntityManager å†…éƒ¨å¯ä¿ç•™ï¼‰
3. âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•æ˜¾ç¤ºæŸ¥è¯¢é€Ÿåº¦æå‡ 30-50%
4. âœ… æ‰€æœ‰å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•é€šè¿‡ï¼ˆ`go test ./...`ï¼‰
5. âœ… æ¸¸æˆåŠŸèƒ½æ— å›å½’ï¼ˆæ¤ç‰©ã€åƒµå°¸ã€ç²’å­ã€å…³å¡æ­£å¸¸ï¼‰
6. âœ… ä»£ç å¯è¯»æ€§æ˜¾è‘—æå‡ï¼Œæ ·æ¿ä»£ç å‡å°‘ 50%
7. âœ… CLAUDE.md æ›´æ–°å®Œæˆï¼ŒåŒ…å«æ³›å‹ ECS ä½¿ç”¨æŒ‡å—
8. âœ… Story 8.1 é˜»å¡è§£é™¤ï¼ˆ`PlantSelectionSystem` å¯ä½¿ç”¨æ³›å‹ç¼–è¯‘ï¼‰

### Technical Implementation (æŠ€æœ¯å®ç°)

**æ ¸å¿ƒ API è®¾è®¡:**
```go
// pkg/ecs/generics.go (æ–°æ–‡ä»¶)

// GetEntitiesWith æŸ¥è¯¢æ‹¥æœ‰æŒ‡å®šç»„ä»¶ç±»å‹çš„æ‰€æœ‰å®ä½“ï¼ˆæ³›å‹ç‰ˆæœ¬ï¼‰
func GetEntitiesWith[T1, T2, T3 any](em *EntityManager) []EntityID {
    // ä½¿ç”¨ç±»å‹å‚æ•°è¿›è¡ŒæŸ¥è¯¢ï¼Œæ— éœ€åå°„
}

// GetComponent è·å–å®ä½“çš„ç‰¹å®šç±»å‹ç»„ä»¶ï¼ˆæ³›å‹ç‰ˆæœ¬ï¼‰
func GetComponent[T any](em *EntityManager, entity EntityID) (T, bool) {
    // è¿”å›å…·ä½“ç±»å‹ï¼Œæ— éœ€ç±»å‹æ–­è¨€
}

// AddComponent æ·»åŠ ç»„ä»¶ï¼ˆæ³›å‹ç‰ˆæœ¬ï¼‰
func AddComponent[T any](em *EntityManager, entity EntityID, component T) {
    // ç±»å‹å®‰å…¨çš„æ·»åŠ 
}

// HasComponent æ£€æŸ¥ç»„ä»¶ï¼ˆæ³›å‹ç‰ˆæœ¬ï¼‰
func HasComponent[T any](em *EntityManager, entity EntityID) bool {
    // ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
}
```

**è¿ç§»ç­–ç•¥:**
1. **æ¸è¿›å¼è¿ç§»**: å…ˆéªŒè¯æœ€å¤æ‚ç³»ç»Ÿï¼Œå†æ‰¹é‡è¿ç§»
2. **å‘åå…¼å®¹**: ä¿ç•™æ—§åå°„ APIï¼ˆå¯é€‰ï¼‰ï¼Œæ–°æ—§ API å¯å…±å­˜
3. **å¯ä¸­æ–­è®¾è®¡**: ä»»æ„é˜¶æ®µå¯æš‚åœï¼Œå·²è¿ç§»ç³»ç»Ÿç«‹å³å—ç›Š

**é£é™©ç¼“è§£:**
- Git åˆ†æ”¯: `feature/ecs-generics-refactor`
- æ¯ä¸ª Story å®Œæˆååˆ›å»º Tagï¼ˆ`epic9-story1-complete`ï¼‰
- å›æ»šè®¡åˆ’: å¯å›é€€åˆ°ä¸Šä¸€ä¸ªç¨³å®š Tag

### Dependencies and Blockers (ä¾èµ–ä¸é˜»å¡)

**å½“å‰é˜»å¡:**
- âŒ **Story 8.1**: `PlantSelectionSystem` å› åå°„å†—é•¿æ€§æš‚æ—¶æç½®

**è§£é™¤é˜»å¡:**
- âœ… Story 9.2 å®Œæˆåï¼ŒStory 8.1 å¯ç»§ç»­å¼€å‘

**å»ºè®®æ—¶é—´ç‚¹:**
- **ç«‹å³å¼€å§‹**: åœ¨ Epic 8 åç»­ Story ä¹‹å‰å®Œæˆï¼Œé¿å…ç§¯ç´¯æ›´å¤šåå°„ä»£ç 
- **æˆ–**: ä½œä¸ºç‹¬ç«‹ Sprintï¼Œé›†ä¸­ 1-2 å‘¨å®Œæˆ

### Performance Expectations (æ€§èƒ½é¢„æœŸ)

| æ“ä½œ | åå°„ç‰ˆæœ¬ | æ³›å‹ç‰ˆæœ¬ | é¢„æœŸæå‡ |
|------|---------|---------|---------|
| æŸ¥è¯¢ 1000 å®ä½“ï¼ˆ3ç»„ä»¶ï¼‰ | 120 Î¼s | 60-80 Î¼s | 30-50% â¬†ï¸ |
| è·å–å•ä¸ªç»„ä»¶ | 50 ns | 20-30 ns | 40-60% â¬†ï¸ |
| æ·»åŠ ç»„ä»¶ | 60 ns | 30-40 ns | 33-50% â¬†ï¸ |

**é•¿æœŸæ”¶ç›Š:**
- âœ… ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ï¼š100% è¿è¡Œæ—¶é”™è¯¯æ¶ˆé™¤
- âœ… ä»£ç å¯è¯»æ€§ï¼šæ˜¾è‘—æå‡ï¼ˆå‡å°‘ 50% æ ·æ¿ä»£ç ï¼‰
- âœ… å¼€å‘ä½“éªŒï¼šæ›´å¥½çš„ IDE è‡ªåŠ¨è¡¥å…¨å’Œç±»å‹æ¨å¯¼

### Reference Documentation (å‚è€ƒæ–‡æ¡£)

- **æŠ€æœ¯å€ºæ–‡æ¡£**: `docs/technical-debt/ecs-generic-refactor.md`
- **Epic 9 å®Œæ•´è§„èŒƒ**: `docs/prd/epic-9-ecs-generics-refactor.md`
- **Go æ³›å‹å®˜æ–¹æ–‡æ¡£**: [https://go.dev/doc/tutorial/generics](https://go.dev/doc/tutorial/generics)
- **ECS æ³›å‹æœ€ä½³å®è·µ**: [arche - A fast, minimalist Entity Component System](https://github.com/mlange-42/arche)

---

**åˆ›å»ºæ—¥æœŸ**: 2025-10-16
**åˆ›å»ºäºº**: Sarah (Product Owner)
**Epic ç±»å‹**: Brownfield Enhancement (æ¶æ„ä¼˜åŒ–)
**ä¼˜å…ˆçº§**: Highï¼ˆé˜»å¡ Story 8.1ï¼‰
**é¢„ä¼°æ€»å·¥ä½œé‡**: 16-25 å°æ—¶ï¼ˆ3-5 ä¸ªå·¥ä½œæ—¥ï¼‰

---

## **Epic 10: æ¸¸æˆä½“éªŒå®Œå–„ (Game Experience Polish) - Brownfield Enhancement**

**å²è¯—ç›®æ ‡:** å®Œå–„æ ¸å¿ƒæ¸¸æˆä½“éªŒï¼Œå®ç°æš‚åœèœå•ã€æ¤ç‰©æ”»å‡»åŠ¨ç”»ã€ç²’å­ç‰¹æ•ˆã€é™¤è‰è½¦é˜²çº¿ç³»ç»Ÿå’ŒéŸ³æ•ˆç³»ç»Ÿï¼Œæå‡æ¸¸æˆçš„å®Œæ•´æ€§å’Œå¯ç©æ€§ï¼Œç¡®ä¿æ‰€æœ‰æ ¸å¿ƒæœºåˆ¶ç¬¦åˆåŸç‰ˆæ¸¸æˆæ ‡å‡†ã€‚

### Epic Overview (å²è¯—æ¦‚è§ˆ)

Epic 10 æ˜¯å¯¹æ ¸å¿ƒæ¸¸æˆä½“éªŒçš„æœ€åå®Œå–„ï¼Œå®ç°åæ¸¸æˆåŸºæœ¬è¾¾åˆ° MVP æ ‡å‡†ã€‚æœ¬ Epic åŒ…å« **12 ä¸ªç”¨æˆ·æ•…äº‹**ï¼ˆåŸè®¡åˆ’ 4 ä¸ª + æ‰©å±• 4 ä¸ª + éŸ³æ•ˆç³»ç»Ÿ 4 ä¸ªï¼‰ï¼Œè¦†ç›–æš‚åœèœå•ã€é™¤è‰è½¦ç³»ç»Ÿã€æ”»å‡»åŠ¨ç”»ã€ç²’å­ç‰¹æ•ˆã€é˜´å½±æ¸²æŸ“ã€äº¤äº’åé¦ˆå’ŒéŸ³æ•ˆç³»ç»Ÿç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

**æ ¸å¿ƒåŠŸèƒ½æ¨¡å—:**

#### åŸè®¡åˆ’æ¨¡å— (Story 10.1-10.4)

1. **æš‚åœèœå•ç³»ç»Ÿ** (âœ… Done) - ç”¨æˆ·ä½“éªŒæ ¸å¿ƒåŠŸèƒ½
   - æš‚åœ/æ¢å¤æ¸¸æˆ
   - èœå•é¢æ¿ï¼ˆç»§ç»­ã€é‡æ–°å¼€å§‹ã€è¿”å›ä¸»èœå•ï¼‰
   - éŸ³ä¹æ§åˆ¶
   - ESC é”®å¿«æ·é”®

2. **é™¤è‰è½¦æœ€åé˜²çº¿ç³»ç»Ÿ** (âœ… Done) - åŸç‰ˆæ ‡å¿—æ€§æœºåˆ¶
   - æ¯è¡Œå·¦ä¾§å°é˜¶æ”¾ç½®é™¤è‰è½¦
   - åƒµå°¸åˆ°è¾¾å·¦ä¾§è§¦å‘
   - é™¤è‰è½¦è‡ªåŠ¨æ¸…é™¤æ‰€åœ¨è¡Œæ‰€æœ‰åƒµå°¸
   - ä¸€æ¬¡æ€§ä½¿ç”¨ï¼Œå¤±è´¥æ¡ä»¶å¢å¼º

3. **æ¤ç‰©æ”»å‡»åŠ¨ç”»ç³»ç»Ÿ** (âœ… Done) - è§†è§‰è¡¨ç°å¢å¼º
   - æ¤ç‰©å‘å°„å­å¼¹æ—¶åˆ‡æ¢æ”»å‡»åŠ¨ç”»
   - åŠ¨ç”»çŠ¶æ€æœºç®¡ç†
   - æ”¯æŒå¤šç§å°„æ‰‹æ¤ç‰©
   - ä½¿ç”¨åŸç‰ˆ Reanim åŠ¨ç”»

4. **æ¤ç‰©ç§æ¤ç²’å­ç‰¹æ•ˆ** (âœ… Done) - è§†è§‰åé¦ˆå®Œå–„
   - ç§æ¤æ—¶åœŸç²’é£æº…æ•ˆæœ
   - ä½¿ç”¨åŸç‰ˆç²’å­é…ç½®
   - æŠ›ç‰©çº¿è¿åŠ¨
   - æ€§èƒ½ä¼˜åŒ–

#### æ‰©å±•æ¨¡å— (Story 10.5-10.8)

5. **æ¤ç‰©æ”»å‡»åŠ¨ç”»å¸§äº‹ä»¶åŒæ­¥** (âœ… Done) - åŠ¨ç”»ç²¾ç¡®æ§åˆ¶
   - å­å¼¹åœ¨æ”»å‡»åŠ¨ç”»å…³é”®å¸§å‘å°„
   - é…ç½®å…³é”®å¸§å®ç°é›¶å»¶è¿ŸåŒæ­¥
   - å­å¼¹èµ·å§‹ä½ç½®ä½¿ç”¨å®æ—¶è½¨é“åæ ‡

6. **é™¤è‰è½¦ç¢¾å‹åƒµå°¸å‹æ‰åŠ¨ç”»** (âœ… Done) - æ­»äº¡åŠ¨ç”»å¢å¼º
   - åƒµå°¸è¢«é™¤è‰è½¦ç¢¾å‹æ—¶æ’­æ”¾å‹æ‰åŠ¨ç”»
   - ä½¿ç”¨ LawnMoweredZombie.reanim å˜å½¢æ•°æ®
   - å‹æ‰åŠ¨ç”»ç»“æŸåè§¦å‘ç²’å­æ•ˆæœ

7. **æ¤ç‰©å’Œåƒµå°¸é˜´å½±æ¸²æŸ“** (âœ… Done) - è§†è§‰å®Œæ•´æ€§å¢å¼º
   - æ‰€æœ‰æ¤ç‰©å’Œåƒµå°¸è„šä¸‹æ¸²æŸ“æ¤­åœ†å½¢é˜´å½±
   - é˜´å½±å¤§å°æ ¹æ®å®ä½“ç±»å‹è‡ªé€‚åº”
   - é€æ˜åº¦ 60-70%, æ¸²æŸ“åœ¨å®ä½“ä¸‹æ–¹

8. **é˜³å…‰ä¸è¶³äº¤äº’åé¦ˆ** (âœ… Done) - ç”¨æˆ·ä½“éªŒä¼˜åŒ–
   - ç‚¹å‡»é˜³å…‰ä¸è¶³å¡ç‰‡æ—¶é˜³å…‰è®¡æ•°å™¨æ•°å­—é—ªçƒ
   - çº¢/é»‘é—ªçƒ (0.3ç§’å‘¨æœŸ, æŒç»­ 1.0ç§’)
   - æ’­æ”¾æ— æ•ˆæ“ä½œéŸ³æ•ˆ

#### éŸ³æ•ˆç³»ç»Ÿæ¨¡å— (Story 10.9-10.12) - NEW

9. **éŸ³æ•ˆç³»ç»Ÿé›†æˆ** (ğŸ“ Draft) - æ ¸å¿ƒæ¸¸æˆéŸ³æ•ˆ
   - å…³å¡èƒœåˆ©/å¤±è´¥éŸ³æ•ˆã€æ³¢æ¬¡è­¦å‘ŠéŸ³æ•ˆ
   - å‰²è‰æœºéŸ³æ•ˆã€åƒµå°¸æ ¸å¿ƒéŸ³æ•ˆ
   - éŸ³æ•ˆè·¯å¾„ç»Ÿä¸€ä¿®æ­£
   - è¯¦è§ `docs/stories/10.9.sound-effect-integration.story.md`

10. **æˆ´å¤«è¯­éŸ³ç³»ç»Ÿ** (ğŸ“ Planned) - å¯¹è¯ç³»ç»Ÿé›†æˆ
    - ç–¯ç‹‚æˆ´å¤«å¯¹è¯è¯­éŸ³
    - çŸ­è¯­ã€é•¿è¯­ã€è¶…é•¿è¯­éŸ³æ•ˆæ”¯æŒ

11. **å®Œæ•´æ¤ç‰©éŸ³æ•ˆç³»ç»Ÿ** (ğŸ“ Planned) - æ¤ç‰©æˆ˜æ–—ä½“éªŒ
    - çªç“œã€ç«çˆ†è¾£æ¤’ã€ç‰ç±³æŠ•æ‰‹ç­‰æ¤ç‰©éŸ³æ•ˆ
    - é»„æ²¹å®šèº«æ•ˆæœéŸ³æ•ˆ

12. **ç‰¹æ®Šåƒµå°¸éŸ³æ•ˆç³»ç»Ÿ** (ğŸ“ Planned) - åƒµå°¸æˆ˜æ–—ä½“éªŒ
    - æŠ¥çº¸åƒµå°¸ã€æ’‘æ†è·³åƒµå°¸ã€å°ä¸‘åƒµå°¸ã€èˆç‹åƒµå°¸ç­‰
    - å·¨äººåƒµå°¸è„šæ­¥/ç ¸åœ°éŸ³æ•ˆ

### Stories (æ•…äº‹åˆ—è¡¨)

Epic 10 åŒ…å« **12 ä¸ª Story**ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åºï¼š

#### åŸè®¡åˆ’ Story (Story 10.1-10.4)

#### **Story 10.1: æš‚åœèœå•ç³»ç»Ÿ**
> **As a** ç©å®¶,
> **I want** to pause the game and access a menu with options,
> **so that** I can take a break, restart the level, or return to the main menu without losing progress.

**Acceptance Criteria:**
1. ç‚¹å‡»å³ä¸Šè§’çš„"èœå•"æŒ‰é’®æ—¶ï¼Œæ¸¸æˆæš‚åœï¼Œæ‰€æœ‰æ¸¸æˆé€»è¾‘ç³»ç»Ÿåœæ­¢æ›´æ–°
2. æš‚åœæ—¶æ˜¾ç¤ºåŠé€æ˜é®ç½©å’Œæš‚åœèœå•é¢æ¿ï¼ŒåŒ…å«ä¸‰ä¸ªæŒ‰é’®ï¼šç»§ç»­ã€é‡æ–°å¼€å§‹ã€è¿”å›ä¸»èœå•
3. ç‚¹å‡»"ç»§ç»­"æŒ‰é’®æ—¶ï¼Œå…³é—­æš‚åœèœå•ï¼Œæ¸¸æˆæ¢å¤è¿è¡Œ
4. ç‚¹å‡»"é‡æ–°å¼€å§‹"æŒ‰é’®æ—¶ï¼Œé‡æ–°åŠ è½½å½“å‰å…³å¡
5. ç‚¹å‡»"è¿”å›ä¸»èœå•"æŒ‰é’®æ—¶ï¼Œè¿”å›ä¸»èœå•åœºæ™¯
6. æš‚åœæ—¶ï¼ŒèƒŒæ™¯éŸ³ä¹éŸ³é‡é™ä½æˆ–æš‚åœï¼Œæ¢å¤æ—¶éŸ³ä¹æ¢å¤æ­£å¸¸
7. æš‚åœæ—¶ï¼Œæ¸¸æˆä¸–ç•Œçš„æ‰€æœ‰äº¤äº’è¢«å±è”½
8. æŒ‰ ESC é”®ä¹Ÿèƒ½åˆ‡æ¢æš‚åœ/æ¢å¤çŠ¶æ€

**ä¼˜å…ˆçº§**: â­â­â­â­ ä¸­é«˜  
**é¢„ä¼°å·¥ä½œé‡**: 8-12 å°æ—¶

---

#### **Story 10.2: é™¤è‰è½¦æœ€åé˜²çº¿ç³»ç»Ÿ**
> **As a** ç©å®¶,
> **I want** lawnmowers as a last line of defense on each lane,
> **so that** I have one final chance to stop zombies from reaching my house.

**Acceptance Criteria:**
1. æ¸¸æˆå¼€å§‹æ—¶ï¼Œæ¯ä¸ªæœ‰æ•ˆè¡Œçš„å·¦ä¾§å°é˜¶ä¸Šæ”¾ç½®ä¸€è¾†é™¤è‰è½¦
2. é™¤è‰è½¦æ­£ç¡®æ˜¾ç¤ºåœ¨å¯¹åº”è¡Œçš„å·¦ä¾§ï¼Œä½¿ç”¨åŸç‰ˆé™¤è‰è½¦å›¾åƒå’ŒåŠ¨ç”»
3. å½“åƒµå°¸åˆ°è¾¾å±å¹•å·¦ä¾§è¾¹ç•Œï¼ˆX < 100ï¼‰æ—¶ï¼Œè¯¥è¡Œçš„é™¤è‰è½¦è‡ªåŠ¨è§¦å‘
4. é™¤è‰è½¦è§¦å‘åä»å·¦å‘å³å¿«é€Ÿç§»åŠ¨ï¼ˆé€Ÿåº¦çº¦ 300 åƒç´ /ç§’ï¼‰ï¼Œæ’­æ”¾è¡Œé©¶åŠ¨ç”»
5. é™¤è‰è½¦ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ¶ˆç­è·¯å¾„ä¸Šæ‰€åœ¨è¡Œçš„æ‰€æœ‰åƒµå°¸
6. é™¤è‰è½¦ç§»åŠ¨åˆ°å±å¹•å³ä¾§åæ¶ˆå¤±ï¼Œè¯¥è¡Œé™¤è‰è½¦æ ‡è®°ä¸ºå·²ä½¿ç”¨
7. é™¤è‰è½¦è§¦å‘æ—¶æ’­æ”¾å¯¹åº”çš„éŸ³æ•ˆ
8. é™¤è‰è½¦ä½¿ç”¨åï¼Œè¯¥è¡Œå†æœ‰åƒµå°¸åˆ°è¾¾å·¦ä¾§è¾¹ç•Œåˆ™æ¸¸æˆå¤±è´¥
9. æ‰€æœ‰è¡Œçš„é™¤è‰è½¦éƒ½ç”¨å®Œåï¼Œä»»æ„åƒµå°¸åˆ°è¾¾å·¦ä¾§è¾¹ç•Œç›´æ¥å¤±è´¥
10. é™¤è‰è½¦çŠ¶æ€åœ¨æ¸¸æˆé‡å¯æ—¶æ­£ç¡®é‡ç½®

**ä¼˜å…ˆçº§**: â­â­â­â­â­ é«˜  
**é¢„ä¼°å·¥ä½œé‡**: 12-16 å°æ—¶

---

#### **Story 10.3: æ¤ç‰©æ”»å‡»åŠ¨ç”»ç³»ç»Ÿ**
> **As a** ç©å®¶,
> **I want** plants to play attack animations when shooting projectiles,
> **so that** the game visually communicates plant actions and feels more alive.

**Acceptance Criteria:**
1. è±Œè±†å°„æ‰‹å‘å°„å­å¼¹æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°æ”»å‡»åŠ¨ç”»ï¼ˆanim_shootingï¼‰
2. æ”»å‡»åŠ¨ç”»æ’­æ”¾å®Œæ¯•åï¼Œè‡ªåŠ¨åˆ‡æ¢å›ç©ºé—²åŠ¨ç”»ï¼ˆanim_idleï¼‰
3. æ”»å‡»åŠ¨ç”»æ’­æ”¾æœŸé—´ï¼Œæ¤ç‰©ä¸åº”å†æ¬¡è§¦å‘æ”»å‡»åŠ¨ç”»
4. æ‰€æœ‰å°„æ‰‹ç±»æ¤ç‰©éƒ½æ”¯æŒæ”»å‡»åŠ¨ç”»
5. æ”»å‡»åŠ¨ç”»ä½¿ç”¨åŸç‰ˆ Reanim åŠ¨ç”»èµ„æº
6. åŠ¨ç”»åˆ‡æ¢è‡ªç„¶æµç•…ï¼Œæ— æ˜æ˜¾è·³å¸§æˆ–é—ªçƒ
7. æ”»å‡»åŠ¨ç”»ä¸å½±å“å­å¼¹å‘å°„é€»è¾‘
8. å‘æ—¥è‘µç­‰éå°„æ‰‹æ¤ç‰©ä¸å—æ­¤åŠŸèƒ½å½±å“

**ä¼˜å…ˆçº§**: â­â­â­â­ ä¸­é«˜  
**é¢„ä¼°å·¥ä½œé‡**: 6-8 å°æ—¶

---

#### **Story 10.4: æ¤ç‰©ç§æ¤ç²’å­ç‰¹æ•ˆ**
> **As a** ç©å®¶,
> **I want** to see soil particles splash when planting plants,
> **so that** the planting action feels more impactful and visually satisfying.

**Acceptance Criteria:**
1. ç©å®¶æˆåŠŸç§æ¤æ¤ç‰©æ—¶ï¼Œåœ¨ç§æ¤ä½ç½®ç”ŸæˆåœŸç²’é£æº…ç²’å­æ•ˆæœ
2. ç²’å­æ•ˆæœä½¿ç”¨åŸç‰ˆé…ç½®æ–‡ä»¶ï¼ˆPlantingPool.xml æˆ–ç±»ä¼¼æ–‡ä»¶ï¼‰
3. åœŸç²’ç²’å­ä»åœ°é¢å‘ä¸Šé£æº…ï¼Œç„¶åè½ä¸‹ï¼Œå½¢æˆè‡ªç„¶çš„æŠ›ç‰©çº¿è¿åŠ¨
4. ç²’å­æ•ˆæœæŒç»­ 0.5-1.0 ç§’åè‡ªåŠ¨æ¶ˆå¤±
5. ç²’å­é¢œè‰²å’Œå¤§å°ç¬¦åˆåŸç‰ˆè¡¨ç°
6. æ‰€æœ‰æ¤ç‰©ç§æ¤æ—¶éƒ½è§¦å‘ç²’å­æ•ˆæœ
7. ç²’å­æ•ˆæœåœ¨æ­£ç¡®çš„æ¸²æŸ“å±‚çº§æ˜¾ç¤º
8. ç²’å­ç³»ç»Ÿæ€§èƒ½è‰¯å¥½ï¼ŒåŒæ—¶ç§æ¤å¤šä¸ªæ¤ç‰©ä¸å½±å“å¸§ç‡

**ä¼˜å…ˆçº§**: â­â­â­ ä¸­
**é¢„ä¼°å·¥ä½œé‡**: 4-6 å°æ—¶

---

#### æ‰©å±• Story (Story 10.5-10.8)

#### **Story 10.5: æ¤ç‰©æ”»å‡»åŠ¨ç”»å¸§äº‹ä»¶åŒæ­¥** (âœ… Done)
> **As a** ç©å®¶,
> **I want** å­å¼¹åœ¨æ”»å‡»åŠ¨ç”»çš„å…³é”®å¸§å‘å°„,
> **so that** æ”»å‡»åŠ¨ç”»å’Œå­å¼¹å‘å°„å®Œç¾åŒæ­¥ï¼Œè§†è§‰è¡¨ç°è‡ªç„¶æµç•…ã€‚

**çŠ¶æ€**: âœ… å·²å®Œæˆ (Sprint Change Proposal - 2025-10-27)
**ä¼˜å…ˆçº§**: â­â­â­â­ ä¸­é«˜
**å·¥ä½œé‡**: 6-9 å°æ—¶
**æ–‡æ¡£**: `docs/stories/10.5.story.md`

---

#### **Story 10.6: é™¤è‰è½¦ç¢¾å‹åƒµå°¸å‹æ‰åŠ¨ç”»** (âœ… Done)
> **As a** ç©å®¶,
> **I want** åƒµå°¸è¢«é™¤è‰è½¦ç¢¾å‹æ—¶æ’­æ”¾å‹æ‰åŠ¨ç”»,
> **so that** æ­»äº¡æ•ˆæœæ›´åŠ ç”ŸåŠ¨æœ‰è¶£ï¼Œç¬¦åˆåŸç‰ˆæ¸¸æˆè¡¨ç°ã€‚

**çŠ¶æ€**: âœ… å·²å®Œæˆ (Sprint Change Proposal - 2025-11-20)
**ä¼˜å…ˆçº§**: â­â­â­ ä¸­
**å·¥ä½œé‡**: 9-15 å°æ—¶
**æ–‡æ¡£**: `docs/stories/10.6.story.md`

---

#### **Story 10.7: æ¤ç‰©å’Œåƒµå°¸é˜´å½±æ¸²æŸ“** (ğŸ“ Pending)
> **As a** ç©å®¶,
> **I want** çœ‹åˆ°æ¤ç‰©å’Œåƒµå°¸è„šä¸‹çš„é˜´å½±,
> **so that** æ¸¸æˆåœºæ™¯æ›´æœ‰æ·±åº¦æ„Ÿå’ŒçœŸå®æ„Ÿï¼Œç¬¦åˆåŸç‰ˆæ¸¸æˆçš„è§†è§‰è¡¨ç°ã€‚

**çŠ¶æ€**: ğŸ“ å¾…å®ç° (Sprint Change Proposal - 2025-11-24)
**ä¼˜å…ˆçº§**: â­â­â­â­ ä¸­é«˜
**å·¥ä½œé‡**: 6-8 å°æ—¶
**æ–‡æ¡£**: `docs/stories/10.7-plant-zombie-shadow-rendering.md`

---

#### **Story 10.8: é˜³å…‰ä¸è¶³äº¤äº’åé¦ˆ** (ğŸ“ Pending)
> **As a** ç©å®¶,
> **I want** ç‚¹å‡»é˜³å…‰ä¸è¶³çš„æ¤ç‰©å¡ç‰‡æ—¶çœ‹åˆ°é˜³å…‰æ•°å­—é—ªçƒ,
> **so that** æˆ‘èƒ½ç«‹å³æ„è¯†åˆ°é˜³å…‰ä¸è¶³çš„åŸå› ï¼Œè·å¾—æ˜ç¡®çš„æ“ä½œåé¦ˆã€‚

**çŠ¶æ€**: ğŸ“ å¾…å®ç° (Sprint Change Proposal - 2025-11-24)
**ä¼˜å…ˆçº§**: â­â­â­ ä¸­
**å·¥ä½œé‡**: 4-6 å°æ—¶
**æ–‡æ¡£**: `docs/stories/10.8-sun-shortage-feedback.md`

---

### Success Criteria (æˆåŠŸæ ‡å‡†)

1. âœ… æ‰€æœ‰ **8 ä¸ªç”¨æˆ·æ•…äº‹**å®Œæˆï¼ŒAC å…¨éƒ¨æ»¡è¶³
2. âœ… æš‚åœèœå•åŠŸèƒ½å®Œæ•´ï¼ŒUI ç¾è§‚ï¼Œäº¤äº’æµç•…
3. âœ… æ¤ç‰©æ”»å‡»åŠ¨ç”»è‡ªç„¶åˆ‡æ¢ï¼Œæ— å¡é¡¿æˆ–é—ªçƒ
4. âœ… ç§æ¤ç²’å­ç‰¹æ•ˆç¬¦åˆåŸç‰ˆè¡¨ç°ï¼Œæ€§èƒ½è‰¯å¥½
5. âœ… é™¤è‰è½¦ç³»ç»Ÿå®Œæ•´ï¼Œè§¦å‘å‡†ç¡®ï¼ŒåŠ¨ç”»æµç•…
6. âœ… æ”»å‡»åŠ¨ç”»å¸§äº‹ä»¶åŒæ­¥ç²¾ç¡®ï¼Œè§†è§‰è¡¨ç°å®Œç¾
7. âœ… é™¤è‰è½¦å‹æ‰åŠ¨ç”»æ•ˆæœç”ŸåŠ¨ï¼Œç¬¦åˆåŸç‰ˆè¡¨ç°
8. âœ… æ¤ç‰©å’Œåƒµå°¸é˜´å½±æ¸²æŸ“è‡ªç„¶ï¼Œå¢å¼ºåœºæ™¯æ·±åº¦æ„Ÿ
9. âœ… é˜³å…‰ä¸è¶³åé¦ˆæ˜ç¡®ï¼Œäº¤äº’ä½“éªŒå‹å¥½
10. âœ… ç°æœ‰åŠŸèƒ½æ— å›å½’ï¼Œé€šè¿‡ QA æµ‹è¯•
11. âœ… ä»£ç ç¬¦åˆç¼–ç è§„èŒƒï¼Œé€šè¿‡ linter æ£€æŸ¥
12. âœ… æ‰€æœ‰æ–°åŠŸèƒ½æœ‰å¯¹åº”çš„å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡ > 80%ï¼‰
13. âœ… æ–‡æ¡£æ›´æ–°ï¼ˆAGENTS.md, CLAUDE.mdï¼‰
14. âœ… æ¸¸æˆä½“éªŒè¾¾åˆ° MVP æ ‡å‡†

### Technical Implementation (æŠ€æœ¯å®ç°)

**æ–°å¢ç»„ä»¶:**
- `PauseMenuComponent` - æš‚åœèœå•çŠ¶æ€
- `LawnmowerComponent` - é™¤è‰è½¦æ•°æ®
- `LawnmowerStateComponent` - å…¨å±€é™¤è‰è½¦çŠ¶æ€
- `AttackAnimState` - æ”»å‡»åŠ¨ç”»çŠ¶æ€ï¼ˆåœ¨ PlantComponent ä¸­ï¼‰
- `ShadowComponent` - å®ä½“é˜´å½±æ¸²æŸ“å‚æ•°
- `SunCounterFlashComponent` - é˜³å…‰è®¡æ•°å™¨é—ªçƒçŠ¶æ€

**æ–°å¢ç³»ç»Ÿ:**
- `PauseMenuRenderSystem` - æš‚åœèœå•æ¸²æŸ“
- `LawnmowerSystem` - é™¤è‰è½¦è§¦å‘å’Œç§»åŠ¨ç®¡ç†
- `ShadowRenderSystem` - é˜´å½±æ‰¹é‡æ¸²æŸ“

**ç³»ç»Ÿä¿®æ”¹:**
- `GameScene.Update()` - æš‚åœçŠ¶æ€æ£€æµ‹
- `InputSystem.handleLawnClick()` - ç§æ¤ç²’å­æ•ˆæœè§¦å‘
- `InputSystem.handlePlantCardClick()` - é˜³å…‰ä¸è¶³åé¦ˆè§¦å‘
- `BehaviorSystem` - æ¤ç‰©æ”»å‡»åŠ¨ç”»ç®¡ç†å’Œå¸§äº‹ä»¶åŒæ­¥
- `LevelSystem.checkDefeatCondition()` - é™¤è‰è½¦çŠ¶æ€æ£€æµ‹
- `RenderSystem` - é˜´å½±æ¸²æŸ“é›†æˆ
- `UIRenderSystem` - é˜³å…‰è®¡æ•°å™¨é—ªçƒæ¸²æŸ“

**å·¥å‚å‡½æ•°:**
- `NewPauseMenuEntity()` - æš‚åœèœå•å®ä½“
- `NewLawnmowerEntity()` - é™¤è‰è½¦å®ä½“
- `NewPlantingParticleEffect()` - ç§æ¤ç²’å­æ•ˆæœ

### Architecture Highlights (æ¶æ„äº®ç‚¹)

1. **ECS æ¶æ„ä¸€è‡´æ€§** - æ‰€æœ‰æ–°åŠŸèƒ½éµå¾ª ECS æ¨¡å¼ï¼Œé›¶è€¦åˆåŸåˆ™
2. **æ³›å‹ API ä½¿ç”¨** - ä½¿ç”¨ Epic 9 çš„æ³›å‹ ECS APIï¼Œç±»å‹å®‰å…¨
3. **åŸç‰ˆå¿ å®è¿˜åŸ** - æ‰€æœ‰åŠŸèƒ½ä½¿ç”¨åŸç‰ˆèµ„æºå’Œé…ç½®
4. **æ€§èƒ½ä¼˜åŒ–** - ç²’å­æ‰¹é‡æ¸²æŸ“ï¼Œé™¤è‰è½¦ç¢°æ’ä¼˜åŒ–
5. **å¯æ‰©å±•æ€§** - æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ·»åŠ æ–°åŠŸèƒ½

### Dependencies and Blockers (ä¾èµ–ä¸é˜»å¡)

**å‰ç½®ä¾èµ–:**
- âœ… Epic 1-9 å·²å®Œæˆï¼ˆECS æ¡†æ¶ã€Reanim ç³»ç»Ÿã€ç²’å­ç³»ç»Ÿï¼‰
- âœ… èœå•æŒ‰é’® UI å·²åˆ›å»ºï¼ˆStory 8.5ï¼‰

**å¹¶è¡Œä¾èµ–:**
- Story 10.1 å’Œ 10.2 å¯å¹¶è¡Œå¼€å‘ï¼ˆç‹¬ç«‹æ¨¡å—ï¼‰
- Story 10.3 å’Œ 10.4 å¯å¹¶è¡Œå¼€å‘ï¼ˆç‹¬ç«‹æ¨¡å—ï¼‰

**åç»­ä¾èµ–:**
- Epic 11ï¼ˆå¦‚æœ‰ï¼‰å¯èƒ½ä¾èµ–æš‚åœèœå•ç³»ç»Ÿ
- ç¬¬ä¸€ç« å…³å¡å®Œæ•´ä½“éªŒä¾èµ–é™¤è‰è½¦ç³»ç»Ÿ

### Timeline Estimate (æ—¶é—´ä¼°ç®—)

| Story | é¢„ä¼°å·¥ä½œé‡ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|-------|-----------|--------|------|
| Story 10.1: æš‚åœèœå•ç³»ç»Ÿ | 8-12 å°æ—¶ | ä¸­é«˜ | âœ… Done |
| Story 10.2: é™¤è‰è½¦ç³»ç»Ÿ | 12-16 å°æ—¶ | é«˜ | âœ… Done |
| Story 10.3: æ¤ç‰©æ”»å‡»åŠ¨ç”» | 6-8 å°æ—¶ | ä¸­é«˜ | âœ… Done |
| Story 10.4: ç§æ¤ç²’å­ç‰¹æ•ˆ | 4-6 å°æ—¶ | ä¸­ | âœ… Done |
| Story 10.5: æ”»å‡»å¸§äº‹ä»¶åŒæ­¥ | 6-9 å°æ—¶ | ä¸­é«˜ | âœ… Done |
| Story 10.6: é™¤è‰è½¦å‹æ‰åŠ¨ç”» | 9-15 å°æ—¶ | ä¸­ | âœ… Done |
| Story 10.7: é˜´å½±æ¸²æŸ“ | 6-8 å°æ—¶ | ä¸­é«˜ | ğŸ“ Pending |
| Story 10.8: é˜³å…‰åé¦ˆ | 4-6 å°æ—¶ | ä¸­ | ğŸ“ Pending |
| **æ€»è®¡** | **55-80 å°æ—¶** | - | 6/8 Done |

**å·²å®Œæˆå·¥ä½œé‡**: 45-66 å°æ—¶ (Story 10.1, 10.2, 10.3, 10.4, 10.5, 10.6)
**å‰©ä½™å·¥ä½œé‡**: 10-14 å°æ—¶ (Story 10.7, 10.8)

**å»ºè®®å®æ–½é¡ºåº (å‰©ä½™ Story):**
1. Story 10.7ï¼ˆé˜´å½±æ¸²æŸ“ï¼‰- è§†è§‰å®Œæ•´æ€§é‡è¦ï¼Œä¸­é«˜ä¼˜å…ˆçº§
2. Story 10.8ï¼ˆé˜³å…‰åé¦ˆï¼‰- äº¤äº’ä½“éªŒä¼˜åŒ–

### Reference Documentation (å‚è€ƒæ–‡æ¡£)

- **Epic 10 å®Œæ•´è§„èŒƒ**: `docs/prd/epic-10-game-experience-polish.md`
- **Story 10.1 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.1.story.md`
- **Story 10.2 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.2.story.md`
- **Story 10.3 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.3.story.md`
- **Story 10.4 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.4.story.md`
- **Story 10.5 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.5.story.md`
- **Story 10.6 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.6.story.md`
- **Story 10.7 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.7-plant-zombie-shadow-rendering.md`
- **Story 10.8 è¯¦ç»†æ–‡æ¡£**: `docs/stories/10.8-sun-shortage-feedback.md`

---

**åˆ›å»ºæ—¥æœŸ**: 2025-10-21
**åˆ›å»ºäºº**: Sarah (Product Owner)
**Epic ç±»å‹**: Brownfield Enhancement (ä½“éªŒå®Œå–„)
**ä¼˜å…ˆçº§**: Highï¼ˆå®Œæˆ MVP å¿…éœ€ï¼‰
**é¢„ä¼°æ€»å·¥ä½œé‡**: 55-80 å°æ—¶ï¼ˆåŸè®¡åˆ’ 30-42 å°æ—¶ + æ‰©å±• 25-38 å°æ—¶ï¼‰
**æœ€åæ›´æ–°**: 2025-11-24 (Sprint Change Proposal - æ–°å¢ Story 10.7, 10.8)

---

## **Epic 17: åƒµå°¸ç”Ÿæˆå¼•æ“ (Zombie Generation Engine)**

**å²è¯—ç›®æ ‡:** å®ç°ã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹å†’é™©æ¨¡å¼çš„ç²¾ç¡®åƒµå°¸ç”Ÿæˆç³»ç»Ÿï¼ŒåŒ…æ‹¬éš¾åº¦åŠ¨æ€è°ƒæ•´ã€è¡Œåˆ†é…å¹³æ»‘æƒé‡ç®—æ³•ã€æ³¢æ¬¡è®¡æ—¶æ§åˆ¶å’Œæ——å¸œæ³¢ç‰¹æ®Šæœºåˆ¶ï¼Œå®Œå…¨è¿˜åŸåŸç‰ˆæ¸¸æˆçš„å‡ºæ€ªé€»è¾‘å’Œæ¸¸æˆèŠ‚å¥ã€‚

### Epic Overview (å²è¯—æ¦‚è§ˆ)

Epic 17 å°†å®ç°åŸç‰ˆ PvZ å†’é™©æ¨¡å¼çš„æ ¸å¿ƒåƒµå°¸ç”Ÿæˆæœºåˆ¶ï¼ŒåŸºäºé€†å‘å·¥ç¨‹åˆ†æçš„ç²¾ç¡®ç®—æ³•ï¼š

**æ ¸å¿ƒæ¨¡å—:**

| æ¨¡å— | åŠŸèƒ½ | å¤æ‚åº¦ |
|------|------|--------|
| **éš¾åº¦å¼•æ“** | è½®æ•°è®¡ç®—ã€çº§åˆ«å®¹é‡ä¸Šé™ | ä¸­ |
| **å…³å¡è„šæœ¬è§£æ** | æ–°æ ¼å¼æ”¯æŒã€å‘åå…¼å®¹ | ä½ |
| **å¹³æ»‘æƒé‡è¡Œåˆ†é…** | å¤æ‚çš„è¡Œé€‰æ‹©ç®—æ³• | é«˜ |
| **æ³¢æ¬¡è®¡æ—¶ç³»ç»Ÿ** | å¸¸è§„/æ——å¸œ/æœ€ç»ˆæ³¢è®¡æ—¶ | é«˜ |
| **åŠ é€Ÿåˆ·æ–°æœºåˆ¶** | è¡€é‡è§¦å‘çš„æ³¢æ¬¡åŠ é€Ÿ | ä¸­ |
| **åƒµå°¸ç‰©ç†åæ ‡** | å‡ºç”Ÿç‚¹å’Œè¿›å®¶åˆ¤å®š | ä¸­ |

### Stories (æ•…äº‹åˆ—è¡¨)

Epic 17 åŒ…å« **10 ä¸ª Story**:

1. **Story 17.1**: éš¾åº¦å¼•æ“ - è½®æ•°ä¸çº§åˆ«å®¹é‡è®¡ç®—
2. **Story 17.2**: å…³å¡è„šæœ¬æ ¼å¼å‡çº§ä¸è§£æå™¨
3. **Story 17.3**: åƒµå°¸ç”Ÿæˆé™åˆ¶æ£€æŸ¥ç³»ç»Ÿ
4. **Story 17.4**: å¹³æ»‘æƒé‡è¡Œåˆ†é…ç®—æ³• - æ ¸å¿ƒå®ç°
5. **Story 17.5**: åˆæ³•è¡Œåˆ¤å®šç³»ç»Ÿ
6. **Story 17.6**: æ³¢æ¬¡åˆ·æ–°è®¡æ—¶å™¨ - å¸¸è§„æ³¢æ¬¡
7. **Story 17.7**: æ——å¸œæ³¢ç‰¹æ®Šè®¡æ—¶ä¸çº¢å­—è­¦å‘Š
8. **Story 17.8**: åŠ é€Ÿåˆ·æ–°æœºåˆ¶ - è¡€é‡è§¦å‘
9. **Story 17.9**: åƒµå°¸ç‰©ç†ä¸è¾¹ç•Œ - åæ ‡ç³»ç»Ÿ
10. **Story 17.10**: é›†æˆæµ‹è¯•ä¸å…³å¡éªŒè¯

### Success Criteria (æˆåŠŸæ ‡å‡†)

1. âœ… éš¾åº¦å¼•æ“æ­£ç¡®è®¡ç®—è½®æ•°å’Œçº§åˆ«å®¹é‡
2. âœ… å¹³æ»‘æƒé‡è¡Œåˆ†é…ç®—æ³•å®ç°ï¼Œåˆ†å¸ƒè‡ªç„¶
3. âœ… æ³¢æ¬¡è®¡æ—¶ç³»ç»Ÿå®Œæ•´ï¼ŒåŒ…æ‹¬æ——å¸œæ³¢å’Œæœ€ç»ˆæ³¢
4. âœ… åŠ é€Ÿåˆ·æ–°æœºåˆ¶æ­£ç¡®è§¦å‘
5. âœ… åƒµå°¸å‡ºç”Ÿåæ ‡å’Œè¿›å®¶åˆ¤å®šå‡†ç¡®
6. âœ… å…³å¡ 1-1 è‡³ 1-4 éªŒè¯é€šè¿‡
7. âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
8. âœ… æ€§èƒ½ç¬¦åˆè¦æ±‚ (60 FPS)

### Timeline Estimate (æ—¶é—´ä¼°ç®—)

| Story | é¢„ä¼°å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|-------|-----------|--------|
| Story 17.1-17.3 | 14-20 å°æ—¶ | é«˜ |
| Story 17.4-17.5 | 12-18 å°æ—¶ | é«˜ |
| Story 17.6-17.8 | 20-26 å°æ—¶ | é«˜ |
| Story 17.9-17.10 | 10-14 å°æ—¶ | ä¸­ |
| **æ€»è®¡** | **56-78 å°æ—¶** | - |

**è¯¦ç»†è®¾è®¡æ–‡æ¡£**: å®Œæ•´çš„ Epic 17 è§„èŒƒè¯·å‚è§ [Epic 17 è¯¦ç»†æ–‡æ¡£](prd/epic-17-zombie-generation-engine.md)ã€‚

### Reference Documentation (å‚è€ƒæ–‡æ¡£)

- **è®¾è®¡æ–‡æ¡£**: `.meta/levels/ZombieGenerationModuleDesignDocument.md`
- **Epic 17 å®Œæ•´è§„èŒƒ**: `docs/prd/epic-17-zombie-generation-engine.md`

---

**åˆ›å»ºæ—¥æœŸ**: 2025-11-27
**åˆ›å»ºäºº**: Sarah (Product Owner)
**Epic ç±»å‹**: Core Feature (æ ¸å¿ƒåŠŸèƒ½)
**ä¼˜å…ˆçº§**: Highï¼ˆåŸç‰ˆå¿ å®åº¦å…³é”®ï¼‰
**é¢„ä¼°æ€»å·¥ä½œé‡**: 56-78 å°æ—¶ï¼ˆçº¦ 2-3 å‘¨ï¼‰

---

## **Epic 18: æ¸¸æˆæˆ˜æ–—å­˜æ¡£ç³»ç»Ÿ (Battle Save System) - Brownfield Enhancement**

**å²è¯—ç›®æ ‡:** ä¸ºã€Šæ¤ç‰©å¤§æˆ˜åƒµå°¸ã€‹å¤åˆ»ç‰ˆå®ç°æˆ˜æ–—ä¸­å­˜æ¡£/è¯»æ¡£åŠŸèƒ½ã€‚ç©å®¶ç‚¹å‡»æš‚åœèœå•çš„"ä¸»èœå•"æŒ‰é’®æ—¶è‡ªåŠ¨ä¿å­˜å½“å‰æˆ˜æ–—è¿›åº¦ï¼Œå†æ¬¡è¿›å…¥å†’é™©æ¨¡å¼æ—¶å¯é€‰æ‹©ç»§ç»­æ¸¸æˆæˆ–é‡ç©å…³å¡ï¼Œæä¾›ç®€æ´çš„ç”¨æˆ·äº¤äº’ä½“éªŒã€‚

### Epic Overview (å²è¯—æ¦‚è§ˆ)

Epic 18 æ˜¯å¯¹ç°æœ‰ SaveManager ç³»ç»Ÿçš„æ‰©å±•ï¼Œä¸ºæˆ˜æ–—åœºæ™¯å¢åŠ å®Œæ•´çš„å­˜æ¡£/è¯»æ¡£åŠŸèƒ½ã€‚

**å½“å‰ç³»ç»Ÿç°çŠ¶:**
- ç°æœ‰ `SaveManager` (Story 8.6) å®ç°äº†å…³å¡è¿›åº¦ä¿å­˜
- å­˜å‚¨æ ¼å¼: YAML
- å­˜å‚¨å†…å®¹: æœ€é«˜å®Œæˆå…³å¡ã€è§£é”æ¤ç‰©ã€è§£é”å·¥å…·
- å­˜å‚¨ä½ç½®: `data/saves/{username}.yaml`

**æ–°å¢åŠŸèƒ½:**

| åŠŸèƒ½ | è¯´æ˜ |
|------|------|
| **è‡ªåŠ¨å­˜æ¡£** | ç‚¹å‡»æš‚åœèœå•"ä¸»èœå•"æŒ‰é’®æ—¶è‡ªåŠ¨ä¿å­˜æˆ˜æ–—çŠ¶æ€ |
| **å­˜æ¡£æ£€æµ‹** | è¿›å…¥å†’é™©æ¨¡å¼æ—¶æ£€æµ‹æ˜¯å¦æœ‰æœªå®Œæˆçš„æˆ˜æ–—å­˜æ¡£ |
| **ç»§ç»­æ¸¸æˆå¯¹è¯æ¡†** | æ˜¾ç¤º"ç»§ç»­æ¸¸æˆ?"å¯¹è¯æ¡†ï¼Œæä¾›ç»§ç»­/é‡ç©/å–æ¶ˆé€‰é¡¹ |
| **åœºæ™¯æ¢å¤** | ä»å­˜æ¡£æ¢å¤å®Œæ•´çš„æ¸¸æˆåœºæ™¯ï¼ˆæ¤ç‰©ã€åƒµå°¸ã€é˜³å…‰ç­‰ï¼‰ |

**æŠ€æœ¯æ–¹æ¡ˆ:**
- **å­˜æ¡£æ ¼å¼**: gob äºŒè¿›åˆ¶åºåˆ—åŒ–ï¼ˆç´§å‡‘ã€å¿«é€Ÿã€é˜²ä¿®æ”¹ï¼‰
- **å­˜æ¡£ä½ç½®**: `data/saves/{username}_battle.sav`
- **æ¶æ„æ¨¡å¼**: éµå¾ª ECS æ¶æ„ï¼Œç»„ä»¶æ•°æ®åºåˆ—åŒ–

**ç”¨æˆ·äº¤äº’æµç¨‹:**

```
ä¿å­˜æµç¨‹:
æ¸¸æˆä¸­ â†’ æŒ‰ ESC â†’ æš‚åœèœå• â†’ ç‚¹å‡»"ä¸»èœå•" â†’ è‡ªåŠ¨ä¿å­˜æˆ˜æ–—è¿›åº¦ â†’ è¿”å›ä¸»èœå•

åŠ è½½æµç¨‹:
ä¸»èœå• â†’ ç‚¹å‡»"å†’é™©æ¨¡å¼" â†’ æ£€æµ‹åˆ°å­˜æ¡£ â†’ æ˜¾ç¤ºå¯¹è¯æ¡†
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        ç»§ç»­æ¸¸æˆ?               â”‚
    â”‚                                â”‚
    â”‚  ä½ æƒ³ç»§ç»­å½“å‰æ¸¸æˆè¿˜æ˜¯é‡ç©æ­¤å…³å¡ï¼Ÿâ”‚
    â”‚                                â”‚
    â”‚    [ç»§ç»­]      [é‡ç©å…³å¡]       â”‚
    â”‚           [å–æ¶ˆ]               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                â†“              â†“
     åŠ è½½å­˜æ¡£         åˆ é™¤å­˜æ¡£å¹¶        è¿”å›ä¸»èœå•
     ç»§ç»­æ¸¸æˆ         é‡æ–°å¼€å§‹å…³å¡
```

### Stories (æ•…äº‹åˆ—è¡¨)

Epic 18 åŒ…å« **3 ä¸ª Story**:

---

#### **Story 18.1: æˆ˜æ–—çŠ¶æ€åºåˆ—åŒ–ç³»ç»Ÿ**
> **As a** å¼€å‘è€…,
> **I want** to implement battle state serialization using gob binary format,
> **so that** the game can save and restore complete battle state.

**Acceptance Criteria:**
1. **BattleSaveData æ•°æ®ç»“æ„**: å®šä¹‰å®Œæ•´çš„æˆ˜æ–—çŠ¶æ€æ•°æ®ç»“æ„ï¼ŒåŒ…å«ç‰ˆæœ¬å·ã€ä¿å­˜æ—¶é—´ã€å…³å¡çŠ¶æ€ã€æ‰€æœ‰å®ä½“æ•°æ®
2. **å®ä½“æ•°æ®åºåˆ—åŒ–**:
   - æ¤ç‰©: ç±»å‹ã€ç½‘æ ¼ä½ç½®ã€ç”Ÿå‘½å€¼ã€æ”»å‡»çŠ¶æ€ã€å†·å´æ—¶é—´
   - åƒµå°¸: ç±»å‹ã€ä½ç½®ã€é€Ÿåº¦ã€ç”Ÿå‘½å€¼ã€æŠ¤ç”²ã€è¡Œä¸ºçŠ¶æ€
   - å­å¼¹: ç±»å‹ã€ä½ç½®ã€é€Ÿåº¦ã€ä¼¤å®³
   - é˜³å…‰: ä½ç½®ã€ç”Ÿå‘½å‘¨æœŸçŠ¶æ€
   - é™¤è‰è½¦: æ‰€åœ¨è¡Œã€æ˜¯å¦å·²è§¦å‘
3. **BattleSerializer å®ç°**: `SaveBattle(em, gameState, filePath) error`, `LoadBattle(filePath) (*BattleSaveData, error)`
4. **SaveManager æ‰©å±•**: `HasBattleSave()`, `GetBattleSaveInfo()`, `DeleteBattleSave()`, `GetBattleSavePath()`
5. **å•å…ƒæµ‹è¯•**: è¦†ç›–ç‡ â‰¥ 80%

**ä¼˜å…ˆçº§**: â­â­â­â­â­ é«˜
**é¢„ä¼°å·¥ä½œé‡**: 8-10 å°æ—¶

---

#### **Story 18.2: ä¿å­˜è§¦å‘ä¸è‡ªåŠ¨åŠ è½½**
> **As a** ç©å®¶,
> **I want** the game to automatically save my battle progress when I return to main menu,
> **so that** I don't lose my progress when exiting the game.

**Acceptance Criteria:**
1. **æš‚åœèœå•"ä¸»èœå•"æŒ‰é’®è§¦å‘ä¿å­˜**: ä¿®æ”¹ `PauseMenuModule.onMainMenu` å›è°ƒï¼Œè°ƒç”¨ `BattleSerializer.SaveBattle()` ä¿å­˜å½“å‰çŠ¶æ€
2. **å†’é™©æ¨¡å¼å…¥å£æ£€æµ‹å­˜æ¡£**: ä¿®æ”¹ `MainMenuScene.onStartAdventureClicked()`ï¼Œæ£€æŸ¥ `SaveManager.HasBattleSave(username)`
3. **å­˜æ¡£ä¿¡æ¯è¯»å–**: å®ç° `BattleSaveInfo` ç»“æ„ï¼ˆå…³å¡IDã€ä¿å­˜æ—¶é—´ï¼‰ç”¨äºå¯¹è¯æ¡†æ˜¾ç¤º
4. **æ—¥å¿—è¾“å‡º**: è®°å½•ä¿å­˜/åŠ è½½æ“ä½œï¼Œæ”¯æŒè°ƒè¯•æ¨¡å¼æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
5. **å•å…ƒæµ‹è¯•**: è¦†ç›–ç‡ â‰¥ 80%

**ä¼˜å…ˆçº§**: â­â­â­â­â­ é«˜
**é¢„ä¼°å·¥ä½œé‡**: 4-6 å°æ—¶

---

#### **Story 18.3: ç»§ç»­æ¸¸æˆå¯¹è¯æ¡†ä¸åœºæ™¯æ¢å¤**
> **As a** ç©å®¶,
> **I want** to choose whether to continue my saved game or restart the level,
> **so that** I have control over my game progress.

**Acceptance Criteria:**
1. **ç»§ç»­æ¸¸æˆå¯¹è¯æ¡†**: Title: "ç»§ç»­æ¸¸æˆ?", Message: "ä½ æƒ³ç»§ç»­å½“å‰æ¸¸æˆè¿˜æ˜¯é‡ç©æ­¤å…³å¡ï¼Ÿ"
   - æŒ‰é’®å¸ƒå±€ï¼ˆä¸¤è¡Œï¼‰:
     - ç¬¬ä¸€è¡Œ: [ç»§ç»­] [é‡ç©å…³å¡]
     - ç¬¬äºŒè¡Œ: [å–æ¶ˆ]
   - å¤ç”¨ `DialogComponent` å’Œç°æœ‰å¯¹è¯æ¡†æ ·å¼
2. **æŒ‰é’®è¡Œä¸º**:
   - **ç»§ç»­**: è°ƒç”¨ `GameScene.LoadFromSave()` æ¢å¤æ¸¸æˆ
   - **é‡ç©å…³å¡**: åˆ é™¤å­˜æ¡£ï¼Œæ­£å¸¸å¼€å§‹è¯¥å…³å¡
   - **å–æ¶ˆ**: å…³é—­å¯¹è¯æ¡†ï¼Œè¿”å›ä¸»èœå•
3. **GameScene.LoadFromSave() å®ç°**: æ¢å¤ GameState çŠ¶æ€ã€é‡å»ºæ‰€æœ‰å®ä½“ã€æ¢å¤è‰åªç½‘æ ¼çŠ¶æ€
4. **åŠ¨ç”»çŠ¶æ€æ¢å¤**: Reanim åŠ¨ç”»ä» idle çŠ¶æ€å¼€å§‹ï¼ˆç®€åŒ–å¤„ç†ï¼‰
5. **é”™è¯¯å¤„ç†**: å­˜æ¡£æŸåæ—¶æç¤ºç”¨æˆ·ï¼Œæä¾›åˆ é™¤æŸåå­˜æ¡£çš„é€‰é¡¹
6. **å•å…ƒæµ‹è¯•**: è¦†ç›–ç‡ â‰¥ 80%

**ä¼˜å…ˆçº§**: â­â­â­â­â­ é«˜
**é¢„ä¼°å·¥ä½œé‡**: 8-10 å°æ—¶

---

### éœ€è¦ä¿å­˜çš„æˆ˜æ–—çŠ¶æ€

#### å…³å¡çŠ¶æ€

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `LevelID` | string | å…³å¡ID (å¦‚ "1-2") |
| `LevelTime` | float64 | å…³å¡å·²è¿›è¡Œæ—¶é—´ï¼ˆç§’ï¼‰ |
| `CurrentWaveIndex` | int | å½“å‰æ³¢æ¬¡ç´¢å¼• |
| `SpawnedWaves` | []bool | å·²ç”Ÿæˆæ³¢æ¬¡æ ‡è®° |
| `TotalZombiesSpawned` | int | å·²ç”Ÿæˆåƒµå°¸æ€»æ•° |
| `ZombiesKilled` | int | å·²æ¶ˆç­åƒµå°¸æ•° |
| `Sun` | int | å½“å‰é˜³å…‰æ•°é‡ |

#### å®ä½“æ•°æ®

**PlantData:**
```go
type PlantData struct {
    PlantType    string  // æ¤ç‰©ç±»å‹
    GridRow      int     // ç½‘æ ¼è¡Œ
    GridCol      int     // ç½‘æ ¼åˆ—
    Health       int     // å½“å‰ç”Ÿå‘½å€¼
    MaxHealth    int     // æœ€å¤§ç”Ÿå‘½å€¼
    CooldownTime float64 // å‰©ä½™å†·å´æ—¶é—´
}
```

**ZombieData:**
```go
type ZombieData struct {
    ZombieType   string  // åƒµå°¸ç±»å‹
    X            float64 // X åæ ‡
    Y            float64 // Y åæ ‡
    VelocityX    float64 // X é€Ÿåº¦
    Health       int     // å½“å‰ç”Ÿå‘½å€¼
    MaxHealth    int     // æœ€å¤§ç”Ÿå‘½å€¼
    ArmorHealth  int     // æŠ¤ç”²ç”Ÿå‘½å€¼ï¼ˆå¦‚æœ‰ï¼‰
    Lane         int     // æ‰€åœ¨è¡Œ
    BehaviorType string  // å½“å‰è¡Œä¸ºç±»å‹
}
```

**ProjectileData:**
```go
type ProjectileData struct {
    Type      string  // å­å¼¹ç±»å‹
    X         float64 // X åæ ‡
    Y         float64 // Y åæ ‡
    VelocityX float64 // X é€Ÿåº¦
    Damage    int     // ä¼¤å®³å€¼
    Lane      int     // æ‰€åœ¨è¡Œ
}
```

**SunData:**
```go
type SunData struct {
    X         float64 // X åæ ‡
    Y         float64 // Y åæ ‡
    Lifetime  float64 // å‰©ä½™ç”Ÿå‘½å‘¨æœŸ
    IsDropped bool    // æ˜¯å¦ä¸ºå¤©é™é˜³å…‰
}
```

**LawnmowerData:**
```go
type LawnmowerData struct {
    Lane      int     // æ‰€åœ¨è¡Œ
    Triggered bool    // æ˜¯å¦å·²è§¦å‘
    X         float64 // X åæ ‡ï¼ˆå¦‚å·²è§¦å‘ï¼‰
}
```

### Success Criteria (æˆåŠŸæ ‡å‡†)

1. âœ… ç‚¹å‡»æš‚åœèœå•"ä¸»èœå•"æŒ‰é’®è‡ªåŠ¨ä¿å­˜æˆ˜æ–—è¿›åº¦
2. âœ… è¿›å…¥å†’é™©æ¨¡å¼æ—¶æ­£ç¡®æ£€æµ‹å­˜æ¡£
3. âœ… ç»§ç»­æ¸¸æˆå¯¹è¯æ¡†æ˜¾ç¤ºæ­£ç¡®ï¼ŒæŒ‰é’®å¸ƒå±€ç¬¦åˆè®¾è®¡
4. âœ… "ç»§ç»­"æŒ‰é’®æ¢å¤æ¸¸æˆçŠ¶æ€ï¼Œä¸ä¿å­˜æ—¶ä¸€è‡´
5. âœ… "é‡ç©å…³å¡"æŒ‰é’®åˆ é™¤å­˜æ¡£å¹¶é‡æ–°å¼€å§‹
6. âœ… "å–æ¶ˆ"æŒ‰é’®è¿”å›ä¸»èœå•
7. âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
8. âœ… æ— å›å½’é—®é¢˜

### Technical Implementation (æŠ€æœ¯å®ç°)

**æ–°å¢æ–‡ä»¶:**

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| `pkg/game/battle_save_data.go` | æˆ˜æ–—å­˜æ¡£æ•°æ®ç»“æ„å®šä¹‰ |
| `pkg/game/battle_serializer.go` | gob åºåˆ—åŒ–/ååºåˆ—åŒ– |

**ä¿®æ”¹æ–‡ä»¶:**

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `pkg/game/save_manager.go` | æ·»åŠ æˆ˜æ–—å­˜æ¡£ç®¡ç†æ–¹æ³• |
| `pkg/modules/pause_menu_module.go` | ä¸»èœå•æŒ‰é’®è§¦å‘ä¿å­˜ |
| `pkg/scenes/main_menu_scene.go` | å†’é™©æ¨¡å¼æ£€æµ‹å­˜æ¡£ï¼Œåˆ›å»ºå¯¹è¯æ¡† |
| `pkg/scenes/game_scene.go` | æ·»åŠ  `LoadFromSave()` æ–¹æ³• |

**å­˜æ¡£æ–‡ä»¶ç»“æ„:**

```
data/
â””â”€â”€ saves/
    â”œâ”€â”€ {username}.yaml           # å…³å¡è¿›åº¦å­˜æ¡£ï¼ˆç°æœ‰ï¼‰
    â””â”€â”€ {username}_battle.sav     # æˆ˜æ–—å­˜æ¡£ï¼ˆæ–°å¢ï¼Œgob äºŒè¿›åˆ¶ï¼‰
```

### Dependencies and Blockers (ä¾èµ–ä¸é˜»å¡)

**å‰ç½®ä¾èµ–:**
- âœ… Story 8.6 SaveManager å·²å®ç°
- âœ… Story 10.1 æš‚åœèœå•ç³»ç»Ÿå·²å®ç°
- âœ… Story 12.4 ç”¨æˆ·ç®¡ç†ç³»ç»Ÿå·²å®ç°
- âœ… DialogComponent å¯¹è¯æ¡†ç»„ä»¶å·²å®ç°

**æ— é˜»å¡é¡¹:**
æœ¬ Epic ä¸é˜»å¡å…¶ä»– Epicï¼Œå¯ç‹¬ç«‹å¼€å‘ã€‚

### Timeline Estimate (æ—¶é—´ä¼°ç®—)

| Story | é¢„ä¼°å·¥ä½œé‡ | ä¼˜å…ˆçº§ | ä¾èµ– |
|-------|-----------|--------|------|
| Story 18.1: æˆ˜æ–—çŠ¶æ€åºåˆ—åŒ–ç³»ç»Ÿ | 8-10 å°æ—¶ | é«˜ | æ—  |
| Story 18.2: ä¿å­˜è§¦å‘ä¸è‡ªåŠ¨åŠ è½½ | 4-6 å°æ—¶ | é«˜ | 18.1 |
| Story 18.3: ç»§ç»­æ¸¸æˆå¯¹è¯æ¡†ä¸åœºæ™¯æ¢å¤ | 8-10 å°æ—¶ | é«˜ | 18.1, 18.2 |
| **æ€»è®¡** | **20-26 å°æ—¶** | - | - |

**é¢„ä¼°å‘¨æœŸ**: 3-5 å¤©ï¼ˆå•äººå¼€å‘ï¼‰

### Reference Documentation (å‚è€ƒæ–‡æ¡£)

- **ç°æœ‰ä¿å­˜ç³»ç»Ÿ**: `pkg/game/save_manager.go`
- **æš‚åœèœå•æ¨¡å—**: `pkg/modules/pause_menu_module.go`
- **å¯¹è¯æ¡†ç»„ä»¶**: `pkg/components/dialog_component.go`
- **æ¸¸æˆåœºæ™¯**: `pkg/scenes/game_scene.go`
- **Epic 18 å®Œæ•´è§„èŒƒ**: `docs/prd/epic-18-battle-save-system.md`

---

**åˆ›å»ºæ—¥æœŸ**: 2025-11-29
**åˆ›å»ºäºº**: John (Product Manager)
**Epic ç±»å‹**: Brownfield Enhancement (æ£•åœ°å¢å¼º)
**ä¼˜å…ˆçº§**: Mediumï¼ˆç”¨æˆ·ä½“éªŒæ”¹è¿›ï¼‰
**é¢„ä¼°æ€»å·¥ä½œé‡**: 20-26 å°æ—¶ï¼ˆçº¦ 3-5 å¤©ï¼‰
