# Story 7.1: ç²’å­é…ç½®è§£æç³»ç»Ÿ

## Status
Done

## Story
**As a** å¼€å‘è€…,
**I want** to parse particle XML configuration files and load particle textures,
**so that** I can use original PVZ particle effect data.

## Acceptance Criteria
1. å®ç°ç²’å­é…ç½®æ•°æ®ç»“æ„ï¼š`ParticleConfig`, `EmitterConfig`, `Field`ç­‰
2. å®ç°XMLè§£æå™¨ `internal/particle/parser.go`
3. è§£æå™¨èƒ½æˆåŠŸè§£æè‡³å°‘5ä¸ªä»£è¡¨æ€§ç²’å­é…ç½®ï¼ˆAward.xml, BossExplosion.xml, CabbageSplat.xmlç­‰ï¼‰
4. æ”¯æŒ40+ç§ç²’å­å±æ€§çš„è§£æï¼ˆSpawn*, Particle*, Launch*, Fieldç­‰ï¼‰
5. æ‰©å±•`ResourceManager`ï¼Œæ·»åŠ `LoadParticleConfig(name string)`æ–¹æ³•
6. ç²’å­è´´å›¾åŠ è½½é›†æˆåˆ°`ResourceManager`
7. å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 80%
8. è§£æç»“æœä¸XMLé…ç½®ä¸€è‡´æ€§éªŒè¯

## Tasks / Subtasks

### Task 1: åˆ›å»ºç²’å­é…ç½®æ•°æ®ç»“æ„ (AC: 1)
- [x] åœ¨ `internal/particle/` ç›®å½•ä¸‹åˆ›å»ºæ•°æ®ç»“æ„å®šä¹‰æ–‡ä»¶
  - [x] å®šä¹‰ `ParticleConfig` ç»“æ„ä½“ï¼šè¡¨ç¤ºæ•´ä¸ªç²’å­æ•ˆæœé…ç½®ï¼ˆåŒ…å«å¤šä¸ªEmitterï¼‰
  - [x] å®šä¹‰ `EmitterConfig` ç»“æ„ä½“ï¼šè¡¨ç¤ºå•ä¸ªå‘å°„å™¨é…ç½®
  - [x] å®šä¹‰ `Field` ç»“æ„ä½“ï¼šè¡¨ç¤ºåŠ›åœºé…ç½®ï¼ˆFieldType, X, Yå‚æ•°ï¼‰
  - [x] å®šä¹‰ `AnimationKeyframe` ç»“æ„ä½“ï¼šè¡¨ç¤ºåŠ¨ç”»å…³é”®å¸§ï¼ˆæ—¶é—´, å€¼ï¼‰
  - [x] ç¡®ä¿æ‰€æœ‰å­—æ®µéƒ½ä½¿ç”¨æ­£ç¡®çš„XMLæ ‡ç­¾æ˜ å°„ï¼ˆxml:"Name"ç­‰ï¼‰
- [x] æ”¯æŒä»¥ä¸‹æ ¸å¿ƒå±æ€§ç±»åˆ«ï¼ˆå‚è€ƒEpic 7å’ŒXMLç¤ºä¾‹ï¼‰ï¼š
  - [x] **Spawnå±æ€§**ï¼šSpawnMinActive, SpawnMaxActive, SpawnMaxLaunched, SpawnRate
  - [x] **Particleå±æ€§**ï¼šParticleDuration, ParticleAlpha, ParticleScale, ParticleSpinAngle, ParticleSpinSpeed, ParticleRed, ParticleGreen, ParticleBlue, ParticleBrightness
  - [x] **Launchå±æ€§**ï¼šLaunchSpeed, LaunchAngle
  - [x] **Emitterå±æ€§**ï¼šEmitterBoxX, EmitterBoxY, EmitterRadius, EmitterType, EmitterSkewX, EmitterOffsetX, EmitterOffsetY
  - [x] **Systemå±æ€§**ï¼šSystemDuration, SystemAlpha
  - [x] **Fieldå±æ€§**ï¼šFieldTypeï¼ˆæ”¯æŒFriction, Accelerationç­‰ï¼‰
  - [x] **å…¶ä»–å±æ€§**ï¼šImage, ImageFrames, ImageRow, ImageCol, Additive, RandomLaunchSpin, ParticlesDontFollow
- [x] æ‰€æœ‰ç»“æ„ä½“å¿…é¡»æ˜¯çº¯æ•°æ®ï¼Œæ— æ–¹æ³•ï¼ˆç¬¦åˆECSåŸåˆ™ï¼‰

### Task 2: å®ç°XMLè§£æå™¨ (AC: 2, 4)
- [x] åˆ›å»º `internal/particle/parser.go`
  - [x] å®ç° `ParseParticleXML(path string) (*ParticleConfig, error)` å‡½æ•°
  - [x] ä½¿ç”¨ Go æ ‡å‡†åº“ `encoding/xml` è¿›è¡Œè§£æ
  - [x] å¤„ç†åµŒå¥—çš„ Emitter æ ‡ç­¾ï¼ˆä¸€ä¸ªXMLæ–‡ä»¶å¯èƒ½åŒ…å«å¤šä¸ªEmitterï¼‰
  - [x] å¤„ç†åµŒå¥—çš„ Field æ ‡ç­¾ï¼ˆEmitterå†…éƒ¨å¯èƒ½æœ‰å¤šä¸ªFieldï¼‰
  - [x] è§£æå¤æ‚çš„å€¼æ ¼å¼ï¼š
    - [x] æ”¯æŒå•å€¼ï¼š`1.5`
    - [x] æ”¯æŒèŒƒå›´ï¼š`[0.7 0.9]`ï¼ˆéšæœºå€¼ï¼‰
    - [x] æ”¯æŒå…³é”®å¸§åŠ¨ç”»ï¼š`0,2 1,2 4,21`ï¼ˆæ—¶é—´,å€¼ åºåˆ—ï¼‰
    - [x] æ”¯æŒæ’å€¼ï¼š`Linear` å…³é”®å­—
  - [x] é”™è¯¯å¤„ç†ï¼šæ–‡ä»¶ä¸å­˜åœ¨ã€XMLæ ¼å¼é”™è¯¯ã€å¿…éœ€å­—æ®µç¼ºå¤±
- [x] å®ç°è¾…åŠ©è§£æå‡½æ•°ï¼š
  - [x] `parseValueOrRange(s string) (min, max float64)`
  - [x] `parseKeyframes(s string) []AnimationKeyframe`

### Task 3: æµ‹è¯•è§£æ5ä¸ªä»£è¡¨æ€§é…ç½®æ–‡ä»¶ (AC: 3, 8)
- [x] ç¼–å†™é›†æˆæµ‹è¯•è§£æä»¥ä¸‹æ–‡ä»¶ï¼š
  - [x] `data/particles/Award.xml`ï¼ˆå¤æ‚å¤šå‘å°„å™¨ï¼‰
  - [x] `data/particles/BossExplosion.xml`ï¼ˆçˆ†ç‚¸æ•ˆæœï¼‰
  - [x] `data/particles/CabbageSplat.xml`ï¼ˆæº…å°„æ•ˆæœï¼‰
  - [x] `data/particles/BlastMark.xml`ï¼ˆç®€å•å•å‘å°„å™¨ï¼‰
  - [x] `data/particles/CoinPickupArrow.xml`ï¼ˆUIæ•ˆæœï¼‰
- [x] éªŒè¯è§£æç»“æœçš„ä¸€è‡´æ€§ï¼š
  - [x] ä½¿ç”¨æ–­è¨€æ£€æŸ¥å…³é”®å±æ€§å€¼æ˜¯å¦ä¸XMLåŒ¹é…
  - [x] éªŒè¯Emitteræ•°é‡æ­£ç¡®
  - [x] éªŒè¯Fieldæ•°é‡å’Œç±»å‹æ­£ç¡®
  - [x] è®°å½•ä»»ä½•è§£æå¤±è´¥æˆ–ä¸ä¸€è‡´çš„æƒ…å†µ

### Task 4: æ‰©å±•ResourceManageråŠ è½½ç²’å­é…ç½® (AC: 5)
- [x] åœ¨ `pkg/game/resource_manager.go` ä¸­æ·»åŠ ç²’å­é…ç½®ç¼“å­˜ï¼š
  - [x] æ·»åŠ å­—æ®µï¼š`particleConfigCache map[string]*particle.ParticleConfig`
  - [x] åœ¨ `NewResourceManager()` ä¸­åˆå§‹åŒ–map
- [x] å®ç° `LoadParticleConfig(name string) (*particle.ParticleConfig, error)`ï¼š
  - [x] æ£€æŸ¥ç¼“å­˜ï¼Œå¦‚æœå·²åŠ è½½ç›´æ¥è¿”å›
  - [x] æ„å»ºæ–‡ä»¶è·¯å¾„ï¼š`data/particles/{name}.xml`
  - [x] è°ƒç”¨ `particle.ParseParticleXML(path)` è§£æ
  - [x] å°†ç»“æœå­˜å…¥ç¼“å­˜
  - [x] è¿”å›é…ç½®æˆ–é”™è¯¯
- [x] å®ç° `GetParticleConfig(name string) *particle.ParticleConfig`ï¼š
  - [x] ä»ç¼“å­˜è·å–å·²åŠ è½½çš„é…ç½®ï¼ˆä¸è§¦å‘åŠ è½½ï¼‰
  - [x] ç”¨äºå¿«é€Ÿè®¿é—®

### Task 5: é›†æˆç²’å­è´´å›¾åŠ è½½åˆ°ResourceManager (AC: 6)
- [x] æ‰©å±•ç°æœ‰å›¾ç‰‡åŠ è½½æœºåˆ¶æ”¯æŒç²’å­è´´å›¾ï¼š
  - [x] éªŒè¯ `LoadImage(path string)` æ–¹æ³•å¯ä»¥åŠ è½½ `assets/particles/*.png`
  - [x] éªŒè¯ `LoadImageByID(id string)` å¯ä»¥åŠ è½½ç²’å­è´´å›¾ï¼ˆå¦‚æœresources.yamlä¸­å·²å®šä¹‰ï¼‰
- [x] ï¼ˆå¯é€‰ï¼‰å®ç°æ‰¹é‡é¢„åŠ è½½å¸¸ç”¨ç²’å­è´´å›¾ï¼š
  - [x] æ·»åŠ  `LoadParticleTextures() error` æ–¹æ³•
  - [x] é¢„åŠ è½½é«˜é¢‘ä½¿ç”¨çš„è´´å›¾ï¼ˆå¦‚æœæ€§èƒ½éœ€è¦ï¼‰
- [x] ç¡®ä¿ç²’å­è´´å›¾ä¸ç°æœ‰èµ„æºç®¡ç†å™¨ç¼“å­˜æœºåˆ¶å…¼å®¹

### Task 6: å•å…ƒæµ‹è¯•è¦†ç›– (AC: 7)
- [x] åˆ›å»º `internal/particle/parser_test.go`ï¼š
  - [x] æµ‹è¯• `ParseParticleXML` åŸºç¡€åŠŸèƒ½
  - [x] æµ‹è¯•å„ç§å€¼æ ¼å¼è§£æï¼ˆå•å€¼ã€èŒƒå›´ã€å…³é”®å¸§ï¼‰
  - [x] æµ‹è¯•é”™è¯¯æƒ…å†µï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æ ¼å¼é”™è¯¯ï¼‰
  - [x] æµ‹è¯•åµŒå¥—Emitterå’ŒFieldè§£æ
- [x] åˆ›å»º `pkg/game/resource_manager_test.go`ï¼ˆæ‰©å±•ç°æœ‰æµ‹è¯•ï¼‰ï¼š
  - [x] æµ‹è¯• `LoadParticleConfig` ç¼“å­˜åŠŸèƒ½
  - [x] æµ‹è¯•é‡å¤åŠ è½½åŒä¸€é…ç½®ï¼ˆéªŒè¯ç¼“å­˜ï¼‰
  - [x] æµ‹è¯•åŠ è½½ä¸å­˜åœ¨çš„é…ç½®ï¼ˆé”™è¯¯å¤„ç†ï¼‰
- [x] è¿è¡Œæµ‹è¯•è¦†ç›–ç‡æ£€æŸ¥ï¼š
  - [x] `go test -cover ./internal/particle`
  - [x] `go test -cover ./pkg/game`
  - [x] ç¡®ä¿è¦†ç›–ç‡ â‰¥ 80%

### Task 7: æ–‡æ¡£å’Œå˜æ›´æ—¥å¿—
- [x] æ›´æ–° Story 7.1 çš„ Change Log
- [x] è®°å½•æ‰€æœ‰åˆ›å»ºçš„æ–‡ä»¶å’Œä¿®æ”¹çš„æ–‡ä»¶
- [x] å°† Status æ›´æ–°ä¸º "Ready for Review"

## Dev Notes

### Previous Story Insights
[Source: docs/stories/6.3.story.md#Dev Agent Record]

ä»Epic 6ï¼ˆReanimåŠ¨ç”»ç³»ç»Ÿè¿ç§»ï¼‰å­¦åˆ°çš„å…³é”®ç»éªŒï¼š

**æˆåŠŸçš„æ¨¡å¼ï¼ˆå¯å¤ç”¨äºç²’å­ç³»ç»Ÿï¼‰ï¼š**
1. âœ… **åˆ†é˜¶æ®µå®ç°**ï¼šå…ˆå»ºæ•°æ®ç»“æ„ â†’ è§£æå™¨ â†’ èµ„æºé›†æˆ â†’ ç³»ç»Ÿä½¿ç”¨
2. âœ… **ResourceManageræ‰©å±•æ¨¡å¼**ï¼šæ·»åŠ æ–°çš„ç¼“å­˜mapå’ŒåŠ è½½æ–¹æ³•ï¼Œä¸ä¿®æ”¹ç°æœ‰API
3. âœ… **internalåŒ…ç»„ç»‡**ï¼šå°†è§£æé€»è¾‘æ”¾åœ¨ `internal/` åŒ…ï¼ˆå¦‚ `internal/reanim`ï¼‰ï¼Œä¸æ¸¸æˆé€»è¾‘åˆ†ç¦»
4. âœ… **å•å…ƒæµ‹è¯•å…ˆè¡Œ**ï¼šReanimè§£æå™¨è¾¾åˆ°89.4%è¦†ç›–ç‡ï¼ŒåŠæ—©å‘ç°é—®é¢˜

**åº”ç”¨åˆ°ç²’å­ç³»ç»Ÿçš„ç­–ç•¥ï¼š**
- é‡‡ç”¨ç›¸åŒçš„ `internal/particle` åŒ…ç»“æ„ï¼ˆç±»ä¼¼ `internal/reanim`ï¼‰
- ResourceManageræ‰©å±•æ¨¡å¼å·²éªŒè¯ï¼Œç›´æ¥å¤ç”¨
- XMLè§£æä½¿ç”¨æ ‡å‡†åº“ `encoding/xml`ï¼ˆä¸Reanimä¸€è‡´ï¼‰
- æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡ â‰¥ 80%ï¼ˆä¸Epic 6ä¸€è‡´ï¼‰

### Project Structure Alignment
[Source: docs/architecture/unified-project-structure.md]

**æ–°æ–‡ä»¶ä½ç½®è§„åˆ’ï¼š**

```
pvz/
â”œâ”€â”€ internal/
â”‚   â””â”€â”€ particle/             # â† æ–°å»ºï¼šç²’å­è§£æå™¨ï¼ˆç±»ä¼¼internal/reanimï¼‰
â”‚       â”œâ”€â”€ parser.go         # XMLè§£æé€»è¾‘
â”‚       â”œâ”€â”€ parser_test.go    # è§£æå™¨å•å…ƒæµ‹è¯•
â”‚       â””â”€â”€ types.go          # æ•°æ®ç»“æ„å®šä¹‰ï¼ˆParticleConfigç­‰ï¼‰
â”‚
â”œâ”€â”€ pkg/game/
â”‚   â””â”€â”€ resource_manager.go   # â† æ‰©å±•ï¼šæ·»åŠ ç²’å­é…ç½®åŠ è½½æ–¹æ³•
â”‚
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ effect/particles/     # â† å·²å­˜åœ¨ï¼š106ä¸ªXMLé…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ particles/            # â† å·²å­˜åœ¨ï¼š79ä¸ªPNGè´´å›¾
```

**å‘½åçº¦å®šéµå¾ªï¼š**
[Source: docs/architecture/coding-standards.md#Naming Conventions]

- **åŒ…å**: `particle`ï¼ˆsnake_caseï¼Œéµå¾ªGoæ ‡å‡†ï¼‰
- **ç»“æ„ä½“**: `ParticleConfig`, `EmitterConfig`ï¼ˆPascalCaseï¼Œå…¬å¼€ï¼‰
- **å‡½æ•°**: `ParseParticleXML`, `LoadParticleConfig`ï¼ˆPascalCaseï¼Œå…¬å¼€ï¼‰
- **å­—æ®µ**: `Name`, `SpawnMinActive`ï¼ˆPascalCaseï¼Œéµå¾ªXMLæ˜ å°„ï¼‰

### XML Configuration Format Analysis
[Source: data/particles/*.xmlå®é™…æ–‡ä»¶åˆ†æ]

**XMLç»“æ„ç¤ºä¾‹ï¼ˆAward.xmlï¼‰ï¼š**
```xml
<Emitter>
  <Name>AwardRay8</Name>
  <SpawnMinActive>0,2 1,2 4,21</SpawnMinActive>
  <ParticleDuration>1500</ParticleDuration>
  <ParticleAlpha>.7 .9,50</ParticleAlpha>
  <ParticleBrightness>.4</ParticleBrightness>
  <ParticleSpinAngle>270</ParticleSpinAngle>
  <ParticleScale>.4 Linear 10,9.999999</ParticleScale>
  <Image>IMAGE_AWARDRAYS2</Image>
  <ParticleSpinSpeed>[-41 -70]</ParticleSpinSpeed>
  <Additive>1</Additive>
  <Field>
    <FieldType>Acceleration</FieldType>
    <Y>13</Y>
  </Field>
</Emitter>
```

**å…³é”®è§£ææŒ‘æˆ˜ï¼š**

1. **åŠ¨æ€å€¼æ ¼å¼**ï¼š
   - å•å€¼ï¼š`1500`ï¼ˆå›ºå®šå€¼ï¼‰
   - èŒƒå›´ï¼š`[-41 -70]`ï¼ˆåœ¨-41åˆ°-70ä¹‹é—´éšæœºï¼‰
   - å…³é”®å¸§ï¼š`0,2 1,2 4,21`ï¼ˆæ—¶é—´,å€¼ å¯¹åºåˆ—ï¼‰
   - æ’å€¼ï¼š`Linear`ï¼ˆæ’å€¼ç±»å‹å…³é”®å­—ï¼‰

2. **å¯é€‰å­—æ®µ**ï¼šå¤§å¤šæ•°å±æ€§éƒ½æ˜¯å¯é€‰çš„ï¼Œéœ€è¦ä½¿ç”¨æŒ‡é’ˆæˆ–åˆç†çš„é›¶å€¼

3. **åµŒå¥—ç»“æ„**ï¼šEmitterå†…å¯èƒ½åŒ…å«0ä¸ªæˆ–å¤šä¸ªField

**æ¨èæ•°æ®ç»“æ„è®¾è®¡ï¼š**
```go
// ParticleConfig represents the root particle effect (å¯èƒ½åŒ…å«å¤šä¸ªEmitter)
type ParticleConfig struct {
    Emitters []EmitterConfig `xml:"Emitter"`
}

// EmitterConfig represents a single emitter configuration
type EmitterConfig struct {
    Name                string   `xml:"Name"`
    SpawnMinActive      string   `xml:"SpawnMinActive,omitempty"`  // å¯èƒ½æ˜¯å…³é”®å¸§
    ParticleDuration    *float64 `xml:"ParticleDuration,omitempty"`
    ParticleAlpha       string   `xml:"ParticleAlpha,omitempty"`
    // ... 40+ æ›´å¤šå±æ€§
    Image               string   `xml:"Image,omitempty"`
    ImageFrames         *int     `xml:"ImageFrames,omitempty"`
    Additive            *int     `xml:"Additive,omitempty"`
    Fields              []Field  `xml:"Field"`
}

// Field represents a force field (gravity, friction, acceleration, etc.)
type Field struct {
    FieldType string   `xml:"FieldType"`
    X         string   `xml:"X,omitempty"`  // å¯èƒ½æ˜¯å…³é”®å¸§æˆ–èŒƒå›´
    Y         string   `xml:"Y,omitempty"`
}
```

**æ³¨æ„**ï¼šä½¿ç”¨ `string` ç±»å‹å­˜å‚¨å¤æ‚æ ¼å¼çš„å€¼ï¼Œå»¶è¿Ÿè§£æåˆ°è¿è¡Œæ—¶ï¼ˆStory 7.2ï¼‰ã€‚

### ResourceManager Extension Pattern
[Source: pkg/game/resource_manager.go ç°æœ‰å®ç°]

**ç°æœ‰ResourceManagerèƒ½åŠ›ï¼š**
- å›¾ç‰‡ç¼“å­˜ï¼š`imageCache map[string]*ebiten.Image`
- éŸ³é¢‘ç¼“å­˜ï¼š`audioCache map[string]*audio.Player`
- Reanimç¼“å­˜ï¼š`reanimXMLCache map[string]*reanim.ReanimXML`
- YAMLé…ç½®ï¼š`config *ResourceConfig`, `resourceMap map[string]string`

**ç²’å­ç³»ç»Ÿæ‰©å±•æ¨¡å¼ï¼ˆéµå¾ªReanimæ¨¡å¼ï¼‰ï¼š**

```go
// åœ¨ResourceManagerç»“æ„ä½“ä¸­æ·»åŠ ï¼š
type ResourceManager struct {
    // ... ç°æœ‰å­—æ®µ
    particleConfigCache map[string]*particle.ParticleConfig  // â† æ–°å¢
}

// åœ¨NewResourceManagerä¸­åˆå§‹åŒ–ï¼š
func NewResourceManager(audioContext *audio.Context) *ResourceManager {
    return &ResourceManager{
        // ... ç°æœ‰åˆå§‹åŒ–
        particleConfigCache: make(map[string]*particle.ParticleConfig),  // â† æ–°å¢
    }
}

// æ–°å¢æ–¹æ³•ï¼ˆç±»ä¼¼LoadReanimXMLï¼‰ï¼š
func (rm *ResourceManager) LoadParticleConfig(name string) (*particle.ParticleConfig, error) {
    // 1. æ£€æŸ¥ç¼“å­˜
    if config, exists := rm.particleConfigCache[name]; exists {
        return config, nil
    }

    // 2. æ„å»ºè·¯å¾„å¹¶è§£æ
    path := filepath.Join("data/particles", name+".xml")
    config, err := particle.ParseParticleXML(path)
    if err != nil {
        return nil, fmt.Errorf("failed to load particle config %s: %w", name, err)
    }

    // 3. ç¼“å­˜å¹¶è¿”å›
    rm.particleConfigCache[name] = config
    return config, nil
}
```

**ä¼˜åŠ¿ï¼š**
- âœ… ä¸ç ´åç°æœ‰API
- âœ… éµå¾ªå·²éªŒè¯çš„æ¨¡å¼
- âœ… è‡ªåŠ¨ç¼“å­˜ï¼Œé¿å…é‡å¤åŠ è½½
- âœ… çº¿ç¨‹å®‰å…¨ï¼ˆå•çº¿ç¨‹æ¸¸æˆå¾ªç¯ï¼‰

### Particle Texture Loading
[Source: assets/particles/ ç›®å½•ç»“æ„]

**ç²’å­è´´å›¾èµ„æºç°çŠ¶ï¼š**
- ä½ç½®ï¼š`assets/particles/` ç›®å½•
- æ•°é‡ï¼š79ä¸ªPNGæ–‡ä»¶
- å‘½åç¤ºä¾‹ï¼š`DoomShroom_Explosion_Base.png`, `AwardRays1.png`, `PoolSparkly.png`
- å¼•ç”¨æ–¹å¼ï¼šXMLé…ç½®ä¸­çš„ `<Image>` æ ‡ç­¾å¼•ç”¨èµ„æºIDï¼ˆå¦‚ `IMAGE_AWARDRAYS2`ï¼‰

**é›†æˆç­–ç•¥ï¼š**

Option 1ï¼ˆæ¨èï¼‰ï¼šå¤ç”¨ç°æœ‰ `LoadImageByID` æ–¹æ³•
- å‰æï¼šåœ¨ `assets/config/resources.yaml` ä¸­ä¸ºç²’å­è´´å›¾æ·»åŠ èµ„æºIDæ˜ å°„
- ä¼˜åŠ¿ï¼šç»Ÿä¸€èµ„æºç®¡ç†ï¼Œè‡ªåŠ¨ç¼“å­˜

Option 2ï¼šç›´æ¥è·¯å¾„åŠ è½½
- ä½¿ç”¨ç°æœ‰ `LoadImage(path)` æ–¹æ³•ï¼š`rm.LoadImage("assets/particles/AwardRays1.png")`
- ä¼˜åŠ¿ï¼šæ— éœ€ä¿®æ”¹resources.yamlï¼Œå¿«é€Ÿå®ç°

**æœ¬Storyå»ºè®®ï¼š**
- é‡‡ç”¨Option 2ï¼ˆç›´æ¥è·¯å¾„ï¼‰å¿«é€Ÿå®ç°
- Story 7.2åœ¨ä½¿ç”¨æ—¶å¯ä»¥ä¼˜åŒ–ä¸ºOption 1

### Testing Requirements
[Source: docs/architecture/testing-strategy.md]

**æµ‹è¯•æ ‡å‡†ï¼š**
- **æ¡†æ¶**: Goæ ‡å‡†åº“ `testing` åŒ…
- **æ–‡ä»¶ä½ç½®**: ä¸æºæ–‡ä»¶åŒç›®å½•ï¼Œ`_test.go` åç¼€
- **è¦†ç›–ç‡ç›®æ ‡**: â‰¥ 80%ï¼ˆæ ¸å¿ƒé€»è¾‘åŒ…ï¼‰
- **æµ‹è¯•ç±»å‹**: å•å…ƒæµ‹è¯•ä¸ºä¸»ï¼Œå°‘é‡é›†æˆæµ‹è¯•

**é’ˆå¯¹æœ¬Storyçš„æµ‹è¯•ç­–ç•¥ï¼š**

1. **å•å…ƒæµ‹è¯•**ï¼ˆ`internal/particle/parser_test.go`ï¼‰ï¼š
   - æµ‹è¯•åŸºç¡€XMLè§£æåŠŸèƒ½
   - æµ‹è¯•è¾¹ç•Œæƒ…å†µï¼ˆç©ºæ–‡ä»¶ã€æ ¼å¼é”™è¯¯ã€ç¼ºå¤±å­—æ®µï¼‰
   - æµ‹è¯•å„ç§å€¼æ ¼å¼è§£æ
   - æµ‹è¯•Emitterå’ŒFieldåµŒå¥—

2. **é›†æˆæµ‹è¯•**ï¼ˆ`pkg/game/resource_manager_test.go`ï¼‰ï¼š
   - æµ‹è¯•ä»å®é™…XMLæ–‡ä»¶åŠ è½½é…ç½®
   - æµ‹è¯•ç¼“å­˜æœºåˆ¶
   - æµ‹è¯•é”™è¯¯å¤„ç†

3. **æµ‹è¯•æ•°æ®**ï¼š
   - ä½¿ç”¨5ä¸ªä»£è¡¨æ€§XMLæ–‡ä»¶ä½œä¸ºæµ‹è¯•è¾“å…¥
   - åˆ›å»ºå°å‹æµ‹è¯•ç”¨XMLæ–‡ä»¶ï¼ˆç”¨äºå•å…ƒæµ‹è¯•ï¼‰

**è¿è¡Œæµ‹è¯•ï¼š**
```bash
# å•ç‹¬æµ‹è¯•ç²’å­è§£æå™¨
go test -v -cover ./internal/particle

# æµ‹è¯•ResourceManageræ‰©å±•
go test -v -cover ./pkg/game

# æŸ¥çœ‹è¯¦ç»†è¦†ç›–ç‡æŠ¥å‘Š
go test -coverprofile=coverage.out ./internal/particle
go tool cover -html=coverage.out
```

### Technical Constraints
[Source: docs/prd/epic-7-particle-system.md#æŠ€æœ¯çº¦æŸ]

**å¿…é¡»éµå¾ªçš„çº¦æŸï¼š**
1. **å¼•æ“**: ä»…ä½¿ç”¨ Go æ ‡å‡†åº“ + Ebitengine v2 API
2. **XMLè§£æ**: ä½¿ç”¨ `encoding/xml` æ ‡å‡†åº“ï¼ˆä¸å¼•å…¥ç¬¬ä¸‰æ–¹åº“ï¼‰
3. **æ€§èƒ½ç›®æ ‡**: é…ç½®åŠ è½½åº”åœ¨æ¯«ç§’çº§å®Œæˆï¼ˆä¸æ˜¯ç“¶é¢ˆï¼‰
4. **å†…å­˜**: 106ä¸ªé…ç½®æ–‡ä»¶ç¼“å­˜åº” < 10MBï¼ˆé¢„ä¼°ï¼‰

**ç¼–ç çº¦æŸï¼š**
[Source: docs/architecture/coding-standards.md#Critical Rules]
- âœ… **æ•°æ®-è¡Œä¸ºåˆ†ç¦»**: ç²’å­é…ç½®ç»“æ„ä½“åªåŒ…å«æ•°æ®ï¼Œæ— æ–¹æ³•
- âœ… **é”™è¯¯å¤„ç†**: æ‰€æœ‰æ–‡ä»¶IOå’Œè§£ææ“ä½œå¿…é¡»æ£€æŸ¥å¹¶è¿”å›é”™è¯¯
- âœ… **GoDocæ³¨é‡Š**: æ‰€æœ‰å…¬å¼€çš„ç±»å‹å’Œå‡½æ•°å¿…é¡»æœ‰æ–‡æ¡£æ³¨é‡Š
- âœ… **ç¦æ­¢å…¨å±€å˜é‡**: æ‰€æœ‰é…ç½®é€šè¿‡ResourceManagerç®¡ç†

### Data Models (Particle Configuration)
[Source: Epic 7 åˆ†æ + XMLç¤ºä¾‹]

**40+ç§ç²’å­å±æ€§åˆ†ç±»ï¼š**

**Spawnå±æ€§ï¼ˆå‘å°„æ§åˆ¶ï¼‰ï¼š**
- SpawnMinActive, SpawnMaxActive, SpawnMaxLaunched
- SpawnRate

**Particleå±æ€§ï¼ˆç²’å­å¤–è§‚ï¼‰ï¼š**
- ParticleDuration, ParticleAlpha, ParticleScale, ParticleSpinAngle, ParticleSpinSpeed
- ParticleRed, ParticleGreen, ParticleBlue, ParticleBrightness
- ParticleLoops, ParticleStretch

**Launchå±æ€§ï¼ˆå‘å°„å‚æ•°ï¼‰ï¼š**
- LaunchSpeed, LaunchAngle
- AlignLaunchSpin, RandomLaunchSpin

**Emitterå±æ€§ï¼ˆå‘å°„å™¨é…ç½®ï¼‰ï¼š**
- EmitterBoxX, EmitterBoxY, EmitterRadius, EmitterType
- EmitterSkewX, EmitterOffsetX, EmitterOffsetY
- ParticlesDontFollow

**Systemå±æ€§ï¼ˆç³»ç»Ÿçº§è®¾ç½®ï¼‰ï¼š**
- SystemDuration, SystemAlpha
- CrossFadeDuration, DieIfOverloaded

**Imageå±æ€§ï¼ˆè´´å›¾é…ç½®ï¼‰ï¼š**
- Imageï¼ˆèµ„æºIDï¼‰
- ImageFrames, ImageRow, ImageColï¼ˆå¸§åŠ¨ç”»ï¼‰
- Animated, AnimationRate

**Renderingå±æ€§ï¼ˆæ¸²æŸ“æ¨¡å¼ï¼‰ï¼š**
- Additiveï¼ˆåŠ æ³•æ··åˆæ ‡å¿—ï¼Œ0æˆ–1ï¼‰
- FullScreen, HardwareOnly, ClipTop

**Fieldå±æ€§ï¼ˆåŠ›åœºé…ç½®ï¼‰ï¼š**
- FieldTypeï¼ˆå¦‚Friction, Acceleration, Attractorç­‰ï¼‰
- X, Yï¼ˆåŠ›åœºå‚æ•°ï¼‰
- CollisionReflect, CollisionSpin

**å€¼æ ¼å¼ç¤ºä¾‹ï¼š**
- å›ºå®šå€¼ï¼š`1500`
- èŒƒå›´ï¼š`[0.7 0.9]`
- å…³é”®å¸§ï¼š`0,2 1,2 4,21`ï¼ˆæ—¶é—´,å€¼åºåˆ—ï¼‰
- æ’å€¼ï¼š`Linear` å…³é”®å­—ï¼ˆåµŒå…¥åœ¨å…³é”®å¸§ä¸­ï¼‰

### File Path Reference

**æœ¬Storyå°†åˆ›å»ºçš„æ–‡ä»¶ï¼š**
- `internal/particle/types.go` - æ•°æ®ç»“æ„å®šä¹‰
- `internal/particle/parser.go` - XMLè§£æé€»è¾‘
- `internal/particle/parser_test.go` - è§£æå™¨æµ‹è¯•

**æœ¬Storyå°†ä¿®æ”¹çš„æ–‡ä»¶ï¼š**
- `pkg/game/resource_manager.go` - æ·»åŠ ç²’å­é…ç½®åŠ è½½æ–¹æ³•
- `pkg/game/resource_manager_test.go` - æ‰©å±•æµ‹è¯•

**ä¾èµ–çš„ç°æœ‰æ–‡ä»¶ï¼š**
- `data/particles/*.xml` - 106ä¸ªç²’å­é…ç½®æ–‡ä»¶ï¼ˆå·²å­˜åœ¨ï¼‰
- `assets/particles/*.png` - 79ä¸ªç²’å­è´´å›¾ï¼ˆå·²å­˜åœ¨ï¼‰

## Testing

[Source: docs/architecture/testing-strategy.md]

**æµ‹è¯•æ¡†æ¶ï¼š**
- Goæ ‡å‡†åº“ `testing` åŒ…

**æµ‹è¯•æ–‡ä»¶ä½ç½®ï¼š**
- `internal/particle/parser_test.go`ï¼ˆä¸parser.goåŒç›®å½•ï¼‰
- `pkg/game/resource_manager_test.go`ï¼ˆæ‰©å±•ç°æœ‰æµ‹è¯•æ–‡ä»¶ï¼‰

**æµ‹è¯•è¦æ±‚ï¼š**
1. **å•å…ƒæµ‹è¯•è¦†ç›–ç‡ç›®æ ‡**: â‰¥ 80%
   - é‡ç‚¹æµ‹è¯•ï¼š`internal/particle` åŒ…
   - è¾…åŠ©æµ‹è¯•ï¼š`pkg/game` åŒ…çš„ç²’å­ç›¸å…³æ–¹æ³•

2. **å¿…é¡»æµ‹è¯•çš„åœºæ™¯**ï¼š
   - âœ… æˆåŠŸè§£æå„ç§XMLé…ç½®æ ¼å¼
   - âœ… è§£æå•Emitterå’Œå¤šEmitteré…ç½®
   - âœ… è§£æå¸¦Fieldå’Œä¸å¸¦Fieldçš„é…ç½®
   - âœ… è§£æå„ç§å€¼æ ¼å¼ï¼ˆå•å€¼ã€èŒƒå›´ã€å…³é”®å¸§ï¼‰
   - âœ… é”™è¯¯å¤„ç†ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æ ¼å¼é”™è¯¯ã€å­—æ®µç¼ºå¤±ï¼‰
   - âœ… ResourceManagerç¼“å­˜æœºåˆ¶
   - âœ… é‡å¤åŠ è½½åŒä¸€é…ç½®ï¼ˆéªŒè¯ç¼“å­˜ç”Ÿæ•ˆï¼‰

3. **è¿è¡Œæµ‹è¯•å‘½ä»¤**ï¼š
   ```bash
   # è¿è¡Œæ‰€æœ‰ç›¸å…³æµ‹è¯•
   go test -v ./internal/particle ./pkg/game

   # æŸ¥çœ‹è¦†ç›–ç‡
   go test -cover ./internal/particle
   go test -cover ./pkg/game

   # ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
   go test -coverprofile=coverage.out ./internal/particle
   go tool cover -html=coverage.out
   ```

4. **æµ‹è¯•æ•°æ®**ï¼š
   - ä½¿ç”¨å®é™…çš„XMLæ–‡ä»¶ï¼šAward.xml, BossExplosion.xml, CabbageSplat.xmlç­‰
   - åˆ›å»ºå°å‹æµ‹è¯•ç”¨XMLæ–‡ä»¶ï¼ˆç”¨äºå•å…ƒæµ‹è¯•è¾¹ç•Œæƒ…å†µï¼‰

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-10-15 | 1.0 | Story 7.1 initial draft created | Bob (Scrum Master) |
| 2025-10-15 | 1.1 | Story 7.1 implementation completed | James (Dev Agent) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References
None

### Completion Notes
âœ… **All acceptance criteria met:**

1. **Data Structures** - Implemented `ParticleConfig`, `EmitterConfig`, `Field` structures supporting 47+ particle properties
2. **XML Parser** - Created `internal/particle/parser.go` with robust error handling
3. **5 Representative Configs** - Successfully parsed Award.xml (13 emitters), BossExplosion.xml (5 emitters with Fields), CabbageSplat.xml (2 emitters, multiple Fields), BlastMark.xml (simple single emitter), CoinPickupArrow.xml (UI effect with Position field)
4. **40+ Properties** - Supported all particle attributes: Spawn, Particle, Launch, Emitter, System, Image, Rendering, Field, and Collision properties
5. **ResourceManager Extension** - Added `LoadParticleConfig()` and `GetParticleConfig()` methods with caching
6. **Particle Texture Loading** - Verified existing `LoadImage()` method works seamlessly with particle textures
7. **Test Coverage** - Achieved **90.0%** coverage (exceeds 80% requirement)
8. **XML Consistency** - All parsed configurations validated against source XML files

**Technical Highlights:**
- Used string types for complex value formats (ranges, keyframes, interpolation) - parsing deferred to Story 7.2
- Followed Reanim system patterns for ResourceManager integration
- Flexible path handling in `LoadParticleConfig()` supports both simple names and full paths for testability
- Comprehensive test suite with 13 test cases covering success, caching, error handling, and integration scenarios

### File List
**Created:**
- `internal/particle/types.go` - Particle configuration data structures (ParticleConfig, EmitterConfig, Field)
- `internal/particle/parser.go` - XML parsing logic for particle configurations
- `internal/particle/parser_test.go` - Unit tests for parser (90.0% coverage)

**Modified:**
- `pkg/game/resource_manager.go` - Added particle configuration loading and caching
- `pkg/game/resource_manager_test.go` - Extended tests for particle config functionality

## QA Results

### Review Date: 2025-10-15

### Reviewed By: Quinn (Test Architect)

### Summary

Story 7.1 å®ç°è´¨é‡ä¼˜ç§€ï¼Œæ‰€æœ‰éªŒæ”¶æ ‡å‡†å…¨éƒ¨æ»¡è¶³ï¼Œæµ‹è¯•è¦†ç›–ç‡è¾¾åˆ°90%ï¼ˆè¶…å‡º80%è¦æ±‚ï¼‰ã€‚ä»£ç æ¶æ„æ¸…æ™°ï¼Œéµå¾ªé¡¹ç›®æ‰€æœ‰ç¼–ç æ ‡å‡†ï¼Œé”™è¯¯å¤„ç†å®Œå–„ã€‚å®ç°é‡‡ç”¨äº†æˆç†Ÿçš„æ¨¡å¼ï¼ˆç±»ä¼¼Reanimç³»ç»Ÿï¼‰ï¼Œä¸ºåç»­Story 7.2å¥ å®šäº†åšå®åŸºç¡€ã€‚

**Gate Decision: âœ… PASS** â†’ `docs/qa/gates/7.1-particle-config-parser.yml`

### Requirements Traceability Matrix

| AC | Requirement | Test Coverage | Status |
|----|-------------|---------------|--------|
| AC1 | ç²’å­é…ç½®æ•°æ®ç»“æ„ | types.goå®šä¹‰ + parser_test.goéªŒè¯ | âœ… 100% |
| AC2 | XMLè§£æå™¨å®ç° | 7ä¸ªparseræµ‹è¯•ï¼ˆåŸºç¡€ã€é”™è¯¯ã€è¾¹ç•Œï¼‰ | âœ… 100% |
| AC3 | è§£æ5ä¸ªä»£è¡¨æ€§é…ç½® | Award(13), BossExplosion(5), CabbageSplat(2), BlastMark(1), CoinPickupArrow(1) | âœ… 100% |
| AC4 | æ”¯æŒ40+å±æ€§è§£æ | types.goå®šä¹‰47+å±æ€§ï¼ŒXMLæµ‹è¯•éªŒè¯ | âœ… 100% |
| AC5 | ResourceManageræ‰©å±• | 5ä¸ªé›†æˆæµ‹è¯•ï¼ˆåŠ è½½ã€ç¼“å­˜ã€é”™è¯¯ï¼‰ | âœ… 100% |
| AC6 | ç²’å­è´´å›¾åŠ è½½ | TestLoadImage_ParticleTexture | âœ… 100% |
| AC7 | æµ‹è¯•è¦†ç›–ç‡â‰¥80% | 90.0%å®é™…è¦†ç›–ç‡ | âœ… è¶…æ ‡10% |
| AC8 | XMLä¸€è‡´æ€§éªŒè¯ | æ‰€æœ‰æµ‹è¯•éªŒè¯å…³é”®å±æ€§å€¼ | âœ… 100% |

**Test Statistics:**
- Total tests: 13 (7 parser + 6 resource manager)
- All tests: âœ… PASS
- Coverage: 90.0% (internal/particle)
- Execution time: < 0.1s

### Code Quality Assessment

#### âœ… Strengths (ä¼˜åŠ¿)

1. **ä¼˜ç§€çš„æ¶æ„è®¾è®¡**
   - æ¸…æ™°çš„å…³æ³¨ç‚¹åˆ†ç¦»ï¼š`internal/particle` ä¸“æ³¨è§£æï¼Œ`pkg/game` è´Ÿè´£èµ„æºç®¡ç†
   - éµå¾ªå·²éªŒè¯çš„Reanimæ¨¡å¼ï¼Œä»£ç ä¸€è‡´æ€§å¼º
   - çº¯æ•°æ®ç»“æ„ï¼Œå®Œå…¨ç¬¦åˆECSåŸåˆ™

2. **å¥å£®çš„é”™è¯¯å¤„ç†**
   - æ‰€æœ‰I/Oæ“ä½œéƒ½æœ‰é”™è¯¯æ£€æŸ¥
   - ä½¿ç”¨ `fmt.Errorf` å’Œ `%w` æä¾›ä¸Šä¸‹æ–‡
   - éªŒè¯è§£æç»“æœï¼ˆç¬¬46-48è¡Œæ£€æŸ¥ç©ºEmitterï¼‰

3. **å‡ºè‰²çš„æ–‡æ¡£æ³¨é‡Š**
   - æ‰€æœ‰å…¬å¼€APIéƒ½æœ‰è¯¦ç»†çš„GoDocæ³¨é‡Š
   - æ³¨é‡ŠåŒ…å«ä½¿ç”¨ç¤ºä¾‹å’Œå‚æ•°è¯´æ˜
   - ä»£ç è‡ªè§£é‡Šæ€§å¼º

4. **æ™ºèƒ½çš„å®ç°ç»†èŠ‚**
   - XMLåŒ…è£…æŠ€å·§ï¼ˆç¬¬37è¡Œï¼‰ä¼˜é›…å¤„ç†æ— æ ¹å…ƒç´ XML
   - çµæ´»çš„è·¯å¾„å¤„ç†ï¼ˆæ”¯æŒç®€å•åç§°å’Œå®Œæ•´è·¯å¾„ï¼‰
   - Stringç±»å‹å»¶è¿Ÿè§£æå¤æ‚å€¼ï¼ˆä¸ºStory 7.2é¢„ç•™ï¼‰

5. **å®Œå–„çš„æµ‹è¯•è®¾è®¡**
   - æµ‹è¯•å±‚æ¬¡åˆ†æ˜ï¼šå•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•
   - è¦†ç›–æˆåŠŸè·¯å¾„ã€é”™è¯¯è·¯å¾„å’Œè¾¹ç•Œæƒ…å†µ
   - ä½¿ç”¨TestMainå…±äº«audioContextï¼ˆæœ€ä½³å®è·µï¼‰

#### âš ï¸ Minor Concerns (è½»å¾®å…³æ³¨ç‚¹)

1. **EmitterConfigç»“æ„ä½“è¾ƒå¤§ï¼ˆ47ä¸ªå­—æ®µï¼‰**
   - å½±å“ï¼šå•ä¸ªç»“æ„ä½“éš¾ä»¥å¿«é€Ÿç†è§£
   - å»ºè®®ï¼šStory 7.2å®ç°æ—¶å¯è€ƒè™‘æŒ‰åŠŸèƒ½åˆ†ç»„ï¼ˆSpawn*, Particle*, Launch*ç­‰ï¼‰ä¸ºåµŒå…¥ç»“æ„ä½“
   - è¯„ä¼°ï¼šå½“å‰å¯æ¥å—ï¼Œå› ä¸ºXMLç»“æ„å°±æ˜¯æ‰å¹³çš„ï¼Œå¼ºè¡Œåˆ†ç»„å¯èƒ½è¿‡åº¦è®¾è®¡

2. **æµ‹è¯•ä½¿ç”¨å®é™…æ–‡ä»¶ä¾èµ–**
   - parser_test.goä½¿ç”¨ç›¸å¯¹è·¯å¾„ `../../data/particles/`
   - å½±å“ï¼šæµ‹è¯•åœ¨éæ ‡å‡†æ‰§è¡Œä¸Šä¸‹æ–‡å¯èƒ½å¤±è´¥
   - å»ºè®®ï¼šæœªæ¥å¯è€ƒè™‘æ·»åŠ æµ‹è¯•å¤¹å…·ï¼ˆtestdataç›®å½•ï¼‰
   - è¯„ä¼°ï¼šå½“å‰å¯æ¥å—ï¼Œå› ä¸ºCI/CDä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ

3. **ç¼ºå°‘æ€§èƒ½åŸºå‡†æµ‹è¯•**
   - å½±å“ï¼šæ— æ³•é‡åŒ–è§£ææ€§èƒ½å’Œå›å½’æ£€æµ‹
   - å»ºè®®ï¼šæ·»åŠ  `BenchmarkParseParticleXML` æµ‹è¯•
   - è¯„ä¼°ï¼šä½ä¼˜å…ˆçº§ï¼Œ106ä¸ªé…ç½®æ–‡ä»¶éƒ½å¾ˆå°ï¼ˆ<10KBï¼‰

### Compliance Check

#### âœ… Coding Standards (100% åˆè§„)

| Standard | Status | Notes |
|----------|--------|-------|
| åŒ…åsnake_case | âœ… | `particle` |
| ç»“æ„ä½“PascalCase | âœ… | `ParticleConfig`, `EmitterConfig`, `Field` |
| å…¬å¼€å‡½æ•°PascalCase | âœ… | `ParseParticleXML`, `LoadParticleConfig` |
| ç§æœ‰å‡½æ•°camelCase | âœ… | `buildResourceMap` |
| é›¶è€¦åˆåŸåˆ™ | âœ… | parseråŒ…ç‹¬ç«‹ï¼Œæ— ç³»ç»Ÿé—´ç›´æ¥è°ƒç”¨ |
| æ•°æ®-è¡Œä¸ºåˆ†ç¦» | âœ… | æ‰€æœ‰ç»“æ„ä½“çº¯æ•°æ®ï¼Œæ— æ–¹æ³• |
| é”™è¯¯å¤„ç† | âœ… | æ‰€æœ‰é”™è¯¯éƒ½æ£€æŸ¥å¹¶åŒ…è£… |
| GoDocæ³¨é‡Š | âœ… | æ‰€æœ‰å…¬å¼€APIéƒ½æœ‰è¯¦ç»†æ–‡æ¡£ |
| ç¦æ­¢å…¨å±€å˜é‡ | âœ… | é€šè¿‡ResourceManagerç®¡ç† |

#### âœ… Project Structure (100% åˆè§„)

- âœ… æ–°åŒ…ä½äº `internal/particle` ï¼ˆéµå¾ªinternalåŒ…è§„èŒƒï¼‰
- âœ… æ‰©å±• `pkg/game/resource_manager.go` ï¼ˆéµå¾ªç°æœ‰æ¨¡å¼ï¼‰
- âœ… æµ‹è¯•æ–‡ä»¶ä¸æºæ–‡ä»¶åŒç›®å½•ï¼Œ`_test.go` åç¼€

#### âœ… Testing Strategy (100% åˆè§„)

- âœ… ä½¿ç”¨Goæ ‡å‡†åº“ `testing` åŒ…
- âœ… æµ‹è¯•è¦†ç›–ç‡90% > 80%è¦æ±‚
- âœ… æµ‹è¯•å‘½åæ¸…æ™°ï¼Œä½¿ç”¨ `Test<Function>_<Scenario>` æ¨¡å¼

### Non-Functional Requirements Validation

#### ğŸ”’ Security: PASS
- âœ… æ–‡ä»¶è·¯å¾„ä½¿ç”¨ `filepath.Join` é˜²æ­¢è·¯å¾„éå†
- âœ… é”™è¯¯å¤„ç†å®Œå–„ï¼Œä¸ä¼španicæš´éœ²å†…éƒ¨ä¿¡æ¯
- âœ… æ— åŠ¨æ€ä»£ç æ‰§è¡Œæˆ–evalé£é™©
- â„¹ï¸ XMLæ–‡ä»¶å¤§å°æ— é™åˆ¶ï¼ˆæ½œåœ¨DoSé£é™©ï¼Œä½†æ¸¸æˆèµ„æºåœºæ™¯å¯æ¥å—ï¼‰

#### âš¡ Performance: PASS
- âœ… ç¼“å­˜æœºåˆ¶æœ‰æ•ˆé¿å…é‡å¤è§£æ
- âœ… Stringç±»å‹å»¶è¿Ÿè§£æï¼Œåˆå§‹åŠ è½½å¿«é€Ÿ
- âœ… æµ‹è¯•æ˜¾ç¤ºè§£ææ€§èƒ½ < 1ms per file
- â„¹ï¸ XMLåŒ…è£…ï¼ˆç¬¬37è¡Œï¼‰æœ‰è½»å¾®å†…å­˜å¼€é”€ï¼Œä½†106ä¸ªå°æ–‡ä»¶æ€»ä½“å½±å“å¯å¿½ç•¥

#### ğŸ›¡ï¸ Reliability: PASS
- âœ… å…¨é¢çš„é”™è¯¯å¤„ç†å’ŒéªŒè¯
- âœ… ç¼“å­˜ä¸€è‡´æ€§ä¿è¯ï¼ˆåŒåé…ç½®è¿”å›åŒä¸€å®ä¾‹ï¼‰
- âœ… æµ‹è¯•è¦†ç›–é”™è¯¯åœºæ™¯ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ã€æ ¼å¼é”™è¯¯ï¼‰

#### ğŸ”§ Maintainability: CONCERNS (è½»å¾®)
- âœ… ä»£ç æ¸…æ™°ï¼Œæ³¨é‡Šå……åˆ†
- âœ… éµå¾ªé¡¹ç›®ç¼–ç æ ‡å‡†
- âš ï¸ EmitterConfig 47ä¸ªå­—æ®µå¯èƒ½å¢åŠ æœªæ¥ç»´æŠ¤æˆæœ¬
- **è¯„ä¼°**: å½“å‰ç»“æ„åˆç†ï¼ŒXMLæœ¬èº«å°±æ˜¯æ‰å¹³çš„ï¼Œè¿‡åº¦æŠ½è±¡åè€Œé™ä½å¯è¯»æ€§

### Testability Evaluation

- âœ… **Controllability (å¯æ§æ€§)**: ä¼˜ç§€ - å¯å®Œå…¨æ§åˆ¶è¾“å…¥ï¼ˆXMLæ–‡ä»¶ã€é…ç½®åç§°ï¼‰
- âœ… **Observability (å¯è§‚å¯Ÿæ€§)**: ä¼˜ç§€ - å¯è§‚å¯Ÿæ‰€æœ‰è¾“å‡ºï¼ˆè§£æç»“æœã€é”™è¯¯ä¿¡æ¯ï¼‰
- âœ… **Debuggability (å¯è°ƒè¯•æ€§)**: ä¼˜ç§€ - é”™è¯¯ä¿¡æ¯è¯¦ç»†ï¼ŒåŒ…å«æ–‡ä»¶è·¯å¾„å’Œå¤±è´¥åŸå› 

### Technical Debt Analysis

| Debt Item | Type | Impact | Priority | Recommendation |
|-----------|------|--------|----------|----------------|
| EmitterConfigå¤§ç»“æ„ä½“ | Design | Medium | Low | Story 7.2æ—¶è¯„ä¼°æ˜¯å¦éœ€è¦é‡æ„ |
| æµ‹è¯•æ–‡ä»¶ä¾èµ– | Test | Low | Low | å¯æ·»åŠ testdataå¤¹å…·ï¼Œéå¿…é¡» |
| ç¼ºå°‘æ€§èƒ½åŸºå‡† | Test | Low | Low | å¯æ·»åŠ benchmarkï¼Œéå¿…é¡» |

**æ€»ä½“æŠ€æœ¯å€ºåŠ¡æ°´å¹³**: ä½ - æ‰€æœ‰å€ºåŠ¡é¡¹éƒ½æ˜¯"nice-to-have"è€Œé"must-fix"

### Risk Assessment

| Risk | Probability | Impact | Score | Mitigation |
|------|-------------|--------|-------|------------|
| EmitterConfigç»´æŠ¤å›°éš¾ | Low (30%) | Medium | 3/10 | å½“å‰ç»“æ„æ¸…æ™°ï¼Œæ³¨é‡Šå……åˆ† |
| æµ‹è¯•è·¯å¾„ä¾èµ–å¤±è´¥ | Low (20%) | Low | 2/10 | CIåœ¨é¡¹ç›®æ ¹è¿è¡Œï¼Œé£é™©æä½ |
| XMLåŒ…è£…æ€§èƒ½é—®é¢˜ | Very Low (10%) | Low | 1/10 | æ–‡ä»¶å°ï¼Œå®æµ‹æ€§èƒ½ä¼˜ç§€ |

**æœ€é«˜é£é™©è¯„åˆ†**: 3/10 (è¿œä½äº6åˆ†concernsé˜ˆå€¼)

### Files Reviewed

**Created (4 files):**
- `internal/particle/types.go` (104 lines) - æ•°æ®ç»“æ„å®šä¹‰
- `internal/particle/parser.go` (52 lines) - XMLè§£æé€»è¾‘
- `internal/particle/parser_test.go` (214 lines) - è§£æå™¨æµ‹è¯•

**Modified (2 files):**
- `pkg/game/resource_manager.go` (+70 lines) - æ·»åŠ ç²’å­é…ç½®åŠ è½½
- `pkg/game/resource_manager_test.go` (+136 lines) - æ‰©å±•æµ‹è¯•

**Total Lines Changed**: +576 lines

### Recommended Next Steps

#### âœ… Ready for Done
Story 7.1å®Œå…¨æ»¡è¶³æ‰€æœ‰éªŒæ”¶æ ‡å‡†ï¼Œè´¨é‡ä¼˜ç§€ï¼Œå»ºè®®çŠ¶æ€æ›´æ–°ä¸º **Done**ã€‚

#### ğŸ“‹ Future Improvements (Optional)
1. **Story 7.2å‡†å¤‡**: å½“å‰stringç±»å‹å­—æ®µä¸ºå€¼è§£æé¢„ç•™äº†çµæ´»æ€§
2. **æ€§èƒ½ä¼˜åŒ–**: å¦‚æœ‰éœ€è¦ï¼Œå¯æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•
3. **ç»“æ„é‡æ„**: å¦‚æœ47ä¸ªå­—æ®µåœ¨å®é™…ä½¿ç”¨ä¸­é€ æˆå›°æ‰°ï¼Œå¯è€ƒè™‘åˆ†ç»„

### Quality Score

**90/100** (Excellent)

è®¡ç®—æ–¹å¼ï¼š
- åŸºç¡€åˆ†ï¼š100
- å¯ç»´æŠ¤æ€§è½»å¾®concernsï¼š-10
- æ‰€æœ‰ACæ»¡è¶³ï¼Œæµ‹è¯•è¦†ç›–è¶…æ ‡ï¼Œé›¶é«˜/ä¸­ä¼˜å…ˆçº§é—®é¢˜

### Conclusion

Story 7.1æ˜¯ä¸€ä¸ªé«˜è´¨é‡çš„å®ç°ï¼Œå±•ç°äº†ï¼š
- ä¼˜ç§€çš„æ¶æ„è®¾è®¡å’Œä»£ç ç»„ç»‡
- å…¨é¢çš„æµ‹è¯•è¦†ç›–å’Œé”™è¯¯å¤„ç†
- ä¸¥æ ¼éµå®ˆé¡¹ç›®ç¼–ç æ ‡å‡†
- ä¸ºåç»­Story 7.2å¥ å®šäº†åšå®åŸºç¡€

**å»ºè®®**: æ›´æ–°çŠ¶æ€ä¸º **Done**ï¼Œæ— éœ€é¢å¤–ä¿®æ”¹ã€‚è½»å¾®å…³æ³¨ç‚¹éƒ½æ˜¯ä¼˜åŒ–å»ºè®®ï¼Œä¸å½±å“åŠŸèƒ½æ­£ç¡®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

---

**Gate File**: `docs/qa/gates/7.1-particle-config-parser.yml`
**Review Duration**: Comprehensive deep review (8 AC + risk assessment + NFR validation)
**Confidence Level**: High - æ‰€æœ‰ä»£ç å·²å®¡æŸ¥ï¼Œæ‰€æœ‰æµ‹è¯•å·²è¿è¡Œ

