# Story 6.10: å›å½’æµ‹è¯•ä¸æ–‡æ¡£æ›´æ–° (Regression Testing & Documentation Update)

## Status
Ready

## Story

**As a** å¼€å‘è€…,
**I want** to perform comprehensive regression testing and update all documentation,
**so that** the animation system refactor is stable, well-documented, and ready for production.

## Background

åœ¨å®Œæˆ Story 6.8ï¼ˆç»Ÿä¸€ä¸º Anims + GlobalFrameï¼‰å’Œ Story 6.9ï¼ˆå®ç°å¤šåŠ¨ç”»å åŠ  APIï¼‰åï¼Œéœ€è¦ï¼š

1. **å…¨é¢å›å½’æµ‹è¯•**ï¼šç¡®ä¿é‡æ„æ²¡æœ‰ç ´åä»»ä½•ç°æœ‰åŠŸèƒ½
2. **æ€§èƒ½éªŒè¯**ï¼šç¡®è®¤æ€§èƒ½æ— é€€åŒ–ï¼ˆFPS â‰¥ 60ï¼‰
3. **æ–‡æ¡£æ›´æ–°**ï¼šæ›´æ–° CLAUDE.md å’Œç›¸å…³æ–‡æ¡£ï¼Œåæ˜ æ–°çš„æ¶æ„
4. **æ ‡è®°åºŸå¼ƒ**ï¼šæ ‡è®° Story 6.6/6.7 ä¸º Superseded

## Acceptance Criteria

### AC1: æ‰€æœ‰åŠ¨ç”»é€šè¿‡å›å½’æµ‹è¯•
- **Given**: é‡æ„åçš„åŠ¨ç”»ç³»ç»Ÿ
- **When**: è¿è¡Œæ‰€æœ‰åŠ¨ç”»æµ‹è¯•
- **Then**:
  - âœ… æ¤ç‰©åŠ¨ç”»æ­£å¸¸ï¼ˆå‘æ—¥è‘µã€è±Œè±†å°„æ‰‹ã€åšæœå¢™ç­‰ï¼‰
  - âœ… åƒµå°¸åŠ¨ç”»æ­£å¸¸ï¼ˆæ™®é€šåƒµå°¸ã€è·¯éšœã€é“æ¡¶ï¼‰
  - âœ… ä¸»èœå•åŠ¨ç”»ï¿½ï¿½å¸¸ï¼ˆSelectorScreen äº‘æœµã€è‰ä¸›ï¼‰
  - âœ… è±Œè±†å°„æ‰‹æ”»å‡»æ—¶å¤´éƒ¨æ˜¾ç¤ºæ­£å¸¸
  - âœ… æ‰€æœ‰ç‰¹æ•ˆåŠ¨ç”»æ­£å¸¸

### AC2: æ€§èƒ½æ— é€€åŒ–
- **Given**: é‡æ„åçš„ä»£ç 
- **When**: æ€§èƒ½æµ‹è¯•
- **Then**:
  - FPS â‰¥ 60ï¼ˆ60 FPS æ¨¡å¼ï¼‰
  - æ¸²æŸ“æ—¶é—´ < 5ms/frame
  - å†…å­˜ä½¿ç”¨æ— æ˜æ˜¾å¢åŠ 
  - CPU ä½¿ç”¨æ— å¼‚å¸¸å³°å€¼

### AC3: æ–‡æ¡£æ›´æ–°å®Œæ•´
- **Given**: æ–°çš„åŠ¨ç”»ç³»ç»Ÿæ¶æ„
- **When**: æ–‡æ¡£å®¡æŸ¥
- **Then**:
  - CLAUDE.md åæ˜ æ–°æ¶æ„
  - åˆ é™¤ç­–ç•¥æ¨¡å¼ç›¸å…³è¯´æ˜
  - æ·»åŠ å¤šåŠ¨ç”» API ä½¿ç”¨æŒ‡å—
  - æ›´æ–°ç¤ºä¾‹ä»£ç 

### AC4: åºŸå¼ƒæ ‡è®°æ¸…æ™°
- **Given**: Story 6.6 å’Œ 6.7
- **When**: æŸ¥çœ‹è¿™äº› Story
- **Then**:
  - çŠ¶æ€æ ‡è®°ä¸º `Superseded`
  - æ·»åŠ åºŸå¼ƒåŸå› è¯´æ˜
  - å¼•ç”¨ Story 6.8/6.9/6.10 ä½œä¸ºæ›¿ä»£

### AC5: å¼€å‘è€…å¯ä»¥æ— éšœç¢ä½¿ç”¨æ–° API
- **Given**: æ–°å¼€å‘è€…é˜…è¯»æ–‡æ¡£
- **When**: å°è¯•æ·»åŠ æ–°æ¤ç‰©åŠ¨ç”»
- **Then**:
  - æ–‡æ¡£æ¸…æ™°æ˜“æ‡‚
  - ç¤ºä¾‹ä»£ç å¯ç›´æ¥å¤åˆ¶ä½¿ç”¨
  - å¸¸è§é—®é¢˜æœ‰è§£ç­”

## Tasks / Subtasks

### Task 1: æ¤ç‰©åŠ¨ç”»å›å½’æµ‹è¯•ï¼ˆ0.25å¤©ï¼‰(AC: 1)

- [ ] **Task 1.1**: æµ‹è¯•æ‰€æœ‰æ¤ç‰©åŠ¨ç”»
  ```bash
  # è¿è¡Œæ¸¸æˆï¼Œé€ä¸ªæµ‹è¯•
  go run . --verbose

  # éªŒè¯æ¤ç‰©ï¼š
  # - å‘æ—¥è‘µï¼šç©ºé—²æ‘†åŠ¨
  # - è±Œè±†å°„æ‰‹ï¼šç©ºé—² + æ”»å‡»ï¼ˆå¤´éƒ¨ä¸æ¶ˆå¤±ï¼‰
  # - åšæœå¢™ï¼šé™æ­¢
  # - æ¨±æ¡ƒç‚¸å¼¹ï¼šçˆ†ç‚¸åŠ¨ç”»
  # - åœŸè±†é›·ï¼šä¸Šå‡åŠ¨ç”»
  ```

- [ ] **Task 1.2**: æ£€æŸ¥åŠ¨ç”»åŒæ­¥æ€§
  ```
  éªŒè¯ï¼š
  - GlobalFrame æ­£ç¡®æ¨è¿›
  - å¤šåŠ¨ç”»åœ¨åŒä¸€å¸§åŒæ­¥
  - å¾ªç¯æ­£å¸¸
  - éå¾ªç¯åŠ¨ç”»æ­£ç¡®åœæ­¢
  ```

- [ ] **Task 1.3**: è®°å½•æµ‹è¯•ç»“æœ
  ```markdown
  ## æ¤ç‰©åŠ¨ç”»æµ‹è¯•ç»“æœ

  | æ¤ç‰© | åŠ¨ç”» | çŠ¶æ€ | å¤‡æ³¨ |
  |------|------|------|------|
  | å‘æ—¥è‘µ | anim_idle | âœ… | æ‘†åŠ¨æ­£å¸¸ |
  | è±Œè±†å°„æ‰‹ | anim_idle | âœ… | å¤´éƒ¨æ˜¾ç¤º |
  | è±Œè±†å°„æ‰‹ | anim_shooting + anim_head_idle | âœ… | èº«ä½“å’Œå¤´éƒ¨åŒæ—¶æ˜¾ç¤º |
  | ... | ... | ... | ... |
  ```

### Task 2: åƒµå°¸åŠ¨ç”»å›å½’æµ‹è¯•ï¼ˆ0.25å¤©ï¼‰(AC: 1)

- [ ] **Task 2.1**: æµ‹è¯•åƒµå°¸åŠ¨ç”»
  ```bash
  # è¿è¡Œæ¸¸æˆï¼Œç”Ÿæˆåƒµå°¸
  go run .

  # éªŒè¯ï¼š
  # - æ™®é€šåƒµå°¸ï¼šwalk, eat, death
  # - è·¯éšœåƒµå°¸ï¼šè£…å¤‡æ˜¾ç¤ºæ­£ç¡®
  # - é“æ¡¶åƒµå°¸ï¼šè£…å¤‡æ˜¾ç¤ºæ­£ç¡®
  ```

- [ ] **Task 2.2**: éªŒè¯ VisibleTracks æœºåˆ¶
  ```
  éªŒè¯ï¼š
  - åƒµå°¸éƒ¨ä»¶é™æ€æ§åˆ¶æ­£å¸¸
  - å—ä¼¤æ—¶æ‰‹è‡‚éšè—æ­£å¸¸
  - æ­»äº¡æ—¶å¤´éƒ¨æ‰è½æ­£å¸¸
  ```

### Task 3: ä¸»èœå•åŠ¨ç”»å›å½’æµ‹è¯•ï¼ˆ0.25å¤©ï¼‰(AC: 1)

- [ ] **Task 3.1**: æµ‹è¯• SelectorScreen åŠ¨ç”»
  ```bash
  # å¯åŠ¨æ¸¸æˆï¼Œåœç•™åœ¨ä¸»èœå•
  go run .

  # éªŒè¯ï¼š
  # - äº‘æœµç‹¬ç«‹é£˜åŠ¨ï¼ˆ7 ä¸ªäº‘æœµå„è‡ªå¾ªç¯ï¼‰
  # - è‰ä¸›å‘¨æœŸæ€§æ™ƒåŠ¨
  # - èŠ±æœµè§¦å‘åæ’­æ”¾
  # - èƒŒæ™¯åŠ¨ç”»æ­£å¸¸
  ```

- [ ] **Task 3.2**: éªŒè¯å¼‚æ­¥æ¨¡å¼
  ```
  éªŒè¯ï¼š
  - TrackMapping æ­£ç¡®æ˜ å°„è½¨é“åˆ°åŠ¨ç”»
  - æ¯ä¸ªåŠ¨ç”»ä½¿ç”¨ç‹¬ç«‹çš„ Frame
  - æ— ç›¸äº’å¹²æ‰°
  ```

### Task 4: æ€§èƒ½æµ‹è¯•ï¼ˆ0.25å¤©ï¼‰(AC: 2)

- [ ] **Task 4.1**: FPS æµ‹è¯•
  ```bash
  # è¿è¡Œæ¸¸æˆï¼Œç›‘æ§ FPS
  go run . --verbose

  # æµ‹è¯•åœºæ™¯ï¼š
  # 1. ä¸»èœå•ï¼ˆ14 ä¸ªç‹¬ç«‹åŠ¨ç”»ï¼‰
  # 2. æ¸¸æˆä¸­ï¼ˆ10+ æ¤ç‰© + 5+ åƒµå°¸ï¼‰
  # 3. é«˜è´Ÿè½½ï¼ˆ20+ å®ä½“åŒæ—¶æ’­æ”¾åŠ¨ç”»ï¼‰
  ```

- [ ] **Task 4.2**: æ€§èƒ½åŸºå‡†æµ‹è¯•
  ```bash
  # è¿è¡ŒåŸºå‡†æµ‹è¯•
  go test -bench=. -benchmem ./pkg/systems/

  # å¯¹æ¯” Story 6.6 çš„åŸºå‡†æ•°æ®
  # éªŒè¯æ— æ˜æ˜¾é€€åŒ–
  ```

- [ ] **Task 4.3**: CPU & å†…å­˜ Profiling
  ```bash
  # CPU profiling
  go test -cpuprofile=cpu.prof -bench=BenchmarkReanimUpdate ./pkg/systems/
  go tool pprof cpu.prof

  # Memory profiling
  go test -memprofile=mem.prof -bench=BenchmarkReanimUpdate ./pkg/systems/
  go tool pprof mem.prof

  # éªŒè¯ï¼š
  # - æ— çƒ­ç‚¹å‡½æ•°
  # - æ— å†…å­˜æ³„æ¼
  # - åˆ†é…æ¬¡æ•°åˆç†
  ```

### Task 5: æ›´æ–° CLAUDE.mdï¼ˆ0.5å¤©ï¼‰(AC: 3, 5)

- [ ] **Task 5.0**: ç¡®è®¤å½“å‰ CLAUDE.md çš„ Reanim API éƒ¨åˆ†
  ```markdown
  å½“å‰ CLAUDE.mdï¼ˆçº¦ç¬¬ 440-461 è¡Œï¼‰çš„ API ä½¿ç”¨ç¤ºä¾‹éƒ¨åˆ†ï¼š

  ### API ä½¿ç”¨ç¤ºä¾‹

  #### æ’­æ”¾åŠ¨ç”»

  ```go
  // æ’­æ”¾åŠ¨ç”»
  reanimSystem.PlayAnimation(entityID, "anim_idle")

  // æ”»å‡»åŠ¨ç”»
  reanimSystem.PlayAnimation(entityID, "anim_shooting")
  ```

  #### æ§åˆ¶éƒ¨ä»¶æ˜¾ç¤ºï¼ˆåƒµå°¸ç­‰ï¼‰

  ```go
  // ä½¿ç”¨ VisibleTracks ç™½åå•
  reanimComp.VisibleTracks = map[string]bool{
      "Zombie_body":      true,
      "Zombie_head":      true,
      "Zombie_outerarm":  false,  // éšè—æ‰‹è‡‚
  }
  ```

  **é—®é¢˜**ï¼šåªå±•ç¤ºäº†å•åŠ¨ç”» APIï¼ˆ`PlayAnimation`ï¼‰ï¼Œç¼ºå°‘ Story 6.9 å®ç°çš„å¤šåŠ¨ç”» APIã€‚
  ```

- [ ] **Task 5.1**: æ‰©å±• API ä½¿ç”¨ç¤ºä¾‹ï¼ˆä¸åˆ é™¤ç°æœ‰å†…å®¹ï¼Œæ·»åŠ æ–°å†…å®¹ï¼‰
  ```markdown
  å®šä½åˆ° CLAUDE.md çš„ "### API ä½¿ç”¨ç¤ºä¾‹" éƒ¨åˆ†ï¼ˆçº¦ç¬¬ 440 è¡Œï¼‰

  ä¿ç•™ç°æœ‰çš„ "#### æ’­æ”¾åŠ¨ç”»" å’Œ "#### æ§åˆ¶éƒ¨ä»¶æ˜¾ç¤ºï¼ˆåƒµå°¸ç­‰ï¼‰" ä¸¤ä¸ªå°èŠ‚

  åœ¨ "#### æ§åˆ¶éƒ¨ä»¶æ˜¾ç¤ºï¼ˆåƒµå°¸ç­‰ï¼‰" ä¹‹åï¼Œæ·»åŠ ä»¥ä¸‹æ–°å°èŠ‚ï¼š

  #### æ’­æ”¾å¤šä¸ªåŠ¨ç”»ï¼ˆå åŠ ï¼‰

  ```go
  // è±Œè±†å°„æ‰‹æ”»å‡»ï¼šèº«ä½“åŠ¨ç”» + å¤´éƒ¨åŠ¨ç”»åŒæ—¶æ’­æ”¾
  reanimSystem.PlayAnimations(peashooterID, []string{"anim_shooting", "anim_head_idle"})
  ```

  #### å¢é‡æ§åˆ¶åŠ¨ç”»

  ```go
  // åŸºç¡€åŠ¨ç”»
  reanimSystem.PlayAnimation(entityID, "anim_walk")

  // å åŠ ç‰¹æ•ˆåŠ¨ç”»ï¼ˆä¿ç•™å·²æœ‰åŠ¨ç”»ï¼‰
  reanimSystem.AddAnimation(entityID, "anim_burning")

  // ç§»é™¤ç‰¹æ•ˆåŠ¨ç”»
  reanimSystem.RemoveAnimation(entityID, "anim_burning")
  ```
  ```

- [ ] **Task 5.2**: æ·»åŠ å¸¸è§é—®é¢˜è§£ç­”
  ```markdown
  åœ¨ "### å‚è€ƒæ–‡æ¡£" éƒ¨åˆ†ä¹‹å‰ï¼Œæ·»åŠ ä»¥ä¸‹æ–°ç« èŠ‚ï¼š

  ### å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰

  **Q: å¦‚ä½•è®©æ¤ç‰©æ”»å‡»æ—¶å¤´éƒ¨å’Œèº«ä½“åŒæ—¶æ˜¾ç¤ºï¼Ÿ**

  A: ä½¿ç”¨å¤šåŠ¨ç”»å åŠ  APIï¼š
  ```go
  reanimSystem.PlayAnimations(entityID, []string{"anim_shooting", "anim_head_idle"})
  ```

  **Q: å¦‚ä½•æ§åˆ¶åƒµå°¸è£…å¤‡æ˜¾ç¤ºï¼Ÿ**

  A: ä½¿ç”¨ VisibleTracks ç™½åå•ï¼š
  ```go
  reanimComp.VisibleTracks = map[string]bool{
      "Zombie_body": true,
      "anim_cone":   true,  // æ˜¾ç¤ºè·¯éšœ
  }
  ```

  **Q: PlayAnimation å’Œ PlayAnimations æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

  A:
  - `PlayAnimation(id, "anim")` - æ’­æ”¾å•ä¸ªåŠ¨ç”»ï¼ˆæ¸…ç©ºæ—§åŠ¨ç”»ï¼‰
  - `PlayAnimations(id, []string{"anim1", "anim2"})` - æ’­æ”¾å¤šä¸ªåŠ¨ç”»ï¼ˆæ¸…ç©ºæ—§åŠ¨ç”»ï¼ŒåŒæ—¶æ’­æ”¾å¤šä¸ªï¼‰
  - `AddAnimation(id, "anim")` - å¢é‡æ·»åŠ ï¼ˆä¿ç•™å·²æœ‰åŠ¨ç”»ï¼‰

  **Q: ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¤šåŠ¨ç”»å åŠ ï¼Ÿ**

  A: å½“ä¸€ä¸ªå®ä½“éœ€è¦åŒæ—¶æ§åˆ¶å¤šä¸ªéƒ¨ä»¶çš„åŠ¨ç”»æ—¶ï¼Œä¾‹å¦‚ï¼š
  - è±Œè±†å°„æ‰‹æ”»å‡»ï¼šèº«ä½“æ”»å‡» + å¤´éƒ¨æ‘†åŠ¨
  - åƒµå°¸è¡Œèµ°æ—¶ç€ç«ï¼šè¡Œèµ°åŠ¨ç”» + ç‡ƒçƒ§ç‰¹æ•ˆ
  ```

### Task 6: æ ‡è®°åºŸå¼ƒ Storyï¼ˆ0.1å¤©ï¼‰(AC: 4)

- [ ] **Task 6.1**: æ›´æ–° Story 6.6
  ```markdown
  # Story 6.6: Reanim æ’­æ”¾æ¨¡å¼é€šç”¨åŒ–

  ## Status
  Superseded

  ## Deprecation Notice

  **åºŸå¼ƒæ—¥æœŸ**: 2025-11-05

  **åŸå› **: 5 ç§æ’­æ”¾æ¨¡å¼è¢«è¯æ˜æ˜¯è¿‡åº¦è®¾è®¡ï¼Œå·²è¢«ç»Ÿä¸€çš„åŠ¨ç”»æœºåˆ¶æ›¿ä»£ã€‚

  **æ›¿ä»£æ–¹æ¡ˆ**: å‚è§ä»¥ä¸‹ Storyï¼š
  - Story 6.8: ç»Ÿä¸€ä¸º Anims + GlobalFrame
  - Story 6.9: å®ç°å¤šåŠ¨ç”»å åŠ  API
  - Story 6.10: å›å½’æµ‹è¯•ä¸æ–‡æ¡£æ›´æ–°

  **ä¿ç•™åŸå› **: ä¿ç•™æ­¤æ–‡æ¡£ä½œä¸ºè®¾è®¡æ¼”è¿›çš„å†å²è®°å½•ã€‚
  ```

- [ ] **Task 6.2**: æ›´æ–° Story 6.7
  ```markdown
  # Story 6.7: æ¸…ç†åºŸå¼ƒä»£ç å’Œè¿‡åº¦è®¾è®¡

  ## Status
  Superseded

  ## Deprecation Notice

  **åºŸå¼ƒæ—¥æœŸ**: 2025-11-05

  **åŸå› **: æœ¬ Story çš„æ¸…ç†å·¥ä½œä¸å½»åº•ï¼ŒStrategy æ¨¡å¼ä»ç„¶ä¿ç•™ã€‚
  Story 6.8-6.10 è¿›è¡Œäº†æ›´å½»åº•çš„é‡æ„ã€‚

  **æ›¿ä»£æ–¹æ¡ˆ**: Story 6.8/6.9/6.10
  ```

### Task 7: åˆ›å»ºä½¿ç”¨ç¤ºä¾‹æ–‡æ¡£ï¼ˆ0.25å¤©ï¼‰(AC: 5)

- [ ] **Task 7.1**: åˆ›å»º `docs/examples/animation-api-usage.md`
  ```markdown
  åˆ›å»ºæ–‡ä»¶ï¼šdocs/examples/animation-api-usage.md

  å†…å®¹å¦‚ä¸‹ï¼š

  ---
  # Reanim åŠ¨ç”» API ä½¿ç”¨ç¤ºä¾‹

  æœ¬æ–‡æ¡£æä¾›äº†å®Œæ•´çš„ã€å¯è¿è¡Œçš„ Reanim åŠ¨ç”» API ä½¿ç”¨ç¤ºä¾‹ã€‚

  ## åŸºç¡€ç”¨æ³•

  ### å•åŠ¨ç”»æ’­æ”¾

  æœ€å¸¸è§çš„åœºæ™¯ï¼Œæ’­æ”¾ä¸€ä¸ªåŠ¨ç”»ï¼š

  ```go
  // å‘æ—¥è‘µç©ºé—²åŠ¨ç”»
  func createSunflower(em *ecs.EntityManager, reanimSys *systems.ReanimSystem) ecs.Entity {
      entity := em.NewEntity()

      // ... åˆ›å»ºå®ä½“å’Œç»„ä»¶ ...

      // æ’­æ”¾ç©ºé—²åŠ¨ç”»
      reanimSys.PlayAnimation(entity, "anim_idle")

      return entity
  }
  ```

  ### å¤šåŠ¨ç”»å åŠ 

  å½“ä¸€ä¸ªå®ä½“éœ€è¦åŒæ—¶æ§åˆ¶å¤šä¸ªéƒ¨ä»¶æ—¶ï¼š

  ```go
  // è±Œè±†å°„æ‰‹æ”»å‡»ï¼šèº«ä½“æ”»å‡»åŠ¨ç”» + å¤´éƒ¨ç©ºé—²åŠ¨ç”»
  func peashooterStartShooting(entityID ecs.Entity, reanimSys *systems.ReanimSystem) {
      // æ–¹æ³• 1ï¼šä½¿ç”¨ PlayAnimationsï¼ˆæ¨èï¼‰
      reanimSys.PlayAnimations(entityID, []string{"anim_shooting", "anim_head_idle"})

      // æ–¹æ³• 2ï¼šä½¿ç”¨ AddAnimationï¼ˆå¢é‡å¼ï¼‰
      // reanimSys.PlayAnimation(entityID, "anim_shooting")
      // reanimSys.AddAnimation(entityID, "anim_head_idle")
  }

  // æ”»å‡»ç»“æŸï¼Œæ¢å¤ç©ºé—²
  func peashooterStopShooting(entityID ecs.Entity, reanimSys *systems.ReanimSystem) {
      reanimSys.PlayAnimation(entityID, "anim_idle")
  }
  ```

  ### å¢é‡æ§åˆ¶åŠ¨ç”»

  ä¿ç•™å·²æœ‰åŠ¨ç”»ï¼Œå åŠ æ–°åŠ¨ç”»ï¼š

  ```go
  // åƒµå°¸è¡Œèµ°æ—¶ç€ç«
  func zombieStartBurning(entityID ecs.Entity, reanimSys *systems.ReanimSystem) {
      // ä¿ç•™è¡Œèµ°åŠ¨ç”»ï¼Œå åŠ ç‡ƒçƒ§ç‰¹æ•ˆ
      reanimSys.AddAnimation(entityID, "anim_burning")
  }

  // ç†„ç­ç«ç„°
  func zombieStopBurning(entityID ecs.Entity, reanimSys *systems.ReanimSystem) {
      reanimSys.RemoveAnimation(entityID, "anim_burning")
      // è¡Œèµ°åŠ¨ç”»ç»§ç»­æ’­æ”¾
  }
  ```

  ## å¸¸è§åœºæ™¯

  ### åœºæ™¯ 1ï¼šæ¤ç‰©æ”»å‡»åŠ¨ç”»

  å®Œæ•´çš„è±Œè±†å°„æ‰‹æ”»å‡»é€»è¾‘ï¼š

  ```go
  // pkg/systems/behavior_system.go

  func (bs *BehaviorSystem) handlePeashooterBehavior(
      entityID ecs.Entity,
      plantComp *components.PlantComponent,
      deltaTime float64,
  ) {
      // æ£€æµ‹æ˜¯å¦æœ‰åƒµå°¸
      hasTarget := bs.detectZombiesInLane(plantComp.LaneIndex)

      if hasTarget {
          // è¿›å…¥æ”»å‡»çŠ¶æ€
          if plantComp.State != "shooting" {
              plantComp.State = "shooting"
              // æ’­æ”¾æ”»å‡»åŠ¨ç”»ï¼ˆèº«ä½“ + å¤´éƒ¨ï¼‰
              bs.reanimSystem.PlayAnimations(entityID, []string{
                  "anim_shooting",
                  "anim_head_idle",
              })
          }

          // æ”»å‡»é€»è¾‘...
          plantComp.ShootTimer += deltaTime
          if plantComp.ShootTimer >= plantComp.ShootInterval {
              bs.shootPea(entityID, plantComp)
              plantComp.ShootTimer = 0
          }
      } else {
          // æ¢å¤ç©ºé—²çŠ¶æ€
          if plantComp.State != "idle" {
              plantComp.State = "idle"
              // æ’­æ”¾ç©ºé—²åŠ¨ç”»
              bs.reanimSystem.PlayAnimation(entityID, "anim_idle")
          }
      }
  }
  ```

  ### åœºæ™¯ 2ï¼šåƒµå°¸è£…å¤‡æ§åˆ¶

  è·¯éšœåƒµå°¸çš„è£…å¤‡æ˜¾ç¤ºï¼š

  ```go
  // pkg/entities/zombie_factory.go

  func CreateConeheadZombie(
      em *ecs.EntityManager,
      rm *game.ResourceManager,
      x, y float64,
  ) ecs.Entity {
      entity := em.NewEntity()

      // åˆ›å»º ReanimComponent
      reanimComp := &components.ReanimComponent{
          // ... å…¶ä»–å­—æ®µ ...

          // ä½¿ç”¨ VisibleTracks æ§åˆ¶è£…å¤‡æ˜¾ç¤º
          VisibleTracks: map[string]bool{
              "Zombie_body":       true,  // èº«ä½“
              "Zombie_head":       true,  // å¤´éƒ¨
              "Zombie_outerarm":   true,  // å¤–ä¾§æ‰‹è‡‚
              "Zombie_innerarm":   true,  // å†…ä¾§æ‰‹è‡‚
              "anim_cone":         true,  // è·¯éšœè£…å¤‡
              "anim_screendoor":   false, // é“é—¨ï¼ˆéšè—ï¼‰
              "anim_football_helmet": false, // æ©„æ¦„çƒå¤´ç›”ï¼ˆéšè—ï¼‰
          },
      }

      ecs.AddComponent(em, entity, reanimComp)

      return entity
  }

  // è·¯éšœè¢«æ‰“æ‰æ—¶
  func removeCone(entityID ecs.Entity, em *ecs.EntityManager) {
      reanimComp, ok := ecs.GetComponent[*components.ReanimComponent](em, entityID)
      if ok {
          reanimComp.VisibleTracks["anim_cone"] = false  // éšè—è·¯éšœ
      }
  }
  ```

  ### åœºæ™¯ 3ï¼šä¸»èœå•åŠ¨ç”»ï¼ˆå¼‚æ­¥æ¨¡å¼ï¼‰

  SelectorScreen äº‘æœµç‹¬ç«‹å¾ªç¯ï¼š

  ```go
  // pkg/entities/selector_screen_factory.go

  func CreateSelectorScreen(
      em *ecs.EntityManager,
      rm *game.ResourceManager,
  ) ecs.Entity {
      entity := em.NewEntity()

      reanimComp := &components.ReanimComponent{
          // ... å…¶ä»–å­—æ®µ ...

          // è®¾ç½®å¼‚æ­¥æ¨¡å¼ï¼šæ¯ä¸ªäº‘æœµç‹¬ç«‹å¾ªç¯
          TrackMapping: map[string]string{
              "Cloud1": "anim_cloud1",
              "Cloud2": "anim_cloud2",
              "Cloud3": "anim_cloud3",
              "Cloud4": "anim_cloud4",
              "Cloud5": "anim_cloud5",
              "Cloud6": "anim_cloud6",
              "Cloud7": "anim_cloud7",
              "Grass1":  "anim_grass1",
              "Grass2":  "anim_grass2",
              "Grass3":  "anim_grass3",
              "Grass4":  "anim_grass4",
              "Grass5":  "anim_grass5",
              "Grass6":  "anim_grass6",
              "Grass7":  "anim_grass7",
          },

          // åˆå§‹åŒ–æ¯ä¸ªåŠ¨ç”»çš„ç‹¬ç«‹çŠ¶æ€
          Anims: map[string]*components.AnimState{
              "anim_cloud1": {
                  Name:      "anim_cloud1",
                  IsActive:  true,
                  IsLooping: true,
                  Frame:     0,  // ä»ç¬¬ 0 å¸§å¼€å§‹
              },
              "anim_cloud2": {
                  Name:      "anim_cloud2",
                  IsActive:  true,
                  IsLooping: true,
                  Frame:     20,  // ä»ç¬¬ 20 å¸§å¼€å§‹ï¼ˆé”™å¼€ï¼‰
              },
              // ... å…¶ä»–äº‘æœµå’Œè‰ä¸›åŠ¨ç”» ...
          },
      }

      ecs.AddComponent(em, entity, reanimComp)

      return entity
  }
  ```

  ## API å‚è€ƒ

  ### PlayAnimation

  æ’­æ”¾å•ä¸ªåŠ¨ç”»ï¼Œæ¸…ç©ºæ‰€æœ‰å·²æœ‰åŠ¨ç”»ã€‚

  ```go
  func (rs *ReanimSystem) PlayAnimation(entityID ecs.Entity, animName string) error
  ```

  **å‚æ•°ï¼š**
  - `entityID`: å®ä½“ ID
  - `animName`: åŠ¨ç”»åç§°ï¼ˆå¦‚ "anim_idle"ï¼‰

  **è¿”å›ï¼š**
  - `error`: å¦‚æœåŠ¨ç”»ä¸å­˜åœ¨æˆ–å®ä½“æ—  ReanimComponentï¼Œè¿”å›é”™è¯¯

  **ç¤ºä¾‹ï¼š**
  ```go
  reanimSystem.PlayAnimation(sunflowerID, "anim_idle")
  ```

  ### PlayAnimations

  æ’­æ”¾å¤šä¸ªåŠ¨ç”»ï¼ˆå åŠ ï¼‰ï¼Œæ¸…ç©ºæ‰€æœ‰å·²æœ‰åŠ¨ç”»ã€‚

  ```go
  func (rs *ReanimSystem) PlayAnimations(entityID ecs.Entity, animNames []string) error
  ```

  **å‚æ•°ï¼š**
  - `entityID`: å®ä½“ ID
  - `animNames`: åŠ¨ç”»åç§°åˆ—è¡¨

  **è¿”å›ï¼š**
  - `error`: å¦‚æœä»»ä¸€åŠ¨ç”»ä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯

  **ç¤ºä¾‹ï¼š**
  ```go
  reanimSystem.PlayAnimations(peashooterID, []string{"anim_shooting", "anim_head_idle"})
  ```

  ### AddAnimation

  å¢é‡æ·»åŠ åŠ¨ç”»ï¼Œä¿ç•™å·²æœ‰åŠ¨ç”»ã€‚

  ```go
  func (rs *ReanimSystem) AddAnimation(entityID ecs.Entity, animName string) error
  ```

  **å‚æ•°ï¼š**
  - `entityID`: å®ä½“ ID
  - `animName`: åŠ¨ç”»åç§°

  **è¿”å›ï¼š**
  - `error`: å¦‚æœåŠ¨ç”»ä¸å­˜åœ¨ï¼Œè¿”å›é”™è¯¯

  **ç¤ºä¾‹ï¼š**
  ```go
  reanimSystem.AddAnimation(zombieID, "anim_burning")
  ```

  ### RemoveAnimation

  ç§»é™¤æŒ‡å®šåŠ¨ç”»ï¼Œä¿ç•™å…¶ä»–åŠ¨ç”»ã€‚

  ```go
  func (rs *ReanimSystem) RemoveAnimation(entityID ecs.Entity, animName string) error
  ```

  **å‚æ•°ï¼š**
  - `entityID`: å®ä½“ ID
  - `animName`: è¦ç§»é™¤çš„åŠ¨ç”»åç§°

  **è¿”å›ï¼š**
  - `error`: å¦‚æœå®ä½“æ—  ReanimComponentï¼Œè¿”å›é”™è¯¯

  **ç¤ºä¾‹ï¼š**
  ```go
  reanimSystem.RemoveAnimation(zombieID, "anim_burning")
  ```

  ## å¸¸è§é—®é¢˜

  **Q: å¦‚ä½•åˆ¤æ–­ä½¿ç”¨ PlayAnimation è¿˜æ˜¯ PlayAnimationsï¼Ÿ**

  A:
  - å¦‚æœå®ä½“åªéœ€è¦æ’­æ”¾ä¸€ä¸ªåŠ¨ç”»ï¼ˆå¦‚å‘æ—¥è‘µç©ºé—²ï¼‰ï¼Œä½¿ç”¨ `PlayAnimation`
  - å¦‚æœå®ä½“éœ€è¦åŒæ—¶æ§åˆ¶å¤šä¸ªéƒ¨ä»¶ï¼ˆå¦‚è±Œè±†å°„æ‰‹æ”»å‡»æ—¶èº«ä½“å’Œå¤´éƒ¨ï¼‰ï¼Œä½¿ç”¨ `PlayAnimations`

  **Q: AddAnimation å’Œ PlayAnimations çš„åŒºåˆ«ï¼Ÿ**

  A:
  - `PlayAnimations`ï¼šæ¸…ç©ºæ‰€æœ‰å·²æœ‰åŠ¨ç”»ï¼Œç„¶åæ·»åŠ æ–°åŠ¨ç”»
  - `AddAnimation`ï¼šä¿ç•™å·²æœ‰åŠ¨ç”»ï¼Œå åŠ æ–°åŠ¨ç”»

  **Q: å¦‚ä½•è°ƒè¯•åŠ¨ç”»é—®é¢˜ï¼Ÿ**

  A: ä½¿ç”¨ `--verbose` æ ‡å¿—è¿è¡Œæ¸¸æˆï¼š
  ```bash
  go run . --verbose
  ```
  è¿™ä¼šè¾“å‡ºåŠ¨ç”»æ’­æ”¾çš„è¯¦ç»†æ—¥å¿—ã€‚

  ---

  **ç‰ˆæœ¬**: 1.0
  **æœ€åæ›´æ–°**: 2025-11-05
  **ç›¸å…³ Story**: 6.8, 6.9, 6.10
  ```

### Task 8: æœ€ç»ˆéªŒè¯ï¼ˆ0.1å¤©ï¼‰(AC: 1-5)

- [ ] **Task 8.1**: å®Œæ•´æ¸¸æˆæµ‹è¯•
  ```bash
  # ä»å¯åŠ¨åˆ°å…³å¡å®Œæˆï¼Œå®Œæ•´æ¸¸æˆæµç¨‹
  go run .

  # éªŒè¯ï¼š
  # 1. ä¸»èœå•æ­£å¸¸
  # 2. é€‰å¡ç•Œé¢æ­£å¸¸
  # 3. æ¸¸æˆä¸­æ‰€æœ‰åŠ¨ç”»æ­£å¸¸
  # 4. æ— å´©æºƒã€æ— å¡é¡¿
  # 5. FPS ç¨³å®šåœ¨ 60
  ```

- [ ] **Task 8.2**: ä»£ç å®¡æŸ¥æ¸…å•
  ```markdown
  - [ ] æ‰€æœ‰ TODO å·²å¤„ç†
  - [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
  - [ ] æ–‡æ¡£å®Œæ•´
  - [ ] æ€§èƒ½è¾¾æ ‡
  - [ ] å‘åå…¼å®¹
  ```

- [ ] **Task 8.3**: æäº¤ Git Commit
  ```bash
  # ä½¿ç”¨ Dev Notes ä¸­çš„ "Git Commit å»ºè®®" éƒ¨åˆ†çš„æ¨¡æ¿
  # å‚è§æœ¬æ–‡æ¡£ä¸‹æ–¹ Dev Notes > Git Commit å»ºè®® > Commit Message æ¨¡æ¿

  git add .
  git commit -m "$(cat <<'EOF'
  refactor(animation): ç®€åŒ– Reanim ç³»ç»Ÿæ¶æ„

  - åˆ é™¤ 5 ç§æ’­æ”¾æ¨¡å¼æšä¸¾å’Œç­–ç•¥ç³»ç»Ÿï¼ˆ-600 è¡Œï¼‰
  - ç»Ÿä¸€ä¸º Anims + GlobalFrame æœºåˆ¶
  - å®ç°å¤šåŠ¨ç”»å åŠ  API
  - ä¿®å¤è±Œè±†å°„æ‰‹æ”»å‡»æ—¶å¤´éƒ¨æ¶ˆå¤±é—®é¢˜
  - æ›´æ–° CLAUDE.md å’Œæ–‡æ¡£

  Epic 6: åŠ¨ç”»ç³»ç»Ÿç®€åŒ–
  Stories: 6.8, 6.9, 6.10
  EOF
  )"
  ```

## Dev Notes

### ç›¸å…³é¡¹ç›®ç»“æ„

æ ¹æ® Unified Project Structureï¼Œæœ¬ Story æ¶‰åŠä»¥ä¸‹ç›®å½•å’Œæ–‡ä»¶ï¼š

```plaintext
pvz/
â”œâ”€â”€ CLAUDE.md                 # é¡¹ç›®æŒ‡ä»¤æ–‡æ¡£ï¼ˆTask 5 å°†ä¿®æ”¹ï¼‰
â”œâ”€â”€ docs/                     # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ examples/             # ä½¿ç”¨ç¤ºä¾‹ç›®å½•
â”‚   â”‚   â””â”€â”€ animation-api-usage.md  # Task 7 å°†åˆ›å»º
â”‚   â””â”€â”€ stories/              # Story æ–‡æ¡£
â”‚       â”œâ”€â”€ 6.6.story.md      # Task 6 å°†æ ‡è®°ä¸º Superseded
â”‚       â”œâ”€â”€ 6.7.story.md      # Task 6 å°†æ ‡è®°ä¸º Superseded
â”‚       â”œâ”€â”€ 6.8.story.md      # å‰ç½®ä¾èµ–
â”‚       â”œâ”€â”€ 6.9.story.md      # å‰ç½®ä¾èµ–
â”‚       â””â”€â”€ 6.10.story.md     # æœ¬ Story
â””â”€â”€ pkg/                      # æ ¸å¿ƒä»£ç åº“ï¼ˆTask 1-4 æµ‹è¯•ç›®æ ‡ï¼‰
    â”œâ”€â”€ components/           # ç»„ä»¶å®šä¹‰
    â”œâ”€â”€ systems/              # ç³»ç»Ÿå®ç°
    â”‚   â”œâ”€â”€ reanim_system.go  # åŠ¨ç”»ç³»ç»Ÿ
    â”‚   â”œâ”€â”€ render_system.go  # æ¸²æŸ“ç³»ç»Ÿ
    â”‚   â””â”€â”€ behavior_system.go # è¡Œä¸ºç³»ç»Ÿ
    â””â”€â”€ entities/             # å®ä½“å·¥å‚
        â”œâ”€â”€ plant_factory.go
        â””â”€â”€ zombie_factory.go
```

### å›å½’æµ‹è¯•ç­–ç•¥

#### 1. åˆ†å±‚æµ‹è¯•

```
ç¬¬ä¸€å±‚ï¼šå•å…ƒæµ‹è¯•ï¼ˆè‡ªåŠ¨åŒ–ï¼‰
â”œâ”€â”€ ReanimSystem API æµ‹è¯•
â”œâ”€â”€ RenderSystem é€»è¾‘æµ‹è¯•
â””â”€â”€ AnimState çŠ¶æ€ç®¡ç†æµ‹è¯•

ç¬¬äºŒå±‚ï¼šé›†æˆæµ‹è¯•ï¼ˆåŠè‡ªåŠ¨ï¼‰
â”œâ”€â”€ æ¤ç‰©åŠ¨ç”»ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ åƒµå°¸åŠ¨ç”»ç«¯åˆ°ç«¯æµ‹è¯•
â””â”€â”€ ä¸»èœå•åŠ¨ç”»ç«¯åˆ°ç«¯æµ‹è¯•

ç¬¬ä¸‰å±‚ï¼šæ‰‹åŠ¨æµ‹è¯•ï¼ˆäººå·¥ï¼‰
â”œâ”€â”€ è§†è§‰æ•ˆæœéªŒè¯
â”œâ”€â”€ è¾¹ç•Œæƒ…å†µæµ‹è¯•
â””â”€â”€ ç”¨æˆ·ä½“éªŒæµ‹è¯•
```

#### 2. æµ‹è¯•ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | æµ‹è¯•é¡¹ | åŸå›  |
|--------|--------|------|
| ğŸ”´ P0 | è±Œè±†å°„æ‰‹æ”»å‡»åŠ¨ç”» | æ ¸å¿ƒé—®é¢˜ä¿®å¤ |
| ğŸ”´ P0 | ä¸»èœå•äº‘æœµåŠ¨ç”» | å¼‚æ­¥æ¨¡å¼éªŒè¯ |
| ğŸŸ¡ P1 | å…¶ä»–æ¤ç‰©åŠ¨ç”» | å¹¿æ³›å½±å“ |
| ğŸŸ¡ P1 | åƒµå°¸åŠ¨ç”» | æ ¸å¿ƒç©æ³• |
| ğŸŸ¢ P2 | è¾¹ç•Œæƒ…å†µ | å®Œæ•´æ€§ |

#### 3. å›å½’æµ‹è¯•è®°å½•è¡¨æ¨¡æ¿

**Task 1-3 æ‰§è¡Œæ—¶ä½¿ç”¨æ­¤è¡¨è®°å½•æµ‹è¯•ç»“æœï¼š**

| æµ‹è¯•é¡¹ | é¢„æœŸç»“æœ | å®é™…ç»“æœ | çŠ¶æ€ | å¤‡æ³¨ |
|--------|---------|---------|------|------|
| **æ¤ç‰©åŠ¨ç”»** |  |  |  |  |
| å‘æ—¥è‘µç©ºé—²åŠ¨ç”» | æ‘†åŠ¨æ­£å¸¸ | _å¾…å¡«å†™_ | â¬œ |  |
| è±Œè±†å°„æ‰‹ç©ºé—² | å¤´éƒ¨æ˜¾ç¤ºå¹¶æ‘†åŠ¨ | _å¾…å¡«å†™_ | â¬œ |  |
| è±Œè±†å°„æ‰‹æ”»å‡» | èº«ä½“æ”»å‡» + å¤´éƒ¨æ‘†åŠ¨ | _å¾…å¡«å†™_ | â¬œ | **P0 å…³é”®æµ‹è¯•** |
| åšæœå¢™ç©ºé—² | é™æ­¢æ˜¾ç¤º | _å¾…å¡«å†™_ | â¬œ |  |
| æ¨±æ¡ƒç‚¸å¼¹çˆ†ç‚¸ | çˆ†ç‚¸åŠ¨ç”»æ’­æ”¾ | _å¾…å¡«å†™_ | â¬œ |  |
| åœŸè±†é›·ä¸Šå‡ | ä¸Šå‡åŠ¨ç”»æ’­æ”¾ | _å¾…å¡«å†™_ | â¬œ |  |
| **åƒµå°¸åŠ¨ç”»** |  |  |  |  |
| æ™®é€šåƒµå°¸è¡Œèµ° | è¡Œèµ°åŠ¨ç”»æ­£å¸¸ | _å¾…å¡«å†™_ | â¬œ |  |
| æ™®é€šåƒµå°¸è¿›é£Ÿ | è¿›é£ŸåŠ¨ç”»æ­£å¸¸ | _å¾…å¡«å†™_ | â¬œ |  |
| æ™®é€šåƒµå°¸æ­»äº¡ | æ­»äº¡åŠ¨ç”»æ­£å¸¸ | _å¾…å¡«å†™_ | â¬œ |  |
| è·¯éšœåƒµå°¸è£…å¤‡ | è·¯éšœæ˜¾ç¤ºæ­£ç¡® | _å¾…å¡«å†™_ | â¬œ |  |
| é“æ¡¶åƒµå°¸è£…å¤‡ | é“æ¡¶æ˜¾ç¤ºæ­£ç¡® | _å¾…å¡«å†™_ | â¬œ |  |
| **ä¸»èœå•åŠ¨ç”»** |  |  |  |  |
| äº‘æœµ 1-7 ç‹¬ç«‹é£˜åŠ¨ | å„è‡ªç‹¬ç«‹å¾ªç¯ | _å¾…å¡«å†™_ | â¬œ | **P0 å…³é”®æµ‹è¯•** |
| è‰ä¸›å‘¨æœŸæ€§æ™ƒåŠ¨ | æ™ƒåŠ¨æ­£å¸¸ | _å¾…å¡«å†™_ | â¬œ |  |
| èŠ±æœµè§¦å‘åŠ¨ç”» | ç‚¹å‡»åæ’­æ”¾ | _å¾…å¡«å†™_ | â¬œ |  |
| èƒŒæ™¯åŠ¨ç”» | æ­£å¸¸æ’­æ”¾ | _å¾…å¡«å†™_ | â¬œ |  |

**çŠ¶æ€è¯´æ˜ï¼š**
- â¬œ æœªæµ‹è¯•
- âœ… é€šè¿‡
- âš ï¸ éƒ¨åˆ†é€šè¿‡ï¼ˆéœ€è¦å¤‡æ³¨ï¼‰
- âŒ å¤±è´¥

### æ€§èƒ½åŸºå‡†å¯¹æ¯”

#### Story 6.6 åŸºå‡†ï¼ˆå‚è€ƒï¼‰

**æ³¨æ„**ï¼šä»¥ä¸‹åŸºå‡†æ•°æ®æ¥è‡ª Story 6.6 å®æ–½æ—¶çš„æµ‹è¯•è®°å½•ã€‚å¦‚æœ Story 6.6 çš„ Dev Agent Record ä¸­æœ‰æ›´æ–°çš„æ•°æ®ï¼Œä»¥ Dev Agent Record ä¸ºå‡†ã€‚

```
BenchmarkReanimUpdate-32               2782600    418.9 ns/op
BenchmarkComplexSceneRendering-32    154790925      7.7 ns/op
```

#### Story 6.10 ç›®æ ‡

```
BenchmarkReanimUpdate-32               2500000+   < 500 ns/op  (å…è®¸å°å¹…å¢åŠ )
BenchmarkMultiAnimRendering-32         1000000+   < 1000 ns/op (æ–°æµ‹è¯•)
```

### æ–‡æ¡£æ›´æ–°æ¸…å•

#### CLAUDE.md ä¿®æ”¹é¡¹

- [ ] åˆ é™¤ "5 ç§æ’­æ”¾æ¨¡å¼" ç« èŠ‚
- [ ] åˆ é™¤ PlaybackMode è¯´æ˜
- [ ] åˆ é™¤ç­–ç•¥ç±»è¯´æ˜
- [ ] æ·»åŠ  "ç»Ÿä¸€åŠ¨ç”»æœºåˆ¶" ç« èŠ‚
- [ ] æ·»åŠ å¤šåŠ¨ç”» API ç¤ºä¾‹
- [ ] æ›´æ–°å¸¸è§é—®é¢˜è§£ç­”
- [ ] æ›´æ–°æ¶æ„å›¾ï¼ˆå¦‚æœæœ‰ï¼‰

#### å…¶ä»–æ–‡æ¡£

- [ ] Story 6.6 â†’ Superseded
- [ ] Story 6.7 â†’ Superseded
- [ ] åˆ›å»º `docs/examples/animation-api-usage.md`
- [ ] æ›´æ–° `docs/architecture.md`ï¼ˆå¦‚æœæœ‰åŠ¨ç”»ç³»ç»Ÿç« èŠ‚ï¼‰

### Git Commit å»ºè®®

#### Commit Message æ¨¡æ¿

```
refactor(animation): [ç®€çŸ­æè¿°]

[è¯¦ç»†æè¿°å˜æ›´å†…å®¹å’ŒåŸå› ]

Breaking Changes:
- [å¦‚æœæœ‰ç ´åæ€§å˜æ›´]

Migration Guide:
- [è¿ç§»æŒ‡å—]

Related Stories: 6.8, 6.9, 6.10
```

#### Commit ç­–ç•¥

- **é€‰é¡¹ A**ï¼šå•ä¸ªå¤§ commitï¼ˆæ¨èï¼ŒåŸå­æ€§å˜æ›´ï¼‰
- **é€‰é¡¹ B**ï¼š3 ä¸ª commitï¼ˆ6.8, 6.9, 6.10 åˆ†åˆ«æäº¤ï¼‰

**å»ºè®®**ï¼šé€‰é¡¹ Aï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„é‡æ„ï¼Œåº”è¯¥åŸå­æäº¤ã€‚

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-05 | 1.0 | Story åˆ›å»º | Sarah (PO) |
| 2025-11-05 | 1.1 | PO éªŒè¯ä¿®å¤ï¼šæ·»åŠ æ¨¡æ¿å¿…éœ€éƒ¨åˆ†ã€è¡¥å……å®ç°ç»†èŠ‚ | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
_ç•™ç©ºï¼Œå¾… Dev Agent å¡«å†™_

### Debug Log References
_ç•™ç©ºï¼Œå¾… Dev Agent å¡«å†™_

### Completion Notes
_ç•™ç©ºï¼Œå¾… Dev Agent å¡«å†™_

### File List
_ç•™ç©ºï¼Œå¾… Dev Agent å¡«å†™_

## QA Results
_ç•™ç©ºï¼Œå¾… QA Agent å¡«å†™_

---

## File List (Planning Reference)

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | å½±å“ |
|------|---------|------|
| CLAUDE.md | åˆ é™¤ç­–ç•¥æ¨¡å¼ï¼Œæ·»åŠ æ–°æ¶æ„è¯´æ˜ | é«˜ |
| docs/stories/6.6.story.md | æ·»åŠ  Superseded æ ‡è®° | ä½ |
| docs/stories/6.7.story.md | æ·»åŠ  Superseded æ ‡è®° | ä½ |

### æ–°å¢çš„æ–‡ä»¶

| æ–‡ä»¶ | å†…å®¹ | ç”¨é€” |
|------|------|------|
| docs/examples/animation-api-usage.md | API ä½¿ç”¨ç¤ºä¾‹ | å¼€å‘è€…æŒ‡å— |

## Dependencies

- âœ… Story 6.8 å¿…é¡»å®Œæˆ
- âœ… Story 6.9 å¿…é¡»å®Œæˆ

## Success Metrics

### åŠŸèƒ½å®Œæ•´æ€§
- âœ… æ‰€æœ‰åŠ¨ç”»æµ‹è¯•é€šè¿‡ï¼š100%
- âœ… è±Œè±†å°„æ‰‹å¤´éƒ¨æ˜¾ç¤ºï¼šä¿®å¤

### æ€§èƒ½
- âœ… FPS â‰¥ 60ï¼šè¾¾æ ‡
- âœ… æ¸²æŸ“æ—¶é—´ < 5msï¼šè¾¾æ ‡
- âœ… å†…å­˜æ— å¢é•¿ï¼šè¾¾æ ‡

### æ–‡æ¡£è´¨é‡
- âœ… CLAUDE.md æ›´æ–°ï¼šå®Œæ•´
- âœ… API æ–‡æ¡£ï¼šæ¸…æ™°
- âœ… ç¤ºä¾‹ä»£ç ï¼šå¯ç”¨

### ä»£ç è´¨é‡
- âœ… ä»£ç å‡å°‘ï¼š~600 è¡Œ
- âœ… æµ‹è¯•è¦†ç›–ï¼š80%+
- âœ… æ—  TODO é—ç•™ï¼š0

## Next Steps

å®Œæˆ Story 6.10 åï¼ŒEpic 6 çš„åŠ¨ç”»ç³»ç»Ÿç®€åŒ–å·¥ä½œå…¨éƒ¨å®Œæˆã€‚å¯ä»¥ç»§ç»­ï¼š
- **Epic 7**ï¼šç²’å­ç‰¹æ•ˆç³»ç»Ÿ
- **Epic 8**ï¼šç¬¬ä¸€ç« å…³å¡å®ç°
- æˆ–å…¶ä»–ä¼˜å…ˆçº§æ›´é«˜çš„ Epic

---

**ç¥è´ºğŸ‰**ï¼šå¦‚æœä½ çœ‹åˆ°è¿™é‡Œï¼Œè¯´æ˜åŠ¨ç”»ç³»ç»Ÿé‡æ„å³å°†å®Œæˆï¼è¿™æ˜¯ä¸€æ¬¡é‡å¤§çš„æ¶æ„ç®€åŒ–ï¼Œå°†ä¸ºæœªæ¥çš„å¼€å‘å¸¦æ¥å·¨å¤§çš„ä¾¿åˆ©ã€‚
