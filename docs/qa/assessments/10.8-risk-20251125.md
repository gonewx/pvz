# Risk Profile: Story 10.8 - æ¤ç‰©å¡ç‰‡äº¤äº’åé¦ˆå¢å¼º

**Story**: 10.8
**Title**: æ¤ç‰©å¡ç‰‡äº¤äº’åé¦ˆå¢å¼º (é˜³å…‰ä¸è¶³é—ªçƒ + Tooltip)
**Reviewer**: Quinn (Test Architect)
**Date**: 2025-11-25

---

## Risk Summary (é£é™©æ€»è§ˆ)

| Risk Category | Score | Level | Status |
|--------------|-------|-------|--------|
| **Technical** | 2 | Low | âœ… Acceptable |
| **Integration** | 3 | Low | âœ… Acceptable |
| **Testing** | 4 | Low-Medium | âš ï¸ Needs Attention |
| **Performance** | 2 | Low | âœ… Acceptable |
| **Overall** | **3** | **Low** | âš ï¸ **Manual Testing Required** |

**Risk Calculation**: Max(2, 3, 4, 2) = 4 (Low-Medium)

---

## Detailed Risk Analysis

### 1. Technical Complexity (æŠ€æœ¯å¤æ‚åº¦)

**Score**: 2/10 (Low)

**Analysis**:
- âœ… åŠŸèƒ½ç®€å•æ˜ç¡®: è§†è§‰åé¦ˆ(é—ªçƒ) + UIæç¤º(Tooltip)
- âœ… æ— å¤æ‚ç®—æ³•: æ–¹æ³¢é—ªçƒ + ç®€å•è¾¹ç•Œæ£€æµ‹
- âœ… æ— å¤–éƒ¨ä¾èµ–å˜æ›´
- âœ… çŠ¶æ€ç®¡ç†ç®€æ´: 3ä¸ªå­—æ®µåœ¨GameStateä¸­

**Mitigations**:
- ä½¿ç”¨æ–¹æ³¢è€Œéæ¸å˜,ç®€åŒ–å®ç°
- é—ªçƒé€»è¾‘å°è£…åœ¨ç‹¬ç«‹å‡½æ•°ä¸­

---

### 2. Integration Risk (é›†æˆé£é™©)

**Score**: 3/10 (Low)

**Analysis**:
- âœ… ä¿®æ”¹é™åˆ¶åœ¨3ä¸ªæ–‡ä»¶: GameState, InputSystem, GameScene
- âœ… æ— ç ´åæ€§å˜æ›´: æ‰€æœ‰ä¿®æ”¹ä¸ºæ–°å¢åŠŸèƒ½
- âš ï¸ ä¾èµ–ç°æœ‰ç³»ç»Ÿ:
  - InputSystem (å¡ç‰‡ç‚¹å‡»æ£€æµ‹)
  - UIRenderSystem (é˜³å…‰è®¡æ•°å™¨æ¸²æŸ“)
  - AudioManager (éŸ³æ•ˆæ’­æ”¾)
- âœ… æ— è·¨ç³»ç»Ÿè°ƒç”¨: å®Œå…¨ç¬¦åˆECSé›¶è€¦åˆåŸåˆ™

**Identified Dependencies**:
1. `PlantCardComponent` - å¡ç‰‡ä¿¡æ¯(é˜³å…‰æˆæœ¬,å†·å´çŠ¶æ€)
2. `GameState.Sun` - å½“å‰é˜³å…‰å€¼
3. `ResourceManager` - buzzeréŸ³æ•ˆåŠ è½½
4. `ebiten.SetCursorShape()` - å…‰æ ‡æ ·å¼åˆ‡æ¢

**Integration Points**:
- InputSystem.handlePlantCardClick() - è§¦å‘ç‚¹
- GameScene.Update() - è®¡æ—¶å™¨æ›´æ–°
- GameScene.drawSunCounter() - æ¸²æŸ“é—ªçƒ
- GameScene.drawTooltip() - æ¸²æŸ“Tooltip

**Mitigations**:
- æ‰€æœ‰é›†æˆç‚¹éƒ½å·²åœ¨ä»£ç ä¸­å®ç°
- ä½¿ç”¨ç°æœ‰GameStateå•ä¾‹,é¿å…æ–°çš„ä¾èµ–æ³¨å…¥

---

### 3. Testing Gap Risk (æµ‹è¯•è¦†ç›–é£é™©)

**Score**: 4/10 (Low-Medium) âš ï¸

**Analysis**:

**âœ… Strengths (ä¼˜ç‚¹)**:
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡é«˜:
  - getSunFlashColor(): 5ä¸ªæµ‹è¯•ç”¨ä¾‹,è¦†ç›–æ‰€æœ‰åˆ†æ”¯
  - GameStateé—ªçƒæ–¹æ³•: 6ä¸ªæµ‹è¯•ç”¨ä¾‹
  - è¾¹ç•Œæ¡ä»¶æµ‹è¯•å®Œæ•´(é›¶å€¼,è´Ÿå€¼,æµ®ç‚¹ç²¾åº¦)

**âš ï¸ Gaps (ç¼ºå£)**:
- **ç¼ºå°‘é›†æˆæµ‹è¯•** (Phase 4.2, Phase 5.5):
  - é˜³å…‰é—ªçƒåœ¨å®é™…æ¸¸æˆåœºæ™¯ä¸­çš„è¡¨ç°
  - Tooltipæ˜¾ç¤º/éšè—é€»è¾‘
  - é¼ æ ‡å…‰æ ‡åˆ‡æ¢
  - éŸ³æ•ˆæ’­æ”¾éªŒè¯
- **ç¼ºå°‘ç”¨æˆ·äº¤äº’æµ‹è¯•**:
  - è¿ç»­ç‚¹å‡»é˜³å…‰ä¸è¶³å¡ç‰‡(é—ªçƒé‡ç½®)
  - é—ªçƒæœŸé—´æ”¶é›†é˜³å…‰(æ•°å­—æ›´æ–°)
  - å¿«é€Ÿç§»åŠ¨é¼ æ ‡(Tooltipå“åº”)

**Impact**:
- å•å…ƒé€»è¾‘æ­£ç¡®ä¸ä¿è¯UIè¡¨ç°æ­£ç¡®
- å¯èƒ½å­˜åœ¨æ¸²æŸ“å±‚çº§ã€æ—¶åºã€ç”¨æˆ·ä½“éªŒé—®é¢˜

**Recommendations**:
1. **å¿…é¡»æ‰§è¡Œ**: æ‰‹åŠ¨é›†æˆæµ‹è¯•(Task 4.2, 5.5)
2. **å»ºè®®å¢å¼º**: æ·»åŠ InputSystemçš„å•å…ƒæµ‹è¯•(æ¨¡æ‹Ÿç‚¹å‡»)
3. **é•¿æœŸæ”¹è¿›**: å¼•å…¥UIè‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶

---

### 4. Performance Risk (æ€§èƒ½é£é™©)

**Score**: 2/10 (Low)

**Analysis**:

**âœ… Optimizations (ä¼˜åŒ–)**:
- è½»é‡çº§é—ªçƒç®—æ³•: `math.Mod()` + ç®€å•åˆ†æ”¯
- æ— é¢å¤–çº¹ç†/å›¾åƒèµ„æº
- éŸ³æ•ˆé˜²æŠ–(0.5ç§’å†·å´)
- Tooltipä»…åœ¨æ‚¬åœæ—¶æ¸²æŸ“

**Measured Impact**:
- é—ªçƒè®¡ç®—å¤æ‚åº¦: O(1)
- æ¸²æŸ“å¼€é”€: 1æ¬¡é¢œè‰²åˆ‡æ¢ + å¯é€‰TooltipçŸ©å½¢
- å†…å­˜å ç”¨: 3ä¸ªfloat64å­—æ®µ(24å­—èŠ‚)

**Potential Bottlenecks**:
- âŒ æ— : åŠŸèƒ½æè½»é‡

**60 FPS Target**:
- âœ… é¢„è®¡å½±å“ <0.1ms/frame
- âœ… ä¸æ¶‰åŠå¤æ‚å›¾å½¢æ“ä½œ

---

## Risk Matrix (é£é™©çŸ©é˜µ)

| Risk | Probability | Impact | Score | Mitigation |
|------|-------------|--------|-------|------------|
| é—ªçƒé¢œè‰²ä¸å‡†ç¡® | Low (10%) | Low | 1 | âœ… å•å…ƒæµ‹è¯•è¦†ç›–,é¢œè‰²ç¡¬ç¼–ç  |
| é—ªçƒå‘¨æœŸåå·® | Low (10%) | Low | 1 | âœ… ç²¾ç¡®è®¡æ—¶å™¨,æµ‹è¯•éªŒè¯ |
| éŸ³æ•ˆèµ„æºç¼ºå¤± | Medium (30%) | Low | 3 | âš ï¸ é™é»˜é™çº§(æ—¥å¿—è­¦å‘Š) |
| Tooltipä½ç½®é”™è¯¯ | Low (15%) | Medium | 3 | âš ï¸ éœ€æ‰‹åŠ¨è§†è§‰éªŒè¯ |
| é›†æˆæµ‹è¯•é—æ¼ | **High (50%)** | Medium | **5** | âš ï¸ **å¿…é¡»æ‰§è¡ŒTask 4.2, 5.5** |
| å…‰æ ‡åˆ‡æ¢å¤±æ•ˆ | Low (10%) | Low | 1 | âœ… é€»è¾‘ç®€å•,æ˜“éªŒè¯ |
| æ€§èƒ½å›å½’ | Very Low (5%) | Low | 0.5 | âœ… è½»é‡å®ç°,æ— é£é™© |

**Highest Risk**: é›†æˆæµ‹è¯•é—æ¼ (Score 5) - éœ€ç«‹å³æ‰§è¡Œæ‰‹åŠ¨æµ‹è¯•

---

## Test Priority Matrix (æµ‹è¯•ä¼˜å…ˆçº§)

| Test Type | Priority | Coverage | Status |
|-----------|----------|----------|--------|
| å•å…ƒæµ‹è¯• - é—ªçƒé€»è¾‘ | P0 | 100% | âœ… Done |
| å•å…ƒæµ‹è¯• - GameState | P0 | 100% | âœ… Done |
| é›†æˆæµ‹è¯• - é˜³å…‰é—ªçƒ | **P0** | 0% | âŒ **Missing** |
| é›†æˆæµ‹è¯• - Tooltip | **P0** | 0% | âŒ **Missing** |
| æ€§èƒ½æµ‹è¯• - å¸§ç‡ | P1 | 0% | âš ï¸ Recommended |
| å›å½’æµ‹è¯• | P1 | Partial | âš ï¸ `go test ./...`é€šè¿‡,ä½†æœ‰2ä¸ªæµ‹è¯•å¤±è´¥(éæœ¬Story) |

---

## Acceptance Criteria Risk Coverage

| AC# | Description | Test Coverage | Risk Level |
|-----|-------------|---------------|------------|
| AC1 | è§¦å‘æ¡ä»¶æ£€æµ‹ | Unit âœ… / Integration âŒ | Low |
| AC2 | é˜³å…‰æ•°å­—é—ªçƒåŠ¨ç”» | Unit âœ… / Integration âŒ | Low |
| AC3 | éŸ³æ•ˆæ’­æ”¾ | Manual âŒ | Medium |
| AC4 | é—ªçƒæœŸé—´åŠŸèƒ½ä¸å—å½±å“ | Integration âŒ | Medium |
| AC5 | å¤šæ¬¡ç‚¹å‡»å¤„ç† | Integration âŒ | Low |
| AC6 | éé˜³å…‰ä¸è¶³å¡ç‰‡ä¸å—å½±å“ | Integration âŒ | Low |
| AC7 | æ€§èƒ½æµ‹è¯• | Not Done âŒ | Low |
| AC8 | è§†è§‰è¿˜åŸåº¦ | Manual âŒ | Medium |
| AC9 | ä»£ç è´¨é‡ | âœ… Pass | Low |
| AC10 | å…¼å®¹æ€§ | Partial âœ… | Low |
| AC11 | Tooltipæ˜¾ç¤º | Integration âŒ | Medium |
| AC12 | Tooltipå†…å®¹æ­£ç¡® | Integration âŒ | Medium |
| AC13 | å…‰æ ‡åˆ‡æ¢ | Manual âŒ | Low |
| AC14 | Tooltipæ¸²æŸ“å±‚çº§ | Manual âŒ | Low |
| AC15 | Tooltipæ€§èƒ½ | Not Done âŒ | Low |

**Coverage Summary**:
- âœ… Fully Tested: 2/15 (13%)
- âš ï¸ Partially Tested: 2/15 (13%)
- âŒ Not Tested: 11/15 (74%)

---

## Recommendations (å»ºè®®)

### ğŸš¨ Must Fix (P0 - Blocking)
1. **æ‰§è¡Œé›†æˆæµ‹è¯• Task 4.2**: éªŒè¯é˜³å…‰é—ªçƒåœ¨æ¸¸æˆä¸­çš„è¡¨ç°
   - æµ‹è¯•åœºæ™¯: å…³å¡1-1,é˜³å…‰<100æ—¶ç‚¹å‡»è±Œè±†å°„æ‰‹å¡ç‰‡
   - éªŒè¯é¡¹: é—ªçƒé¢œè‰²ã€å‘¨æœŸã€æŒç»­æ—¶é—´ã€éŸ³æ•ˆ
2. **æ‰§è¡Œé›†æˆæµ‹è¯• Task 5.5**: éªŒè¯Tooltipç³»ç»Ÿ
   - æµ‹è¯•åœºæ™¯: æ‚¬åœå„ç§çŠ¶æ€çš„å¡ç‰‡(å¯ç”¨/å†·å´/é˜³å…‰ä¸è¶³)
   - éªŒè¯é¡¹: æ˜¾ç¤º/éšè—ã€å†…å®¹æ­£ç¡®ã€å…‰æ ‡åˆ‡æ¢

### âš ï¸ Should Fix (P1 - Important)
3. **ä¿®å¤æµ‹è¯•ä¸ä¸€è‡´**: `TestGameStateInitialValue`æœŸæœ›500ä½†å®é™…50
   - æ–‡ä»¶: `pkg/game/game_state_test.go:29`
   - å»ºè®®: ä¿®æ”¹æµ‹è¯•æœŸæœ›å€¼ä¸º50(ç¬¦åˆå®é™…å®ç°)

### ğŸ’¡ Nice to Have (P2 - Future)
4. **æ·»åŠ InputSystemå•å…ƒæµ‹è¯•**: æ¨¡æ‹Ÿé¼ æ ‡äº‹ä»¶éªŒè¯è§¦å‘é€»è¾‘
5. **æ€§èƒ½åŸºå‡†æµ‹è¯•**: æµ‹é‡é—ªçƒåŠ¨ç”»å¯¹å¸§ç‡çš„å®é™…å½±å“
6. **è§†è§‰å›å½’æµ‹è¯•**: æˆªå›¾å¯¹æ¯”å·¥å…·éªŒè¯UIä¸€è‡´æ€§

---

## Decision (å†³ç­–å»ºè®®)

**Gate Status Projection**: CONCERNS (éœ€å®Œæˆé›†æˆæµ‹è¯•)

**Reasoning**:
- âœ… ä»£ç è´¨é‡ä¼˜ç§€,æ¶æ„ç¬¦åˆè§„èŒƒ
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘
- âš ï¸ ç¼ºå°‘é›†æˆæµ‹è¯•éªŒè¯å®é™…è¡¨ç°
- âš ï¸ 74%çš„ACæœªç»è¿‡è‡ªåŠ¨åŒ–æµ‹è¯•

**Action Items**:
1. å¼€å‘å›¢é˜Ÿ: æ‰§è¡ŒTask 4.2å’Œ5.5æ‰‹åŠ¨æµ‹è¯•
2. å¼€å‘å›¢é˜Ÿ: ä¿®å¤TestGameStateInitialValue
3. QAå›¢é˜Ÿ: éªŒæ”¶æµ‹è¯•å‰å†æ¬¡ç¡®è®¤æ‰€æœ‰AC

**Timeline**: é¢„è®¡1-2å°æ—¶å®Œæˆé›†æˆæµ‹è¯•

---

## Appendix: Test Execution Evidence

### Unit Test Results (å•å…ƒæµ‹è¯•ç»“æœ)
```
âœ… TestTriggerSunFlash - PASS
âœ… TestUpdateSunFlash - PASS
âœ… TestUpdateSunFlash_NoNegative - PASS
âœ… TestSunFlashInitialValues - PASS
âœ… TestSunFlashMultipleTriggers - PASS
âœ… TestGetSunFlashColor_RedPhase - PASS (5 sub-tests)
âœ… TestGetSunFlashColor_BlackPhase - PASS (4 sub-tests)
âœ… TestGetSunFlashColor_CycleTransition - PASS
âœ… TestGetSunFlashColor_DifferentCycles - PASS (3 sub-tests)
âœ… TestGetSunFlashColor_ZeroTimer - PASS
```

**Total**: 11 tests, 100% pass rate

---

**End of Risk Profile**
