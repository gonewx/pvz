# Level 1-5: 坚果保龄球 (Story 19.4)
# 铲子教学阶段 + 保龄球迷你游戏
id: "1-5"
name: "坚果保龄球"
description: "铲子教学 + 保龄球迷你游戏"

# === Story 17.2: 顶层字段 ===
flags: 0                        # 保龄球关卡没有旗帜概念
sceneType: "day"                # 场景类型: 白天前院
rowMax: 5                       # 最大行数: 前院 5 行

# === 开场配置 ===
openingType: "special"          # 特殊开场（Dave 对话驱动）
enabledLanes: [1, 2, 3, 4, 5]
availablePlants: []             # 保龄球模式不使用植物卡片
skipOpening: true               # 跳过标准开场动画（由 Dave 对话替代）
initialSun: 0                   # 保龄球模式不使用阳光

# === 特殊规则 ===
specialRules: "bowling"         # 保龄球模式

# === 预设植物（铲子教学阶段）===
# Story 19.4: 关卡加载时自动生成的植物
presetPlants:
  - type: "peashooter"
    row: 2                      # 1-based 行号
    col: 6                      # 1-based 列号
  - type: "peashooter"
    row: 3
    col: 8
  - type: "peashooter"
    row: 4
    col: 7

# === 草皮配置（全行）===
backgroundImage: "IMAGE_BACKGROUND1"
sodRowImage: ""                 # 无草皮叠加
showSoddingAnim: false          # 无铺草皮动画

# === 通关奖励 ===
rewardPlant: "potatomine"       # 完成后奖励土豆地雷（注意：无下划线，与其他关卡保持一致）

# === 传送带配置（Story 19.5）===
conveyorBelt:
  enabled: true
  capacity: 10
  generationInterval: 3.0
  cardPool:
    - type: "wallnut_bowling"
      weight: 85
    - type: "explode_o_nut"
      weight: 15
  # Story 19.12: 三阶段动态配置
  phaseConfigs:
    - progressThreshold: 0.0   # 前期 (0%-30%)
      explodeNutWeight: 10
      intervalMin: 3.0
      intervalMax: 3.5
    - progressThreshold: 0.3   # 中期 (30%-70%)
      explodeNutWeight: 20
      intervalMin: 2.2
      intervalMax: 2.5
    - progressThreshold: 0.7   # 终盘 (70%-100%)
      explodeNutWeight: 30
      intervalMin: 1.5
      intervalMax: 1.8
  # Story 19.12: 动态调节参数
  dynamicAdjustment:
    emptyBeltThreshold: 3.0        # 空带保底阈值（秒）
    fullBeltThreshold: 8.0         # 满带降频阈值（秒）
    fullBeltThrottleMultiplier: 1.5  # 降频倍率
    crisisExplodeNutCooldown: 5.0  # 危机爆炸坚果冷却（秒）
    crisisZombieCount: 2           # 危机检测僵尸数量
    crisisDistanceThreshold: 300   # 危机检测距离阈值（像素）

# === 波次配置 (保龄球阶段) ===
# 注意：保龄球阶段的波次会在转场完成后才开始生效
# 保龄球关卡：连续高压进攻，无旗帜休息时间
# 僵尸池：basic（普通僵尸）、conehead（路障僵尸）
waves:
  # === 阶段一：热身 (Warm Up) 0%-15% 进度 ===
  # 目的：让玩家熟悉"瞄准-射击"和"弹射"手感
  - waveNum: 1
    type: "Fixed"
    isFlag: false
    zombies:
      - type: "basic"
        lanes: [1, 2, 3, 4, 5]
        count: 3
        spawnInterval: 2.5
      - type: "conehead"
        lanes: [2, 3, 4]
        count: 1
        spawnInterval: 2.5

  - waveNum: 2
    type: "Fixed"
    isFlag: true
    flagIndex: 1  
    zombies:
      - type: "basic"
        lanes: [1, 2, 3, 4, 5]
        count: 3
        spawnInterval: 2.5
      - type: "conehead"
        lanes: [2, 3, 4]
        count: 1
        spawnInterval: 2.5

  # - waveNum: 3
  #   type: "Fixed"
  #   isFlag: false
  #   zombies:
  #     - type: "basic"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 4
  #       spawnInterval: 2.5
  #     - type: "conehead"
  #       lanes: [2, 3, 4]
  #       count: 1
  #       spawnInterval: 2.5

  # # === 阶段二：路障引入 (Conehead Phase) 15%-40% 进度 ===
  # # 引入路障僵尸，开始出现 2-3 只的小队
  # - waveNum: 4
  #   type: "Fixed"
  #   isFlag: false
  #   zombies:
  #     - type: "basic"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 4
  #       spawnInterval: 2.5
  #     - type: "conehead"
  #       lanes: [2, 3, 4]
  #       count: 2
  #       spawnInterval: 2.5

  # - waveNum: 5
  #   type: "Fixed"
  #   isFlag: false
  #   zombies:
  #     - type: "basic"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 4
  #       spawnInterval: 2.5
  #     - type: "conehead"
  #       lanes: [1, 3, 5]
  #       count: 3
  #       spawnInterval: 2.5

  # - waveNum: 6
  #   type: "Fixed"
  #   isFlag: false
  #   zombies:
  #     - type: "basic"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 4
  #       spawnInterval: 2.0
  #     - type: "conehead"
  #       lanes: [2, 4]
  #       count: 1
  #       spawnInterval: 2.0

  # - waveNum: 7
  #   type: "Fixed"
  #   isFlag: false
  #   zombies:
  #     - type: "basic"
  #       lanes: [1, 3, 5]
  #       count: 4
  #       spawnInterval: 2.0
  #     - type: "conehead"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 1
  #       spawnInterval: 2.0

  # # === 阶段四：最终波 (Final Wave) 100% 进度 ===
  # # 大量普通和路障僵尸，短间隔快速生成
  # - waveNum: 8
  #   type: "Final"
  #   isFlag: true
  #   flagIndex: 1                  # 第一个（也是唯一一个）旗帜波
  #   zombies:
  #     - type: "basic"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 5
  #       spawnInterval: 1.0
  #     - type: "conehead"
  #       lanes: [1, 2, 3, 4, 5]
  #       count: 3
  #       spawnInterval: 1.2
